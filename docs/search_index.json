[["web-scraping.html", "Chapter 14 Web Scraping 14.1 issue of COVID19 in Korea 14.2 homework 14.3 Review of title from google scholar 14.4 home work 2 14.5 Black Report 2 14.6 home work 2", " Chapter 14 Web Scraping Now we can download data and text from web using url load library library(tidyverse) library(rvest) library(DT) 14.1 issue of COVID19 in Korea Now I want to download Table from https://en.wikipedia.org/wiki/COVID-19_pandemic_by_country_and_territory Please visit the website, url. wiki covid url &lt;-&quot;https://en.wikipedia.org/wiki/COVID-19_pandemic_by_country_and_territory&quot; read_html() allows us to read url and its’ contents. h &lt;-read_html(url) class(h) h #html_text(h) # just overview of HTML structure Go to website via chrom and click F12 button. You can see the right window as below. Now I want find table of Covid-19 table. I open the search tab by using ctrl + F. And writing or typing india to find that table. Find source and nodes Now I try to find table nodes from url tab &lt;- h %&gt;% html_nodes(&quot;table&quot;) tab2 &lt;- tab [[2]] %&gt;% html_table ## # A tibble: 234 × 6 ## `Location[a]...1` `Location[a]...2` `Cases[b]` `Deaths[c]` `Recov.[d]` Ref. ## &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; ## 1 &lt;NA&gt; World[e] 43,895,968 1,165,455 29,727,057 [4] ## 2 &lt;NA&gt; United States[f] 8,879,060 230,176 5,469,963 [13] ## 3 &lt;NA&gt; India 7,946,429 119,502 7,201,070 [14] ## 4 &lt;NA&gt; Brazil 5,440,903 157,981 4,904,046 [15][… ## 5 &lt;NA&gt; Russia[g] 1,547,774 26,589 1,158,940 [17] ## 6 &lt;NA&gt; France[h] 1,198,695 35,541 112,716 [18][… ## 7 &lt;NA&gt; Spain[i] 1,116,738 35,298 No data [20] ## 8 &lt;NA&gt; Argentina[j] 1,116,596 29,730 921,331 [22] ## 9 &lt;NA&gt; Colombia 1,033,218 30,565 932,882 [23] ## 10 &lt;NA&gt; United Kingdom[k] 917,575 45,365 No data [25] ## # … with 224 more rows I remove ‘,’ and macke numeric variables in Cases, Death and Recover. tab3 &lt;- tab2[ -c(1, 232, 233, 234), -c(1, 6)] %&gt;% setNames(c(&quot;Location&quot;, &quot;Cases&quot;, &quot;Death&quot;, &quot;Recover&quot;)) tab3 &lt;- tab3 %&gt;% mutate_at(c(&#39;Cases&#39;, &#39;Death&#39;, &#39;Recover&#39;), function(x)(str_replace_all(x, &quot;,&quot;, &quot;&quot;) %&gt;% as.numeric())) %&gt;% mutate(Location = str_replace_all(Location, &#39;\\\\[[:alpha:]]&#39;, &quot;&quot;)) I used \\\\[[:alpha:]], \\\\[ means “[” and [:aplpah:] means any alphabet, and last ] means ”]”. So, I try to remove the all character within “[ ]”. Now, Table is. tab3 %&gt;% datatable() figs&lt;-tab3 %&gt;% mutate(mortality = Death /Cases *1000) %&gt;% # mortality per 1 thousnd cases ggplot(aes(x = Cases, y = mortality, size = Death))+ geom_point() + scale_x_continuous(trans = &#39;log&#39;) figs 14.2 homework 14.2.1 download Cumulative covid19 death Download data table from url. You can use tab[[ i ]] code to find cumulative covid19 death. The taret Table in web looks like that. hint tab4&lt;-tab[[?]] %&gt;% html_table(fill = TRUE) and the table file is 14.2.2 UK, Italy, France, Spain, USA, Canada select countris of “UK, Italy, France, Spain, USA, Canada” and plot the trends. and upload the final plot in dspubs.org tutor Hint step1: create Month_mortatlity data filter countries names of above step2: chage character data to numeric data step3: pivot data to long form step4: plot the graph! Step 1 and 2 Month_mortality %&gt;% datatable() step 3 long_death %&gt;% datatable() step 4 ## [1] &quot;LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=en_US.UTF-8;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C&quot; 14.3 Review of title from google scholar 14.3.1 googl scholar Search the My name of “Jin-Ha Yoon” in google scholar. The url is https://scholar.google.com/citations?hl=en&amp;user=FzE_ZWAAAAAJ&amp;view_op=list_works&amp;sortby=pubdate url &lt;- &quot;https://scholar.google.com/citations?hl=en&amp;user=FzE_ZWAAAAAJ&amp;view_op=list_works&amp;sortby=pubdate&quot; step1 read the html using url address library(rvest) gs &lt;- read_html(url) step2 filter title using nodes and text, and make data.frame dat&lt;-gs %&gt;% html_nodes(&quot;tbody&quot;) %&gt;% html_nodes(&quot;td&quot;) %&gt;% html_nodes(&quot;a&quot;) %&gt;% html_text() %&gt;% data.frame() library(tm) library(SnowballC) library(wordcloud) library(RColorBrewer) library(dplyr) # for data wrangling library(tidytext) # for NLP library(stringr) # to deal with strings library(knitr) # for tables library(DT) # for dynamic tables library(tidyr) step3 split the words (tokenizing) using packages or user own methods. dat &lt;- dat %&gt;% setNames(c(&quot;titles&quot;)) tokens &lt;-dat %&gt;% unnest_tokens(word, titles) %&gt;% count(word, sort = TRUE)%&gt;% ungroup() tokens2 &lt;- str_split(dat$titles, &quot; &quot;, simplify = TRUE) %&gt;% as.data.frame() %&gt;% mutate(id = row_number()) %&gt;% pivot_longer(!c(id), names_to = &#39;Vs&#39;, values_to = &#39;word&#39;) %&gt;% select(-Vs) %&gt;% filter(!word==&quot;&quot;) %&gt;% count(word, sort = TRUE)%&gt;% ungroup() step4 import lookup data for removing words data(&quot;stop_words&quot;) # we should add user own words. stop_words %&gt;% datatable() step5 remove stop words and numbers tokens_clean &lt;- tokens %&gt;% anti_join(stop_words, by = c(&quot;word&quot;)) %&gt;% filter(!str_detect(word, &quot;^[[:digit:]]&quot;)) %&gt;% filter(!str_detect(word, &quot;study|korea&quot;)) step6 create word cloud set.seed(1) pal &lt;- brewer.pal(12, &quot;Paired&quot;) tokens_clean %&gt;% with(wordcloud(word, n, random.order = FALSE, colors=pal)) 14.4 home work 2 Search you own word in google scholar. for example, You can search “Suicide” or “Hypertension” in google scholar. And, upload your word cloud to google classroom. 14.5 Black Report 2 please visit “https://www.sochealth.co.uk/national-health-service/public-health-and-wellbeing/poverty-and-inequality/the-black-report-1980/the-black-report-2-the-evidence-of-inequalities-in-health/”. That is black report 2, and I need some visualization to present health inequality. Let’s start!. library(tidyverse) library(rvest) library(DT) Get url, save html from url and find tag of “table”. Review the table 5 using html_table(), and datatable(). url &lt;- &quot;https://www.sochealth.co.uk/national-health-service/public-health-and-wellbeing/poverty-and-inequality/the-black-report-1980/the-black-report-2-the-evidence-of-inequalities-in-health/&quot; h &lt;-read_html(url) tab &lt;- h %&gt;% html_nodes(&quot;table&quot;) tab[[5]] %&gt;% html_table() %&gt;% DT::datatable() The source and gender share same column, hence, I want divided that into two columns. the col names are changed by setNames. The gender variable was reshaped when that have any word of males or female. code of fill fill the missing row as very next values, in other word, fill code make html table to data frame table. tab[[5]] %&gt;% html_table() %&gt;% setNames(c(&#39;source&#39;, paste0(&#39;class&#39;, 1:6), &#39;all&#39;, &#39;ratio&#39;)) %&gt;% mutate(gender = case_when( source == &#39;Males&#39; ~ &#39;Males&#39;, str_detect(source, &#39;Females&#39;) ~ &#39;Females&#39;, TRUE ~ &quot;&quot; )) %&gt;% select(source, gender, class1:class6, all, ratio) %&gt;% mutate(source = case_when( str_detect(source, &#39;Males|Females&#39;) ~ &quot;&quot;, TRUE ~ source )) %&gt;% mutate(source = ifelse(source ==&quot;&quot;, NA, source)) %&gt;% fill(source, .direction = &quot;down&quot;) %&gt;% filter(!gender ==&quot;&quot;) -&gt; tab5 tab5 %&gt;% DT::datatable() Plot the bar plot tab5 %&gt;% pivot_longer(-c(source, gender), names_to = &#39;variables&#39;, values_to = &#39;value&#39;) %&gt;% filter(!variables %in% c(&#39;all&#39;, &#39;ratio&#39;) ) %&gt;% mutate(variables = factor(variables, level = c(paste0(&#39;class&#39;, 1:6)))) %&gt;% mutate(value = as.numeric(value)) %&gt;% mutate(source = str_replace(source, &quot;per&quot;, &quot;\\n per&quot;)) %&gt;% ggplot(aes(x=variables, y=value, color=gender, fill=gender, group=gender)) + geom_bar(stat=&#39;identity&#39;, aes(color = gender, fill=gender)) + facet_grid(source~gender, scale = &#39;free&#39;) + theme_minimal() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_blank())+ theme(strip.text.y.right = element_text(angle = 0, hjust = 0), axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1)) + guides(color = &quot;none&quot;, fill = &quot;none&quot;) tab5.1 &lt;- tab5 %&gt;% filter(str_detect(source, &quot;Stillbirths&quot;)) %&gt;% select(-all, -ratio) plot the table 6 using same methods of table 5 tab[[6]] %&gt;% html_table() %&gt;% tibble() %&gt;% setNames(c(&#39;source&#39;, paste0(&#39;class&#39;, 1:6), &#39;all&#39;, &#39;ratio&#39;)) %&gt;% filter(source == &#39;SMR&#39;) %&gt;% mutate(gender = c(&#39;Males&#39;, &#39;Females&#39;)) %&gt;% select(-all, -ratio) %&gt;% pivot_longer(-c(source, gender), names_to = &#39;variables&#39;, values_to = &#39;value&#39;) %&gt;% mutate(value= as.numeric(value)) %&gt;% ggplot(aes(x=variables, y = value)) + geom_bar(stat=&#39;identity&#39;, aes(fill=gender, color=gender)) + facet_grid(~gender) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_blank()) + guides(fill =&quot;none&quot;, color =&quot;none&quot;) + ggtitle(&quot;Child&quot;) tab[[6]] %&gt;% html_table() %&gt;% tibble() %&gt;% setNames(c(&#39;source&#39;, paste0(&#39;class&#39;, 1:6), &#39;all&#39;, &#39;ratio&#39;)) %&gt;% filter(source == &#39;SMR&#39;) %&gt;% mutate(gender = c(&#39;Males&#39;, &#39;Females&#39;)) %&gt;% mutate(source = &quot;Childhood Mortality (SMR)&quot;) %&gt;% select(names(tab5.1)) -&gt; tab6 tab6 ## # A tibble: 2 × 8 ## source gender class1 class2 class3 class4 class5 class6 ## &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; ## 1 Childhood Mortality (SMR) Males 74 79 95 98 112 162 ## 2 Childhood Mortality (SMR) Females 89 84 93 93 120 156 Repeat reshaping for Table 7. tab[[7]] %&gt;% html_table() %&gt;% tibble() %&gt;% setNames(c(&#39;source&#39;, paste0(&#39;class&#39;, 1:6), &#39;ratio&#39;)) %&gt;% filter(str_detect(source, &#39;Men|men&#39;)) %&gt;% mutate(gender = source) %&gt;% mutate(source = &quot;Adult (16-64) SMR&quot;) %&gt;% select(names(tab5.1)) %&gt;% slice(-3) -&gt; tab7 The final graph for black report 2 presentation as below. rbind(tab5.1, tab6, tab7) %&gt;% tibble() %&gt;% mutate(source = str_replace(source, &quot;per&quot;, &quot;(mortality) \\n per&quot;)) %&gt;% mutate(gender = ifelse(str_detect(gender, &#39;women&#39;), &#39;Females&#39;, ifelse(str_detect(gender, &#39;Men&#39;), &#39;Males&#39;, gender))) %&gt;% pivot_longer(-c(source, gender), names_to = &#39;class&#39;, values_to = &#39;SMR&#39;) %&gt;% mutate(SMR = as.numeric(SMR)) %&gt;% ggplot(aes(x=class, y=SMR)) + geom_bar(stat=&#39;identity&#39;, aes(fill=gender, color=gender)) + facet_grid(source ~gender, scale=&#39;free&#39;)+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_blank()) + theme_minimal()+ theme(strip.text.y.right = element_text(angle = 0, hjust = 0)) + guides(fill =&quot;none&quot;, color =&quot;none&quot;) 14.6 home work 2 Black report 중에 관심있는 표를 visualization 해 주세요 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
