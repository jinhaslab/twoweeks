[["표만들기.html", "» 4 표만들기 4.1 install package from github 4.2 자료 4.3 변수 선정 그리고 표 1 4.4 로지스틱 회귀 분석", " » 4 표만들기 데이터가 수집되었습니다. 이제 공중보건을 위한 두 종류의 표 만들기를 소개하겠습니다. 하나는 기본 크로스 테이블이고 다른 하나는 로지스틱 회귀 모델용 테이블입니다. 4.1 install package from github tidyvere and htmlTable, and broom 가 데이터를 변환하고 표시하는데 자주 사용됩니다. devtools 은 “github”에 있는 함수를 불러오는데 사용됩ㄴ디ㅏ.. install_github 을 통해 패키지를 설치하겠습니다. rm(list=ls()) #basic requirment if(!require(&quot;tidyverse&quot;)) install.packages(&quot;tidyverse&quot;) if(!require(&quot;htmlTable&quot;)) install.packages(&quot;htmlTable&quot;) if(!require(&quot;broom&quot;)) install.packages(&quot;broom&quot;) if(!require(&quot;labelled&quot;)) install.packages(&quot;labelled&quot;) # packages from github if(!require(&quot;devtools&quot;)) install.packages(&quot;devtools&quot;) library(devtools) install_github(&quot;jinhaslab/tabf&quot;, force = TRUE, quiet = TRUE) library(tabf) 4.2 자료 실습할 근로환경조사 중에 몇몇만 모아 놓은 것을 다운로드 하겠습니다. sehnr.org’s open data . 에 자료를 올려놓았습니다. tutorKWCS.rds 를 사용할 것입니다 rds 라는 파일 형태로 저장하고 불러올 것 입니다. url &lt;- &quot;https://sehnr.org/apps/download/tutorKWCS.rds&quot; download.file(url, &quot;tutorKWCS.rds&quot;) dat1 = readRDS(&quot;tutorKWCS.rds&quot;) Data Manipulation 이라는 매우 중요한 과정이 있는데요, 이것은 데이터 변환 참고 를 참고해 주시고, 오늘은 바로 표를 만들어 보겠습니다. 4.3 변수 선정 그리고 표 1 변수는 종속변수, 독립변수로 나눌수 있고, 독립변수는 성격에 따라 연속변수와 명목변수로 나눌 수 있습니다. 그렇게 구별해 보겠습니다. stratas = c(&quot;sleepgp&quot;) catVars = c(&quot;wwa1gp&quot;, &quot;shortReturn&quot;,&quot;shiftWork&quot; , &quot;njob&quot;, &quot;sexgp&quot;, &quot;edugp&quot;, &quot;empgp&quot;) conVars = c(&quot;AGE&quot;,&quot;satisfaction&quot;) tabf() 은 우리가 설정한 것에 따라 표1을 만들어 줍니다. htmlTable()은 붙여 넣기 좋게 화면에 출력해 줍니다. tab1 = tabf(dat1=dat1, stratas = stratas, catVars = catVars, conVars = conVars) tab1 ## # A tibble: 22 × 5 ## variables values `0.non distrubance` `1.sleep disturbance` p.value ## &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; ## 1 &quot;AGE&quot; &quot;&quot; 46.8±12.4 49.7±11.9 &quot;&lt;0.00… ## 2 &quot;wwa1gp&quot; &quot;Never&quot; 12222 (94.7%) 684 (5.3%) &quot;&lt;0.00… ## 3 &quot;&quot; &quot;Rarely&quot; 12316 (94.5%) 714 (5.5%) &quot;&quot; ## 4 &quot;&quot; &quot;Sometimes&quot; 9112 (90.3%) 981 (9.7%) &quot;&quot; ## 5 &quot;&quot; &quot;Often&quot; 3456 (82.8%) 717 (17.2%) &quot;&quot; ## 6 &quot;&quot; &quot;Always&quot; 634 (70.0%) 272 (30.0%) &quot;&quot; ## 7 &quot;satisfaction&quot; &quot;&quot; 2.1±0.5 2.4±0.6 &quot;&lt;0.00… ## 8 &quot;shortReturn&quot; &quot;non short … 36183 (92.5%) 2927 (7.5%) &quot;&lt;0.00… ## 9 &quot;&quot; &quot;short retu… 1557 (77.9%) 441 (22.1%) &quot;&quot; ## 10 &quot;shiftWork&quot; &quot;non shift … 35056 (91.9%) 3073 (8.1%) &quot;&lt;0.00… ## # ℹ 12 more rows htmlTable()을 이용해서 보기 좋게 만들어 보겠습니다. tab1 %&gt;% setNames(c(&quot;&quot;, &quot;&quot;, &quot;None&quot;, &quot;Disturbance&quot;, &quot;P value&quot;)) %&gt;% htmlTable( cgroup = c(&quot;&quot;, &quot;Sleep disturbance&quot;, &quot;&quot;), n.cgroup = c(2, 2, 1), tfoot = &quot;P value calculated by Chisq-Test and T-Test&quot;, rnames = FALSE, caption = &quot;Basic Characteristics according to Sleep disturbance&quot; ) Basic Characteristics according to Sleep disturbance   Sleep disturbance     None Disturbance   P value AGE   46.8±12.4 49.7±11.9   &lt;0.001 wwa1gp Never   12222 (94.7%) 684 (5.3%)   &lt;0.001 Rarely   12316 (94.5%) 714 (5.5%)   Sometimes   9112 (90.3%) 981 (9.7%)   Often   3456 (82.8%) 717 (17.2%)   Always   634 (70.0%) 272 (30.0%)   satisfaction   2.1±0.5 2.4±0.6   &lt;0.001 shortReturn non short return   36183 (92.5%) 2927 (7.5%)   &lt;0.001 short return   1557 (77.9%) 441 (22.1%)   shiftWork non shift work   35056 (91.9%) 3073 (8.1%)   &lt;0.001 shift work   2684 (90.1%) 295 (9.9%)   njob one-job   37471 (91.9%) 3317 (8.1%)   &lt;0.001 njob   269 (84.1%) 51 (15.9%)   sexgp Men   17892 (93.1%) 1327 (6.9%)   &lt;0.001 Women   19848 (90.7%) 2041 (9.3%)   edugp university or more   19597 (92.9%) 1502 (7.1%)   &lt;0.001 high school   14943 (91.9%) 1318 (8.1%)   middle school or below   3200 (85.4%) 548 (14.6%)   empgp paid-worker   25786 (92.4%) 2122 (7.6%)   &lt;0.001 employer/self-employer   2539 (91.7%) 229 (8.3%)   own-account worker   8359 (90.5%) 880 (9.5%)   unpaind family work   1056 (88.5%) 137 (11.5%)   P value calculated by Chisq-Test and T-Test 4.4 로지스틱 회귀 분석 로지스틱 회귀 분석은 오즈비와 95% 신뢰구간을 구하는데 사용합니다. 여기서는 수면장애의 오즈를 “일을 하지 않을 때에도 걱정하는” 정도에 따라 분석해 보겠습니다. 첫번째 모델을 걱정 변수만 넣어서, 두번째 모델은 연령, 성별, 근무 만족도를 넣어서, 3번째는 교대 근무와, n-job 여부를 넣어서 분석하겠습니다. mod1 = dat1 %&gt;% glm(data=.,family=&quot;binomial&quot;,formula = sleepgp == &quot;1.sleep disturbance&quot; ~ wwa1gp) mod2 = dat1 %&gt;% glm(data=.,family=&quot;binomial&quot;,formula = sleepgp == &quot;1.sleep disturbance&quot; ~ wwa1gp + AGE + sexgp +satisfaction) mod3 = dat1 %&gt;% glm(data=.,family=&quot;binomial&quot;,formula = sleepgp == &quot;1.sleep disturbance&quot; ~ wwa1gp + AGE + sexgp +satisfaction + shiftWork + njob) 각 모델이 잘 이루어졌는지 확인해 봅니다 . 로지스틱 회귀분서의 자세한 내용은 통계학 강의를 꼭 참고해 주세요!. summary(mod1) ## ## Call: ## glm(formula = sleepgp == &quot;1.sleep disturbance&quot; ~ wwa1gp, family = &quot;binomial&quot;, ## data = .) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -0.8450 -0.4522 -0.3357 -0.3300 2.4238 ## ## Coefficients: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) -2.88303 0.03929 -73.378 &lt;2e-16 *** ## wwa1gp1.Rarely 0.03526 0.05500 0.641 0.521 ## wwa1gp2.Sometimes 0.65426 0.05170 12.655 &lt;2e-16 *** ## wwa1gp3.Often 1.31024 0.05681 23.062 &lt;2e-16 *** ## wwa1gp4.Always 2.03679 0.08245 24.704 &lt;2e-16 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for binomial family taken to be 1) ## ## Null deviance: 23305 on 41107 degrees of freedom ## Residual deviance: 22258 on 41103 degrees of freedom ## AIC: 22268 ## ## Number of Fisher Scoring iterations: 5 oddsf() 라는 함수로 결과를 확인해 보겠습니다 . oddsf(mod1, mod2, mod3) %&gt;% htmlTable() Variables Values Model.I Model.II Model.III 1 wwa1gp 0.Never 1.00 (reference) 1.00 (reference) 1.00 (reference) 2 wwa1gp 1.Rarely 1.04 (0.93-1.15) 1.00 (0.90-1.12) 1.01 (0.91-1.13) 3 wwa1gp 2.Sometimes 1.92 (1.74-2.13) 1.83 (1.65-2.03) 1.88 (1.69-2.08) 4 wwa1gp 3.Often 3.71 (3.32-4.14) 3.42 (3.05-3.83) 3.49 (3.11-3.91) 5 wwa1gp 4.Always 7.67 (6.52-9.01) 6.91 (5.85-8.16) 7.05 (5.96-8.33) 6 sexgp Men 1.00 (reference) 1.00 (reference) 7 sexgp Women 1.53 (1.42-1.65) 1.54 (1.43-1.66) 8 AGE 1.01 (1.01-1.02) 1.01 (1.01-1.02) 9 satisfaction 2.29 (2.15-2.44) 2.27 (2.13-2.42) 10 shiftWork 0.non shift work 1.00 (reference) 11 shiftWork 1.shift work 1.51 (1.32-1.72) 12 njob 0.one-job 1.00 (reference) 13 njob 1.njob 1.59 (1.15-2.19) 예상한대로 결과가 나왔다면 oddsTabf()를 이용해서 복사 붙여 넣기를 하겠습니다. oddsTabf(mod1, mod2, mod3) "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
