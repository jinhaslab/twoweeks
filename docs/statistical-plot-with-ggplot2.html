<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Statistical Plot with ggplot2 | DsPubs with R tutor book</title>
  <meta name="description" content="Chapter 11 Statistical Plot with ggplot2 | DsPubs with R tutor book" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Statistical Plot with ggplot2 | DsPubs with R tutor book" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Statistical Plot with ggplot2 | DsPubs with R tutor book" />
  
  
  

<meta name="author" content="jinha" />


<meta name="date" content="2022-11-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="basic-plot-with-r.html"/>
<link rel="next" href="wave-form-data-visualization-example-for-public-health.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://dspubs.org/webapps">DsPubs</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="lets-start-with-r-and-r-studio.html"><a href="lets-start-with-r-and-r-studio.html"><i class="fa fa-check"></i><b>2</b> Let’s Start with R and R studio</a>
<ul>
<li class="chapter" data-level="2.1" data-path="lets-start-with-r-and-r-studio.html"><a href="lets-start-with-r-and-r-studio.html#rstudio-cloud-and-colab"><i class="fa fa-check"></i><b>2.1</b> Rstudio Cloud, and colab</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="lets-start-with-r-and-r-studio.html"><a href="lets-start-with-r-and-r-studio.html#rstudio-cloud"><i class="fa fa-check"></i><b>2.1.1</b> Rstudio Cloud</a></li>
<li class="chapter" data-level="2.1.2" data-path="lets-start-with-r-and-r-studio.html"><a href="lets-start-with-r-and-r-studio.html#colab"><i class="fa fa-check"></i><b>2.1.2</b> Colab</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="lets-start-with-r-and-r-studio.html"><a href="lets-start-with-r-and-r-studio.html#r-and-r-studio-on-window-system"><i class="fa fa-check"></i><b>2.2</b> R and R studio on Window system</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="lets-start-with-r-and-r-studio.html"><a href="lets-start-with-r-and-r-studio.html#r-studio-install"><i class="fa fa-check"></i><b>2.2.1</b> R studio install</a></li>
<li class="chapter" data-level="2.2.2" data-path="lets-start-with-r-and-r-studio.html"><a href="lets-start-with-r-and-r-studio.html#r-studio-project"><i class="fa fa-check"></i><b>2.2.2</b> R studio project</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="lets-start-with-r-and-r-studio.html"><a href="lets-start-with-r-and-r-studio.html#r-and-r-studio-on-ubuntus"><i class="fa fa-check"></i><b>2.3</b> R and R studio on Ubuntus</a></li>
</ul></li>
<li class="part"><span><b>I R</b></span></li>
<li class="chapter" data-level="3" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>3</b> R basics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="r-basics.html"><a href="r-basics.html#vector-matirx-list"><i class="fa fa-check"></i><b>3.1</b> vector matirx list</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="r-basics.html"><a href="r-basics.html#오브젝트-objects"><i class="fa fa-check"></i><b>3.1.1</b> 오브젝트 (objects)</a></li>
<li class="chapter" data-level="3.1.2" data-path="r-basics.html"><a href="r-basics.html#백터-vectors-팩터-factors"><i class="fa fa-check"></i><b>3.1.2</b> 백터 (Vectors), 팩터 (factors)</a></li>
<li class="chapter" data-level="3.1.3" data-path="r-basics.html"><a href="r-basics.html#매트릭스-matrix-데이터프래임-data-frame-리스트-list"><i class="fa fa-check"></i><b>3.1.3</b> 매트릭스 (Matrix), 데이터프래임 (data frame), 리스트 (list)</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="r-basics.html"><a href="r-basics.html#데이터-생성-저장"><i class="fa fa-check"></i><b>3.2</b> 데이터 생성 저장</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="r-basics.html"><a href="r-basics.html#built-in-data-sets"><i class="fa fa-check"></i><b>3.2.1</b> built-in data sets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="r-program-basic.html"><a href="r-program-basic.html"><i class="fa fa-check"></i><b>4</b> R program basic</a>
<ul>
<li class="chapter" data-level="4.1" data-path="r-program-basic.html"><a href="r-program-basic.html#기초-연산"><i class="fa fa-check"></i><b>4.1</b> 기초 연산</a></li>
<li class="chapter" data-level="4.2" data-path="r-program-basic.html"><a href="r-program-basic.html#조건부-연산"><i class="fa fa-check"></i><b>4.2</b> 조건부 연산</a></li>
<li class="chapter" data-level="4.3" data-path="r-program-basic.html"><a href="r-program-basic.html#함수-만들기"><i class="fa fa-check"></i><b>4.3</b> 함수 만들기</a></li>
<li class="chapter" data-level="4.4" data-path="r-program-basic.html"><a href="r-program-basic.html#반복문-vectorization-functionals"><i class="fa fa-check"></i><b>4.4</b> 반복문, vectorization, functionals</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="r-program-basic.html"><a href="r-program-basic.html#for-loop"><i class="fa fa-check"></i><b>4.4.1</b> for loop</a></li>
<li class="chapter" data-level="4.4.2" data-path="r-program-basic.html"><a href="r-program-basic.html#vectorization-과-apply-구문"><i class="fa fa-check"></i><b>4.4.2</b> vectorization 과 apply 구문</a></li>
<li class="chapter" data-level="4.4.3" data-path="r-program-basic.html"><a href="r-program-basic.html#home-work-and-summary-function"><i class="fa fa-check"></i><b>4.4.3</b> home work and summary function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-manipulation.html"><a href="data-manipulation.html"><i class="fa fa-check"></i><b>5</b> Data Manipulation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-manipulation.html"><a href="data-manipulation.html#dplyr-tidyverse"><i class="fa fa-check"></i><b>5.1</b> dplyr (tidyverse)</a></li>
<li class="chapter" data-level="5.2" data-path="data-manipulation.html"><a href="data-manipulation.html#실습-데이터-준비"><i class="fa fa-check"></i><b>5.2</b> 실습 데이터 준비</a></li>
<li class="chapter" data-level="5.3" data-path="data-manipulation.html"><a href="data-manipulation.html#select"><i class="fa fa-check"></i><b>5.3</b> select</a></li>
<li class="chapter" data-level="5.4" data-path="data-manipulation.html"><a href="data-manipulation.html#filter"><i class="fa fa-check"></i><b>5.4</b> filter</a></li>
<li class="chapter" data-level="5.5" data-path="data-manipulation.html"><a href="data-manipulation.html#arrange"><i class="fa fa-check"></i><b>5.5</b> arrange</a></li>
<li class="chapter" data-level="5.6" data-path="data-manipulation.html"><a href="data-manipulation.html#mutate"><i class="fa fa-check"></i><b>5.6</b> mutate</a></li>
<li class="chapter" data-level="5.7" data-path="data-manipulation.html"><a href="data-manipulation.html#group_by"><i class="fa fa-check"></i><b>5.7</b> group_by</a></li>
<li class="chapter" data-level="5.8" data-path="data-manipulation.html"><a href="data-manipulation.html#merge-join"><i class="fa fa-check"></i><b>5.8</b> merge, join</a></li>
</ul></li>
<li class="part"><span><b>II Visualization</b></span></li>
<li class="chapter" data-level="6" data-path="tables-for-public-health-1.html"><a href="tables-for-public-health-1.html"><i class="fa fa-check"></i><b>6</b> Tables for public health 1</a>
<ul>
<li class="chapter" data-level="6.1" data-path="tables-for-public-health-1.html"><a href="tables-for-public-health-1.html#데이터표-준비"><i class="fa fa-check"></i><b>6.1</b> 데이터표 준비</a></li>
<li class="chapter" data-level="6.2" data-path="tables-for-public-health-1.html"><a href="tables-for-public-health-1.html#central-tendency-mean-median-mode"><i class="fa fa-check"></i><b>6.2</b> Central Tendency (mean, median, mode)</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="tables-for-public-health-1.html"><a href="tables-for-public-health-1.html#하나씩-반복"><i class="fa fa-check"></i><b>6.2.1</b> 하나씩 반복</a></li>
<li class="chapter" data-level="6.2.2" data-path="tables-for-public-health-1.html"><a href="tables-for-public-health-1.html#group_by-summary-and-table-1"><i class="fa fa-check"></i><b>6.2.2</b> Group_by summary and Table 1</a></li>
<li class="chapter" data-level="6.2.3" data-path="tables-for-public-health-1.html"><a href="tables-for-public-health-1.html#long-file-and-table-1"><i class="fa fa-check"></i><b>6.2.3</b> Long File and Table 1</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="tables-for-public-health-1.html"><a href="tables-for-public-health-1.html#count-and-distribution"><i class="fa fa-check"></i><b>6.3</b> Count and Distribution</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="tables-for-public-health-1.html"><a href="tables-for-public-health-1.html#하나씩-반복-1"><i class="fa fa-check"></i><b>6.3.1</b> 하나씩 반복</a></li>
<li class="chapter" data-level="6.3.2" data-path="tables-for-public-health-1.html"><a href="tables-for-public-health-1.html#group_by-summary-and-table-1-1"><i class="fa fa-check"></i><b>6.3.2</b> Group_by summary and Table 1</a></li>
<li class="chapter" data-level="6.3.3" data-path="tables-for-public-health-1.html"><a href="tables-for-public-health-1.html#long-file-and-table-1-1"><i class="fa fa-check"></i><b>6.3.3</b> Long File and Table 1</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="tables-for-public-health-1.html"><a href="tables-for-public-health-1.html#정리-1"><i class="fa fa-check"></i><b>6.4</b> 정리 1</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="tables-for-public-health-1.html"><a href="tables-for-public-health-1.html#과제"><i class="fa fa-check"></i><b>6.4.1</b> 과제</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Tables2.html"><a href="Tables2.html"><i class="fa fa-check"></i><b>7</b> Tables for public health 2</a>
<ul>
<li class="chapter" data-level="7.1" data-path="Tables2.html"><a href="Tables2.html#데이터-준비"><i class="fa fa-check"></i><b>7.1</b> 데이터 준비</a></li>
<li class="chapter" data-level="7.2" data-path="Tables2.html"><a href="Tables2.html#분석-주제-선정"><i class="fa fa-check"></i><b>7.2</b> 분석 주제 선정</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="Tables2.html"><a href="Tables2.html#근로환경조사와-recode-선택사항"><i class="fa fa-check"></i><b>7.2.1</b> 근로환경조사와 recode (선택사항)</a></li>
<li class="chapter" data-level="7.2.2" data-path="Tables2.html"><a href="Tables2.html#근로환경조사-기본-변수-생성"><i class="fa fa-check"></i><b>7.2.2</b> 근로환경조사 기본 변수 생성</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="Tables2.html"><a href="Tables2.html#근로환경조사-table-1-만들기"><i class="fa fa-check"></i><b>7.3</b> 근로환경조사 Table 1 만들기</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="Tables2.html"><a href="Tables2.html#변수-값-요약하기"><i class="fa fa-check"></i><b>7.3.1</b> 변수 값 요약하기</a></li>
<li class="chapter" data-level="7.3.2" data-path="Tables2.html"><a href="Tables2.html#p-value-구하기."><i class="fa fa-check"></i><b>7.3.2</b> P value 구하기.</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="Tables2.html"><a href="Tables2.html#table-1-정리하기"><i class="fa fa-check"></i><b>7.4</b> Table 1 정리하기</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="Tables2.html"><a href="Tables2.html#htmltable-visulaization"><i class="fa fa-check"></i><b>7.4.1</b> htmlTable visulaization</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="Tables2.html"><a href="Tables2.html#kwcsfunction"><i class="fa fa-check"></i><b>7.5</b> 함수만들기</a></li>
<li class="chapter" data-level="7.6" data-path="Tables2.html"><a href="Tables2.html#quiz"><i class="fa fa-check"></i><b>7.6</b> Quiz</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="Tables2.html"><a href="Tables2.html#quiz1"><i class="fa fa-check"></i><b>7.6.1</b> Quiz1</a></li>
<li class="chapter" data-level="7.6.2" data-path="Tables2.html"><a href="Tables2.html#quiz-2"><i class="fa fa-check"></i><b>7.6.2</b> Quiz 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="tables-for-public-health-3.html"><a href="tables-for-public-health-3.html"><i class="fa fa-check"></i><b>8</b> Tables for public health 3</a>
<ul>
<li class="chapter" data-level="8.1" data-path="tables-for-public-health-3.html"><a href="tables-for-public-health-3.html#데이터-준비-1"><i class="fa fa-check"></i><b>8.1</b> 데이터 준비</a></li>
<li class="chapter" data-level="8.2" data-path="tables-for-public-health-3.html"><a href="tables-for-public-health-3.html#분석-주제-선정-1"><i class="fa fa-check"></i><b>8.2</b> 분석 주제 선정</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="tables-for-public-health-3.html"><a href="tables-for-public-health-3.html#근로환경조사-기본-변수-생성-선택"><i class="fa fa-check"></i><b>8.2.1</b> 근로환경조사 기본 변수 생성 (선택)</a></li>
<li class="chapter" data-level="8.2.2" data-path="tables-for-public-health-3.html"><a href="tables-for-public-health-3.html#함수를-source-file-로-저장하기"><i class="fa fa-check"></i><b>8.2.2</b> 함수를 source file 로 저장하기</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="tables-for-public-health-3.html"><a href="tables-for-public-health-3.html#logistic-regression-table"><i class="fa fa-check"></i><b>8.3</b> Logistic Regression Table</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="tables-for-public-health-3.html"><a href="tables-for-public-health-3.html#로지스틱회귀분석-표-함수-1"><i class="fa fa-check"></i><b>8.3.1</b> 로지스틱회귀분석 표 함수 1</a></li>
<li class="chapter" data-level="8.3.2" data-path="tables-for-public-health-3.html"><a href="tables-for-public-health-3.html#로지스틱-회귀분석-표-2"><i class="fa fa-check"></i><b>8.3.2</b> 로지스틱 회귀분석 표 2</a></li>
<li class="chapter" data-level="8.3.3" data-path="tables-for-public-health-3.html"><a href="tables-for-public-health-3.html#로지스틱-회귀분석-3"><i class="fa fa-check"></i><b>8.3.3</b> 로지스틱 회귀분석 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="tables-for-public-health-summary.html"><a href="tables-for-public-health-summary.html"><i class="fa fa-check"></i><b>9</b> Tables for public health summary</a>
<ul>
<li class="chapter" data-level="9.1" data-path="tables-for-public-health-summary.html"><a href="tables-for-public-health-summary.html#install-package-from-github"><i class="fa fa-check"></i><b>9.1</b> install package from github</a></li>
<li class="chapter" data-level="9.2" data-path="tables-for-public-health-summary.html"><a href="tables-for-public-health-summary.html#data-import-and-manipulation"><i class="fa fa-check"></i><b>9.2</b> data import and manipulation</a></li>
<li class="chapter" data-level="9.3" data-path="tables-for-public-health-summary.html"><a href="tables-for-public-health-summary.html#select-variables-and-table-1"><i class="fa fa-check"></i><b>9.3</b> select variables, and table 1</a></li>
<li class="chapter" data-level="9.4" data-path="tables-for-public-health-summary.html"><a href="tables-for-public-health-summary.html#logistic-regression-model-and-table-3"><i class="fa fa-check"></i><b>9.4</b> logistic regression model and table 3</a></li>
<li class="chapter" data-level="9.5" data-path="tables-for-public-health-summary.html"><a href="tables-for-public-health-summary.html#quiz-1"><i class="fa fa-check"></i><b>9.5</b> Quiz</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="tables-for-public-health-summary.html"><a href="tables-for-public-health-summary.html#install-and-load-library-tabf"><i class="fa fa-check"></i><b>9.5.1</b> install and load library tabf</a></li>
<li class="chapter" data-level="9.5.2" data-path="tables-for-public-health-summary.html"><a href="tables-for-public-health-summary.html#data-manipulation-1"><i class="fa fa-check"></i><b>9.5.2</b> data manipulation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="basic-plot-with-r.html"><a href="basic-plot-with-r.html"><i class="fa fa-check"></i><b>10</b> Basic plot with R</a>
<ul>
<li class="chapter" data-level="10.1" data-path="basic-plot-with-r.html"><a href="basic-plot-with-r.html#ggplot-basic"><i class="fa fa-check"></i><b>10.1</b> ggplot basic</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="basic-plot-with-r.html"><a href="basic-plot-with-r.html#axis"><i class="fa fa-check"></i><b>10.1.1</b> axis</a></li>
<li class="chapter" data-level="10.1.2" data-path="basic-plot-with-r.html"><a href="basic-plot-with-r.html#layer-geom_x"><i class="fa fa-check"></i><b>10.1.2</b> layer, geom_x()</a></li>
<li class="chapter" data-level="10.1.3" data-path="basic-plot-with-r.html"><a href="basic-plot-with-r.html#geom_point"><i class="fa fa-check"></i><b>10.1.3</b> geom_point()</a></li>
<li class="chapter" data-level="10.1.4" data-path="basic-plot-with-r.html"><a href="basic-plot-with-r.html#geom_smooth"><i class="fa fa-check"></i><b>10.1.4</b> geom_smooth()</a></li>
<li class="chapter" data-level="10.1.5" data-path="basic-plot-with-r.html"><a href="basic-plot-with-r.html#faceting"><i class="fa fa-check"></i><b>10.1.5</b> faceting</a></li>
<li class="chapter" data-level="10.1.6" data-path="basic-plot-with-r.html"><a href="basic-plot-with-r.html#geom_bar"><i class="fa fa-check"></i><b>10.1.6</b> geom_bar()</a></li>
<li class="chapter" data-level="10.1.7" data-path="basic-plot-with-r.html"><a href="basic-plot-with-r.html#geom_density-geom_histogram"><i class="fa fa-check"></i><b>10.1.7</b> geom_density() , geom_histogram()</a></li>
<li class="chapter" data-level="10.1.8" data-path="basic-plot-with-r.html"><a href="basic-plot-with-r.html#geom_boxplot"><i class="fa fa-check"></i><b>10.1.8</b> geom_boxplot()</a></li>
<li class="chapter" data-level="10.1.9" data-path="basic-plot-with-r.html"><a href="basic-plot-with-r.html#d-plot"><i class="fa fa-check"></i><b>10.1.9</b> 3d plot</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="basic-plot-with-r.html"><a href="basic-plot-with-r.html#visualzation-example-1"><i class="fa fa-check"></i><b>10.2</b> Visualzation example 1</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="basic-plot-with-r.html"><a href="basic-plot-with-r.html#simple-machine-learning-decision-tree"><i class="fa fa-check"></i><b>10.2.1</b> simple machine learning decision tree</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="basic-plot-with-r.html"><a href="basic-plot-with-r.html#summary"><i class="fa fa-check"></i><b>10.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="statistical-plot-with-ggplot2.html"><a href="statistical-plot-with-ggplot2.html"><i class="fa fa-check"></i><b>11</b> Statistical Plot with ggplot2</a>
<ul>
<li class="chapter" data-level="11.1" data-path="statistical-plot-with-ggplot2.html"><a href="statistical-plot-with-ggplot2.html#t-test-and-chisq-test-visualization"><i class="fa fa-check"></i><b>11.1</b> T-test and Chisq-test Visualization</a></li>
<li class="chapter" data-level="11.2" data-path="statistical-plot-with-ggplot2.html"><a href="statistical-plot-with-ggplot2.html#odds-ratio-and-95-confidence-interval"><i class="fa fa-check"></i><b>11.2</b> Odds ratio and 95% confidence interval</a></li>
<li class="chapter" data-level="11.3" data-path="statistical-plot-with-ggplot2.html"><a href="statistical-plot-with-ggplot2.html#Labeled"><i class="fa fa-check"></i><b>11.3</b> Multilevel and Labelled Data</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="statistical-plot-with-ggplot2.html"><a href="statistical-plot-with-ggplot2.html#introduction-1"><i class="fa fa-check"></i><b>11.3.1</b> introduction</a></li>
<li class="chapter" data-level="11.3.2" data-path="statistical-plot-with-ggplot2.html"><a href="statistical-plot-with-ggplot2.html#data-analysis-start"><i class="fa fa-check"></i><b>11.3.2</b> Data analysis start</a></li>
<li class="chapter" data-level="11.3.3" data-path="statistical-plot-with-ggplot2.html"><a href="statistical-plot-with-ggplot2.html#job-loss-psychological-aggravation-according-to-education-level"><i class="fa fa-check"></i><b>11.3.3</b> job loss, psychological aggravation according to Education level</a></li>
<li class="chapter" data-level="11.3.4" data-path="statistical-plot-with-ggplot2.html"><a href="statistical-plot-with-ggplot2.html#visulization-with-human-develop-index-stratification"><i class="fa fa-check"></i><b>11.3.4</b> Visulization with human develop index stratification</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="wave-form-data-visualization-example-for-public-health.html"><a href="wave-form-data-visualization-example-for-public-health.html"><i class="fa fa-check"></i><b>12</b> wave form data visualization example for public health</a>
<ul>
<li class="chapter" data-level="12.0.1" data-path="wave-form-data-visualization-example-for-public-health.html"><a href="wave-form-data-visualization-example-for-public-health.html#data-visualization-example-eeg-data"><i class="fa fa-check"></i><b>12.0.1</b> Data Visualization example (EEG data)</a></li>
<li class="chapter" data-level="12.0.2" data-path="wave-form-data-visualization-example-for-public-health.html"><a href="wave-form-data-visualization-example-for-public-health.html#introduction-2"><i class="fa fa-check"></i><b>12.0.2</b> Introduction</a></li>
<li class="chapter" data-level="12.0.3" data-path="wave-form-data-visualization-example-for-public-health.html"><a href="wave-form-data-visualization-example-for-public-health.html#dataset-and-data-step"><i class="fa fa-check"></i><b>12.0.3</b> Dataset and Data step</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="data-wrangling--text-value-handling.html"><a href="data-wrangling--text-value-handling.html"><i class="fa fa-check"></i><b>13</b> Data Wrangling- Text value Handling</a>
<ul>
<li class="chapter" data-level="13.1" data-path="data-wrangling--text-value-handling.html"><a href="data-wrangling--text-value-handling.html#동영상"><i class="fa fa-check"></i><b>13.1</b> 동영상</a></li>
<li class="chapter" data-level="13.2" data-path="data-wrangling--text-value-handling.html"><a href="data-wrangling--text-value-handling.html#문제-제기"><i class="fa fa-check"></i><b>13.2</b> 문제 제기</a></li>
<li class="chapter" data-level="13.3" data-path="data-wrangling--text-value-handling.html"><a href="data-wrangling--text-value-handling.html#split"><i class="fa fa-check"></i><b>13.3</b> split</a></li>
<li class="chapter" data-level="13.4" data-path="data-wrangling--text-value-handling.html"><a href="data-wrangling--text-value-handling.html#gather-pivot_longer"><i class="fa fa-check"></i><b>13.4</b> gather (pivot_longer)</a></li>
<li class="chapter" data-level="13.5" data-path="data-wrangling--text-value-handling.html"><a href="data-wrangling--text-value-handling.html#spread-pivot_wider"><i class="fa fa-check"></i><b>13.5</b> spread (pivot_wider)</a></li>
<li class="chapter" data-level="13.6" data-path="data-wrangling--text-value-handling.html"><a href="data-wrangling--text-value-handling.html#stringr"><i class="fa fa-check"></i><b>13.6</b> stringr</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="data-wrangling--text-value-handling.html"><a href="data-wrangling--text-value-handling.html#분진-노출자-찾기"><i class="fa fa-check"></i><b>13.6.1</b> 분진 노출자 찾기</a></li>
<li class="chapter" data-level="13.6.2" data-path="data-wrangling--text-value-handling.html"><a href="data-wrangling--text-value-handling.html#특정-문자-변환"><i class="fa fa-check"></i><b>13.6.2</b> 특정 문자 변환</a></li>
<li class="chapter" data-level="13.6.3" data-path="data-wrangling--text-value-handling.html"><a href="data-wrangling--text-value-handling.html#과제-1"><i class="fa fa-check"></i><b>13.6.3</b> 과제</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="web-scraping.html"><a href="web-scraping.html"><i class="fa fa-check"></i><b>14</b> Web Scraping</a>
<ul>
<li class="chapter" data-level="14.1" data-path="web-scraping.html"><a href="web-scraping.html#issue-of-covid19-in-korea"><i class="fa fa-check"></i><b>14.1</b> issue of COVID19 in Korea</a></li>
<li class="chapter" data-level="14.2" data-path="web-scraping.html"><a href="web-scraping.html#homework"><i class="fa fa-check"></i><b>14.2</b> homework</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="web-scraping.html"><a href="web-scraping.html#download-cumulative-covid19-death"><i class="fa fa-check"></i><b>14.2.1</b> download Cumulative covid19 death</a></li>
<li class="chapter" data-level="14.2.2" data-path="web-scraping.html"><a href="web-scraping.html#uk-italy-france-spain-usa-canada"><i class="fa fa-check"></i><b>14.2.2</b> UK, Italy, France, Spain, USA, Canada</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="web-scraping.html"><a href="web-scraping.html#review-of-title-from-google-scholar"><i class="fa fa-check"></i><b>14.3</b> Review of title from google scholar</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="web-scraping.html"><a href="web-scraping.html#googl-scholar"><i class="fa fa-check"></i><b>14.3.1</b> googl scholar</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="web-scraping.html"><a href="web-scraping.html#home-work-2"><i class="fa fa-check"></i><b>14.4</b> home work 2</a></li>
<li class="chapter" data-level="14.5" data-path="web-scraping.html"><a href="web-scraping.html#black-report-2"><i class="fa fa-check"></i><b>14.5</b> Black Report 2</a></li>
<li class="chapter" data-level="14.6" data-path="web-scraping.html"><a href="web-scraping.html#home-work-2-1"><i class="fa fa-check"></i><b>14.6</b> home work 2</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="webscraping-example-3-pubmed-and-r-with-endnote.html"><a href="webscraping-example-3-pubmed-and-r-with-endnote.html"><i class="fa fa-check"></i><b>15</b> WebScraping Example 3: PubMed and R with EndNote</a>
<ul>
<li class="chapter" data-level="15.1" data-path="webscraping-example-3-pubmed-and-r-with-endnote.html"><a href="webscraping-example-3-pubmed-and-r-with-endnote.html#pubmed-검색-방법"><i class="fa fa-check"></i><b>15.1</b> PubMed 검색 방법</a></li>
<li class="chapter" data-level="15.2" data-path="webscraping-example-3-pubmed-and-r-with-endnote.html"><a href="webscraping-example-3-pubmed-and-r-with-endnote.html#r-에서-pubmed-query-사용"><i class="fa fa-check"></i><b>15.2</b> R 에서 PubMed Query 사용</a></li>
<li class="chapter" data-level="15.3" data-path="webscraping-example-3-pubmed-and-r-with-endnote.html"><a href="webscraping-example-3-pubmed-and-r-with-endnote.html#pdf-자동-보고서"><i class="fa fa-check"></i><b>15.3</b> PDF 자동 보고서</a></li>
<li class="chapter" data-level="15.4" data-path="webscraping-example-3-pubmed-and-r-with-endnote.html"><a href="webscraping-example-3-pubmed-and-r-with-endnote.html#원문-pdf-찾기"><i class="fa fa-check"></i><b>15.4</b> 원문 PDF 찾기</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="date-and-time-series.html"><a href="date-and-time-series.html"><i class="fa fa-check"></i><b>16</b> Date and time series</a>
<ul>
<li class="chapter" data-level="16.1" data-path="date-and-time-series.html"><a href="date-and-time-series.html#date-create"><i class="fa fa-check"></i><b>16.1</b> Date create</a></li>
<li class="chapter" data-level="16.2" data-path="date-and-time-series.html"><a href="date-and-time-series.html#tutor-heat-wave-and-death"><i class="fa fa-check"></i><b>16.2</b> Tutor: heat wave and death</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="date-and-time-series.html"><a href="date-and-time-series.html#date-create-1"><i class="fa fa-check"></i><b>16.2.1</b> date create</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="date-and-time-series.html"><a href="date-and-time-series.html#home-work"><i class="fa fa-check"></i><b>16.3</b> home work</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="date-and-time-series.html"><a href="date-and-time-series.html#home0"><i class="fa fa-check"></i><b>16.3.1</b> home0</a></li>
<li class="chapter" data-level="16.3.2" data-path="date-and-time-series.html"><a href="date-and-time-series.html#home-work1"><i class="fa fa-check"></i><b>16.3.2</b> home work1</a></li>
<li class="chapter" data-level="16.3.3" data-path="date-and-time-series.html"><a href="date-and-time-series.html#home-work2"><i class="fa fa-check"></i><b>16.3.3</b> home work2</a></li>
<li class="chapter" data-level="16.3.4" data-path="date-and-time-series.html"><a href="date-and-time-series.html#home-work3"><i class="fa fa-check"></i><b>16.3.4</b> home work3</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="date-and-time-series.html"><a href="date-and-time-series.html#time-series-data-analysis"><i class="fa fa-check"></i><b>16.4</b> Time series data analysis</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="date-and-time-series.html"><a href="date-and-time-series.html#outside-사망에-대해서"><i class="fa fa-check"></i><b>16.4.1</b> outside 사망에 대해서</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="date-and-time-series.html"><a href="date-and-time-series.html#time-series-data-analysis-regression"><i class="fa fa-check"></i><b>16.5</b> Time series data analysis, regression</a></li>
<li class="chapter" data-level="16.6" data-path="date-and-time-series.html"><a href="date-and-time-series.html#introduction-3"><i class="fa fa-check"></i><b>16.6</b> introduction</a></li>
<li class="chapter" data-level="16.7" data-path="date-and-time-series.html"><a href="date-and-time-series.html#미세먼지와-심혈관사망"><i class="fa fa-check"></i><b>16.7</b> 미세먼지와 심혈관사망</a></li>
<li class="chapter" data-level="16.8" data-path="date-and-time-series.html"><a href="date-and-time-series.html#방법-tutor"><i class="fa fa-check"></i><b>16.8</b> 방법 tutor</a></li>
</ul></li>
<li class="part"><span><b>IV Repeat and Reproducibility</b></span></li>
<li class="chapter" data-level="17" data-path="repeated-analysis.html"><a href="repeated-analysis.html"><i class="fa fa-check"></i><b>17</b> Repeated analysis</a>
<ul>
<li class="chapter" data-level="17.1" data-path="repeated-analysis.html"><a href="repeated-analysis.html#추출"><i class="fa fa-check"></i><b>17.1</b> 추출</a></li>
<li class="chapter" data-level="17.2" data-path="repeated-analysis.html"><a href="repeated-analysis.html#파일-불러오기"><i class="fa fa-check"></i><b>17.2</b> 파일 불러오기</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="repeated-analysis.html"><a href="repeated-analysis.html#과제-2"><i class="fa fa-check"></i><b>17.2.1</b> 과제</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="repeated-analysis.html"><a href="repeated-analysis.html#분석-반복하기-change-point-찾기"><i class="fa fa-check"></i><b>17.3</b> 분석 반복하기 (change point 찾기)</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="repeated-analysis.html"><a href="repeated-analysis.html#자료-생성"><i class="fa fa-check"></i><b>17.3.1</b> 자료 생성</a></li>
<li class="chapter" data-level="17.3.2" data-path="repeated-analysis.html"><a href="repeated-analysis.html#가상의-threshold-값-수행해보기"><i class="fa fa-check"></i><b>17.3.2</b> 가상의 threshold 값 수행해보기</a></li>
<li class="chapter" data-level="17.3.3" data-path="repeated-analysis.html"><a href="repeated-analysis.html#과제-3"><i class="fa fa-check"></i><b>17.3.3</b> 과제</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="repeated-analysis.html"><a href="repeated-analysis.html#repeated-analysis-big-data"><i class="fa fa-check"></i><b>17.4</b> Repeated analysis (big data)</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="repeated-analysis.html"><a href="repeated-analysis.html#data-profile"><i class="fa fa-check"></i><b>17.4.1</b> Data profile</a></li>
<li class="chapter" data-level="17.4.2" data-path="repeated-analysis.html"><a href="repeated-analysis.html#data-handling-start"><i class="fa fa-check"></i><b>17.4.2</b> data handling start</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V Communication</b></span></li>
<li class="chapter" data-level="18" data-path="r-markdown.html"><a href="r-markdown.html"><i class="fa fa-check"></i><b>18</b> R markdown</a>
<ul>
<li class="chapter" data-level="18.1" data-path="r-markdown.html"><a href="r-markdown.html#설치"><i class="fa fa-check"></i><b>18.1</b> 설치</a></li>
<li class="chapter" data-level="18.2" data-path="r-markdown.html"><a href="r-markdown.html#components"><i class="fa fa-check"></i><b>18.2</b> 3 components</a></li>
<li class="chapter" data-level="18.3" data-path="r-markdown.html"><a href="r-markdown.html#simple-tutor"><i class="fa fa-check"></i><b>18.3</b> simple tutor</a></li>
<li class="chapter" data-level="18.4" data-path="r-markdown.html"><a href="r-markdown.html#chunck-option"><i class="fa fa-check"></i><b>18.4</b> chunck option</a></li>
<li class="chapter" data-level="18.5" data-path="r-markdown.html"><a href="r-markdown.html#table-만들기"><i class="fa fa-check"></i><b>18.5</b> Table 만들기</a></li>
<li class="chapter" data-level="18.6" data-path="r-markdown.html"><a href="r-markdown.html#필독"><i class="fa fa-check"></i><b>18.6</b> 필독!</a></li>
<li class="chapter" data-level="18.7" data-path="r-markdown.html"><a href="r-markdown.html#동영상-1"><i class="fa fa-check"></i><b>18.7</b> 동영상</a></li>
<li class="chapter" data-level="18.8" data-path="r-markdown.html"><a href="r-markdown.html#과제-4"><i class="fa fa-check"></i><b>18.8</b> 과제</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="rmarkdown-and-reporting.html"><a href="rmarkdown-and-reporting.html"><i class="fa fa-check"></i><b>19</b> Rmarkdown and reporting</a>
<ul>
<li class="chapter" data-level="19.1" data-path="rmarkdown-and-reporting.html"><a href="rmarkdown-and-reporting.html#rmarkdown-and-word-office-down"><i class="fa fa-check"></i><b>19.1</b> Rmarkdown and Word (office down)</a></li>
<li class="chapter" data-level="19.2" data-path="rmarkdown-and-reporting.html"><a href="rmarkdown-and-reporting.html#rmarkdown-and-pdf"><i class="fa fa-check"></i><b>19.2</b> Rmarkdown and PDF</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="google-maps-platform.html"><a href="google-maps-platform.html"><i class="fa fa-check"></i><b>20</b> Google Maps Platform</a>
<ul>
<li class="chapter" data-level="20.1" data-path="google-maps-platform.html"><a href="google-maps-platform.html#google-tackeout"><i class="fa fa-check"></i><b>20.1</b> Google Tackeout</a></li>
<li class="chapter" data-level="20.2" data-path="google-maps-platform.html"><a href="google-maps-platform.html#data-visualization"><i class="fa fa-check"></i><b>20.2</b> Data visualization</a></li>
<li class="chapter" data-level="20.3" data-path="google-maps-platform.html"><a href="google-maps-platform.html#google-api"><i class="fa fa-check"></i><b>20.3</b> google API</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="leaflet.html"><a href="leaflet.html"><i class="fa fa-check"></i><b>21</b> Map using leaflet</a>
<ul>
<li class="chapter" data-level="21.1" data-path="leaflet.html"><a href="leaflet.html#leaflet-1"><i class="fa fa-check"></i><b>21.1</b> leaflet</a></li>
<li class="chapter" data-level="21.2" data-path="leaflet.html"><a href="leaflet.html#위치와-시간표시"><i class="fa fa-check"></i><b>21.2</b> 위치와 시간표시</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="shinyapps.html"><a href="shinyapps.html"><i class="fa fa-check"></i><b>22</b> shinyapps</a>
<ul>
<li class="chapter" data-level="22.1" data-path="shinyapps.html"><a href="shinyapps.html#설치-1"><i class="fa fa-check"></i><b>22.1</b> 설치</a></li>
<li class="chapter" data-level="22.2" data-path="shinyapps.html"><a href="shinyapps.html#예제"><i class="fa fa-check"></i><b>22.2</b> 예제</a></li>
<li class="chapter" data-level="22.3" data-path="shinyapps.html"><a href="shinyapps.html#예제-1-만들기"><i class="fa fa-check"></i><b>22.3</b> 예제 1 만들기</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="shinyapps.html"><a href="shinyapps.html#구조"><i class="fa fa-check"></i><b>22.3.1</b> 구조</a></li>
<li class="chapter" data-level="22.3.2" data-path="shinyapps.html"><a href="shinyapps.html#input-output"><i class="fa fa-check"></i><b>22.3.2</b> input, output</a></li>
<li class="chapter" data-level="22.3.3" data-path="shinyapps.html"><a href="shinyapps.html#과제-5"><i class="fa fa-check"></i><b>22.3.3</b> 과제</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="shinyapps.html"><a href="shinyapps.html#지도앱-만들기"><i class="fa fa-check"></i><b>22.4</b> 지도앱 만들기</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">DsPubs with R tutor book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="statistical-plot-with-ggplot2" class="section level1 hasAnchor" number="11">
<h1><span class="header-section-number">Chapter 11</span> Statistical Plot with ggplot2<a href="statistical-plot-with-ggplot2.html#statistical-plot-with-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter will discuss about visualization focus on visualization of statistical summary. I will introduce how to easily visualize of T-test, chi square test, regression and logistic regression with adding of significance level.</p>
<p><iframe width="560" height="315" src="https://www.youtube.com/embed/3IdAlad3VgM" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
## Prerequisite</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="statistical-plot-with-ggplot2.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb1-2"><a href="statistical-plot-with-ggplot2.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#basic requirment</span></span>
<span id="cb1-3"><a href="statistical-plot-with-ggplot2.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;tidyverse&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb1-4"><a href="statistical-plot-with-ggplot2.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;htmlTable&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;htmlTable&quot;</span>)</span>
<span id="cb1-5"><a href="statistical-plot-with-ggplot2.html#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;broom&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;broom&quot;</span>)</span>
<span id="cb1-6"><a href="statistical-plot-with-ggplot2.html#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;ggthemes&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;ggthemes&quot;</span>)</span>
<span id="cb1-7"><a href="statistical-plot-with-ggplot2.html#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># packages from github</span></span>
<span id="cb1-8"><a href="statistical-plot-with-ggplot2.html#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;devtools&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</span>
<span id="cb1-9"><a href="statistical-plot-with-ggplot2.html#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb1-10"><a href="statistical-plot-with-ggplot2.html#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">install_github</span>(<span class="st">&quot;jinhaslab/tabf&quot;</span>, <span class="at">force =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-11"><a href="statistical-plot-with-ggplot2.html#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tabf)</span></code></pre></div>
<p>The data locate in dspubs.org’s open data . kwcsData1.rds will be used. I made <strong>folder name of data</strong> and saved the download file into data directory.
The way of loading rds data is through the readRDS(pathway). The step of data manipulation is most import task, the chapter Data Manipulation should be reviewed prior to follow this chapter.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="statistical-plot-with-ggplot2.html#cb2-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://dspubs.org/webapps/forum/open_data/kwcsDataShort.rds&quot;</span></span>
<span id="cb2-2"><a href="statistical-plot-with-ggplot2.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(url, <span class="st">&quot;data/kwcsDataShort.rds&quot;</span>)</span>
<span id="cb2-3"><a href="statistical-plot-with-ggplot2.html#cb2-3" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="st">&quot;data/kwcsDataShort.rds&quot;</span>)</span></code></pre></div>
<div id="t-test-and-chisq-test-visualization" class="section level2 hasAnchor" number="11.1">
<h2><span class="header-section-number">11.1</span> T-test and Chisq-test Visualization<a href="statistical-plot-with-ggplot2.html#t-test-and-chisq-test-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You can select variable after data manipulation, we created sleepgp, shortReturn, njob, sexgp, edugp, empgp in chapter of Data manipulation and Tables for pulblic health 1. Then, those selected variables will categorized into stratas, catVars, conVars. The function of tabf() create cross table by htmlTable(). tabf() function needs data1 as data to be used for table, stratas as group variables in the head, catVars as categorical variables, conVars = continues variables.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="statistical-plot-with-ggplot2.html#cb3-1" aria-hidden="true" tabindex="-1"></a>stratas  <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;sleepgp&quot;</span>)</span>
<span id="cb3-2"><a href="statistical-plot-with-ggplot2.html#cb3-2" aria-hidden="true" tabindex="-1"></a>catVars <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;wwa1gp&quot;</span>, <span class="st">&quot;shortReturn&quot;</span>,<span class="st">&quot;shiftWork&quot;</span> , <span class="st">&quot;njob&quot;</span>, <span class="st">&quot;sexgp&quot;</span>,  <span class="st">&quot;edugp&quot;</span>, <span class="st">&quot;empgp&quot;</span>)</span>
<span id="cb3-3"><a href="statistical-plot-with-ggplot2.html#cb3-3" aria-hidden="true" tabindex="-1"></a>conVars <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;AGE&quot;</span>,<span class="st">&quot;satisfaction&quot;</span>)</span>
<span id="cb3-4"><a href="statistical-plot-with-ggplot2.html#cb3-4" aria-hidden="true" tabindex="-1"></a>tab1 <span class="ot">=</span> <span class="fu">tabf</span>(<span class="at">dat1=</span>dat1, <span class="at">stratas =</span> stratas, <span class="at">catVars =</span> catVars, <span class="at">conVars =</span> conVars)</span>
<span id="cb3-5"><a href="statistical-plot-with-ggplot2.html#cb3-5" aria-hidden="true" tabindex="-1"></a>tab1 <span class="sc">%&gt;%</span> </span>
<span id="cb3-6"><a href="statistical-plot-with-ggplot2.html#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;None&quot;</span>, <span class="st">&quot;Disturbance&quot;</span>, <span class="st">&quot;P value&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-7"><a href="statistical-plot-with-ggplot2.html#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">htmlTable</span>(</span>
<span id="cb3-8"><a href="statistical-plot-with-ggplot2.html#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">cgroup =</span> <span class="fu">c</span>(<span class="st">&quot;&quot;</span>,  <span class="st">&quot;Sleep disturbance&quot;</span>, <span class="st">&quot;&quot;</span>), </span>
<span id="cb3-9"><a href="statistical-plot-with-ggplot2.html#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">n.cgroup =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>), </span>
<span id="cb3-10"><a href="statistical-plot-with-ggplot2.html#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">tfoot =</span> <span class="st">&quot;P value calculated by Chisq-Test and T-Test&quot;</span>, </span>
<span id="cb3-11"><a href="statistical-plot-with-ggplot2.html#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">rnames =</span> <span class="cn">FALSE</span>, </span>
<span id="cb3-12"><a href="statistical-plot-with-ggplot2.html#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;Basic Characteristics according to Sleep disturbance&quot;</span> ,</span>
<span id="cb3-13"><a href="statistical-plot-with-ggplot2.html#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">css.table =</span> <span class="st">&quot;font-family: Times&quot;</span></span>
<span id="cb3-14"><a href="statistical-plot-with-ggplot2.html#cb3-14" aria-hidden="true" tabindex="-1"></a>  ) </span></code></pre></div>
<table class="gmisc_table" style="border-collapse: collapse; font-family: Times">
<thead>
<tr>
<td colspan="7" style="text-align: left;">
Basic Characteristics according to Sleep disturbance
</td>
</tr>
<tr>
<th colspan="2" style="font-weight: 900; border-top: 2px solid grey; text-align: center;">
</th>
<th style="border-bottom: none; border-top: 2px solid grey;" colspan="1">
 
</th>
<th colspan="2" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Sleep disturbance
</th>
<th style="border-bottom: none; border-top: 2px solid grey;" colspan="1">
 
</th>
<th colspan="1" style="font-weight: 900; border-top: 2px solid grey; text-align: center;">
</th>
</tr>
<tr>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;" colspan="1">
 
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
None
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
Disturbance
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;" colspan="1">
 
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
P value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">
wwa1gp
</td>
<td style="text-align: center;">
Never
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
12222 (94.7%)
</td>
<td style="text-align: center;">
684 (5.3%)
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
Rarely
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
12316 (94.5%)
</td>
<td style="text-align: center;">
714 (5.5%)
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
</td>
</tr>
<tr>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
Sometimes
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
9112 (90.3%)
</td>
<td style="text-align: center;">
981 (9.7%)
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
</td>
</tr>
<tr>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
Often
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
3456 (82.8%)
</td>
<td style="text-align: center;">
717 (17.2%)
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
</td>
</tr>
<tr>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
Always
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
634 (70.0%)
</td>
<td style="text-align: center;">
272 (30.0%)
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
</td>
</tr>
<tr>
<td style="text-align: center;">
shortReturn
</td>
<td style="text-align: center;">
non short return
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
36183 (92.5%)
</td>
<td style="text-align: center;">
2927 (7.5%)
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
short return
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
1557 (77.9%)
</td>
<td style="text-align: center;">
441 (22.1%)
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
</td>
</tr>
<tr>
<td style="text-align: center;">
shiftWork
</td>
<td style="text-align: center;">
non shift work
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
35056 (91.9%)
</td>
<td style="text-align: center;">
3073 (8.1%)
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
shift work
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
2684 (90.1%)
</td>
<td style="text-align: center;">
295 (9.9%)
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
</td>
</tr>
<tr>
<td style="text-align: center;">
njob
</td>
<td style="text-align: center;">
one-job
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
37471 (91.9%)
</td>
<td style="text-align: center;">
3317 (8.1%)
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
njob
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
269 (84.1%)
</td>
<td style="text-align: center;">
51 (15.9%)
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
</td>
</tr>
<tr>
<td style="text-align: center;">
sexgp
</td>
<td style="text-align: center;">
Men
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
17892 (93.1%)
</td>
<td style="text-align: center;">
1327 (6.9%)
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
Women
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
19848 (90.7%)
</td>
<td style="text-align: center;">
2041 (9.3%)
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
</td>
</tr>
<tr>
<td style="text-align: center;">
edugp
</td>
<td style="text-align: center;">
university or more
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
19597 (92.9%)
</td>
<td style="text-align: center;">
1502 (7.1%)
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
high school
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
14943 (91.9%)
</td>
<td style="text-align: center;">
1318 (8.1%)
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
</td>
</tr>
<tr>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
middle school or below
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
3200 (85.4%)
</td>
<td style="text-align: center;">
548 (14.6%)
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
</td>
</tr>
<tr>
<td style="text-align: center;">
empgp
</td>
<td style="text-align: center;">
paid-worker
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
25786 (92.4%)
</td>
<td style="text-align: center;">
2122 (7.6%)
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
employer/self-employer
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
2539 (91.7%)
</td>
<td style="text-align: center;">
229 (8.3%)
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
</td>
</tr>
<tr>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
own-account worker
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
8359 (90.5%)
</td>
<td style="text-align: center;">
880 (9.5%)
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
</td>
</tr>
<tr>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
unpaind family work
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
1056 (88.5%)
</td>
<td style="text-align: center;">
137 (11.5%)
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
</td>
</tr>
<tr>
<td style="text-align: center;">
AGE
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
46.8±12.4
</td>
<td style="text-align: center;">
49.7±11.9
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
&lt;0.001
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: center;">
satisfaction
</td>
<td style="border-bottom: 2px solid grey; text-align: center;">
</td>
<td style="border-bottom: 2px solid grey; text-align: center;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: center;">
2.1±0.5
</td>
<td style="border-bottom: 2px solid grey; text-align: center;">
2.4±0.6
</td>
<td style="border-bottom: 2px solid grey; text-align: center;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: center;">
&lt;0.001
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td colspan="7">
P value calculated by Chisq-Test and T-Test
</td>
</tr>
</tfoot>
</table>
<blockquote>
<p>T-test</p>
</blockquote>
<p>The mean level of age are differ according to sleep disturbance. Box plot show mean and distribution of values. There are two method of t.test in R. One is using two vector, and the other is using of relationship.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="statistical-plot-with-ggplot2.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#stratas = &quot;sleepgp&quot;</span></span>
<span id="cb4-2"><a href="statistical-plot-with-ggplot2.html#cb4-2" aria-hidden="true" tabindex="-1"></a>age1 <span class="ot">=</span> dat1<span class="sc">$</span>AGE[dat1<span class="sc">$</span>sleepgp <span class="sc">==</span><span class="st">&quot;0.non distrubance&quot;</span>]</span>
<span id="cb4-3"><a href="statistical-plot-with-ggplot2.html#cb4-3" aria-hidden="true" tabindex="-1"></a>age2 <span class="ot">=</span> dat1<span class="sc">$</span>AGE[dat1<span class="sc">$</span>sleepgp <span class="sc">==</span><span class="st">&quot;1.sleep disturbance&quot;</span>] </span>
<span id="cb4-4"><a href="statistical-plot-with-ggplot2.html#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(age1, age2)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  age1 and age2
## t = -13.409, df = 4040.8, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -3.306275 -2.462776
## sample estimates:
## mean of x mean of y 
##  46.77878  49.66330</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="statistical-plot-with-ggplot2.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(dat1<span class="sc">$</span>AGE <span class="sc">~</span> dat1<span class="sc">$</span>sleepgp)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  dat1$AGE by dat1$sleepgp
## t = -13.409, df = 4040.8, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means between group 0.non distrubance and group 1.sleep disturbance is not equal to 0
## 95 percent confidence interval:
##  -3.306275 -2.462776
## sample estimates:
##   mean in group 0.non distrubance mean in group 1.sleep disturbance 
##                          46.77878                          49.66330</code></pre>
<p>T test’s p-value can be generated by following pipe code.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="statistical-plot-with-ggplot2.html#cb8-1" aria-hidden="true" tabindex="-1"></a>ttestPvalue <span class="ot">&lt;-</span> dat1 <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="statistical-plot-with-ggplot2.html#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sleepgp, AGE) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="statistical-plot-with-ggplot2.html#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>sleepgp) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="statistical-plot-with-ggplot2.html#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="at">dat=</span><span class="sc">-</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="statistical-plot-with-ggplot2.html#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span><span class="fu">map</span>(dat, <span class="sc">~</span><span class="fu">t.test</span>(.<span class="sc">$</span>value <span class="sc">~</span> .<span class="sc">$</span>sleepgp)), </span>
<span id="cb8-6"><a href="statistical-plot-with-ggplot2.html#cb8-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">tidied =</span><span class="fu">map</span>(fit, tidy)) <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="statistical-plot-with-ggplot2.html#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span></span>
<span id="cb8-8"><a href="statistical-plot-with-ggplot2.html#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, p.value) <span class="sc">%&gt;%</span></span>
<span id="cb8-9"><a href="statistical-plot-with-ggplot2.html#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pvalue =</span> <span class="fu">ifelse</span>(p.value <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;&lt;0.001&quot;</span>, <span class="fu">sprintf</span>(<span class="st">&quot;%.3f&quot;</span>, p.value))) <span class="sc">%&gt;%</span></span>
<span id="cb8-10"><a href="statistical-plot-with-ggplot2.html#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(pvalue)</span>
<span id="cb8-11"><a href="statistical-plot-with-ggplot2.html#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="statistical-plot-with-ggplot2.html#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 위에는 여러개의 p value를 구할때 사용하는 것이고 하나만 사용할 때는</span></span>
<span id="cb8-13"><a href="statistical-plot-with-ggplot2.html#cb8-13" aria-hidden="true" tabindex="-1"></a>myttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(dat1<span class="sc">$</span>AGE <span class="sc">~</span> dat1<span class="sc">$</span>sexgp)</span>
<span id="cb8-14"><a href="statistical-plot-with-ggplot2.html#cb8-14" aria-hidden="true" tabindex="-1"></a>myttest<span class="sc">$</span>p.value <span class="co">#를 사용한다. </span></span></code></pre></div>
<pre><code>## [1] 3.287249e-28</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="statistical-plot-with-ggplot2.html#cb10-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="statistical-plot-with-ggplot2.html#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sleepgp, AGE) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="statistical-plot-with-ggplot2.html#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>sleepgp, <span class="at">y=</span> AGE)) <span class="sc">+</span></span>
<span id="cb10-4"><a href="statistical-plot-with-ggplot2.html#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() </span></code></pre></div>
<p><img src="testbook_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="statistical-plot-with-ggplot2.html#cb11-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="statistical-plot-with-ggplot2.html#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sleepgp, AGE) <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="statistical-plot-with-ggplot2.html#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>sleepgp, <span class="at">y=</span> AGE)) <span class="sc">+</span></span>
<span id="cb11-4"><a href="statistical-plot-with-ggplot2.html#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb11-5"><a href="statistical-plot-with-ggplot2.html#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Age according to sleep disturbance&quot;</span>)<span class="sc">+</span></span>
<span id="cb11-6"><a href="statistical-plot-with-ggplot2.html#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Sleep Disturbance&quot;</span>) <span class="sc">+</span> </span>
<span id="cb11-7"><a href="statistical-plot-with-ggplot2.html#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Times&quot;</span>))</span></code></pre></div>
<p><img src="testbook_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="statistical-plot-with-ggplot2.html#cb12-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="statistical-plot-with-ggplot2.html#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sleepgp, AGE) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="statistical-plot-with-ggplot2.html#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>sleepgp, <span class="at">y=</span> AGE)) <span class="sc">+</span></span>
<span id="cb12-4"><a href="statistical-plot-with-ggplot2.html#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb12-5"><a href="statistical-plot-with-ggplot2.html#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Age according to sleep disturbance&quot;</span>)<span class="sc">+</span></span>
<span id="cb12-6"><a href="statistical-plot-with-ggplot2.html#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Sleep Disturbance&quot;</span>) <span class="sc">+</span> </span>
<span id="cb12-7"><a href="statistical-plot-with-ggplot2.html#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb12-8"><a href="statistical-plot-with-ggplot2.html#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span><span class="st">&quot;text&quot;</span>, <span class="sc">-</span><span class="cn">Inf</span>, <span class="cn">Inf</span>, </span>
<span id="cb12-9"><a href="statistical-plot-with-ggplot2.html#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust=</span><span class="sc">-</span><span class="dv">3</span>, <span class="at">vjust=</span><span class="dv">5</span>,</span>
<span id="cb12-10"><a href="statistical-plot-with-ggplot2.html#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span><span class="fu">sprintf</span>(<span class="st">&quot;P value:  %s&quot;</span>, ttestPvalue), </span>
<span id="cb12-11"><a href="statistical-plot-with-ggplot2.html#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">&quot;Times&quot;</span></span>
<span id="cb12-12"><a href="statistical-plot-with-ggplot2.html#cb12-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb12-13"><a href="statistical-plot-with-ggplot2.html#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Times&quot;</span>)) </span></code></pre></div>
<p><img src="testbook_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<blockquote>
<p>Chisq Test</p>
</blockquote>
<p><code>wwa1gp</code> is “A. kept worrying about work when you were not working”, and the response is <code>0.Never</code>, <code>1.Rarely</code>, <code>2.Sometimes</code>, <code>3.Often</code> and <code>4.Always</code>. In the previous table, the distribution of sleep distrubance are differ according to wwa1gp. <br>
The bar chart is one of the best option for distribution visualization.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="statistical-plot-with-ggplot2.html#cb13-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="statistical-plot-with-ggplot2.html#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(wwa1gp) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="statistical-plot-with-ggplot2.html#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sleepgp) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="statistical-plot-with-ggplot2.html#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)<span class="sc">*</span><span class="dv">100</span>, </span>
<span id="cb13-5"><a href="statistical-plot-with-ggplot2.html#cb13-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">prob =</span> <span class="fu">round</span>(prob, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="statistical-plot-with-ggplot2.html#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sleepgp <span class="sc">==</span><span class="st">&quot;1.sleep disturbance&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-7"><a href="statistical-plot-with-ggplot2.html#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>wwa1gp, <span class="at">y =</span> prob)) <span class="sc">+</span></span>
<span id="cb13-8"><a href="statistical-plot-with-ggplot2.html#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)</span></code></pre></div>
<p><img src="testbook_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>Some modification are needed to communicat to other researcher. Percent scale are easy to follow.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="statistical-plot-with-ggplot2.html#cb14-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="statistical-plot-with-ggplot2.html#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(wwa1gp) <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="statistical-plot-with-ggplot2.html#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sleepgp) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="statistical-plot-with-ggplot2.html#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)<span class="sc">*</span><span class="dv">100</span>, </span>
<span id="cb14-5"><a href="statistical-plot-with-ggplot2.html#cb14-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">prob =</span> <span class="fu">round</span>(prob, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="statistical-plot-with-ggplot2.html#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sleepgp <span class="sc">==</span><span class="st">&quot;1.sleep disturbance&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-7"><a href="statistical-plot-with-ggplot2.html#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>wwa1gp, <span class="at">y =</span> prob)) <span class="sc">+</span></span>
<span id="cb14-8"><a href="statistical-plot-with-ggplot2.html#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Times New Roman&quot;</span>, <span class="at">face=</span><span class="st">&quot;bold&quot;</span>, <span class="at">size=</span><span class="dv">12</span>)) <span class="sc">+</span></span>
<span id="cb14-9"><a href="statistical-plot-with-ggplot2.html#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;kept worrying about work when you were not working&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-10"><a href="statistical-plot-with-ggplot2.html#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Sleep Disturbance (proportion)&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-11"><a href="statistical-plot-with-ggplot2.html#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fl">0.35</span>)<span class="sc">+</span></span>
<span id="cb14-12"><a href="statistical-plot-with-ggplot2.html#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-13"><a href="statistical-plot-with-ggplot2.html#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s%%&quot;</span>, prob)),  <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb14-14"><a href="statistical-plot-with-ggplot2.html#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">&quot;%s%%&quot;</span>, <span class="fu">round</span>(x)))</span></code></pre></div>
<p><img src="testbook_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Now, we added the p value of chisq.test().</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="statistical-plot-with-ggplot2.html#cb15-1" aria-hidden="true" tabindex="-1"></a>chisqp <span class="ot">=</span> dat1 <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="statistical-plot-with-ggplot2.html#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(wwa1gp, sleepgp) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="statistical-plot-with-ggplot2.html#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="statistical-plot-with-ggplot2.html#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">chisq.test</span>()</span>
<span id="cb15-5"><a href="statistical-plot-with-ggplot2.html#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (chisqp<span class="sc">$</span>p.value <span class="sc">&lt;</span><span class="fl">0.001</span>){</span>
<span id="cb15-6"><a href="statistical-plot-with-ggplot2.html#cb15-6" aria-hidden="true" tabindex="-1"></a>  pChisqV <span class="ot">=</span> <span class="st">&quot;&lt;0.001&quot;</span></span>
<span id="cb15-7"><a href="statistical-plot-with-ggplot2.html#cb15-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span>{</span>
<span id="cb15-8"><a href="statistical-plot-with-ggplot2.html#cb15-8" aria-hidden="true" tabindex="-1"></a>    pChisqV <span class="ot">=</span> chisqp<span class="sc">$</span>p.value <span class="sc">%&gt;%</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.3f&quot;</span>, .)</span>
<span id="cb15-9"><a href="statistical-plot-with-ggplot2.html#cb15-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-10"><a href="statistical-plot-with-ggplot2.html#cb15-10" aria-hidden="true" tabindex="-1"></a>pChisqV</span></code></pre></div>
<pre><code>## [1] &quot;&lt;0.001&quot;</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="statistical-plot-with-ggplot2.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#library(extrafont)</span></span>
<span id="cb17-2"><a href="statistical-plot-with-ggplot2.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb17-3"><a href="statistical-plot-with-ggplot2.html#cb17-3" aria-hidden="true" tabindex="-1"></a>dat1 <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="statistical-plot-with-ggplot2.html#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(wwa1gp) <span class="sc">%&gt;%</span></span>
<span id="cb17-5"><a href="statistical-plot-with-ggplot2.html#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sleepgp) <span class="sc">%&gt;%</span></span>
<span id="cb17-6"><a href="statistical-plot-with-ggplot2.html#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)<span class="sc">*</span><span class="dv">100</span>, </span>
<span id="cb17-7"><a href="statistical-plot-with-ggplot2.html#cb17-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">prob =</span> <span class="fu">round</span>(prob, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-8"><a href="statistical-plot-with-ggplot2.html#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sleepgp <span class="sc">==</span><span class="st">&quot;1.sleep disturbance&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-9"><a href="statistical-plot-with-ggplot2.html#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>wwa1gp, <span class="at">y =</span> prob)) <span class="sc">+</span></span>
<span id="cb17-10"><a href="statistical-plot-with-ggplot2.html#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;kept worrying about work when you were not working&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-11"><a href="statistical-plot-with-ggplot2.html#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Sleep Disturbance (proportion)&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-12"><a href="statistical-plot-with-ggplot2.html#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-13"><a href="statistical-plot-with-ggplot2.html#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s%%&quot;</span>, prob)),  <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb17-14"><a href="statistical-plot-with-ggplot2.html#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">&quot;%s%%&quot;</span>, <span class="fu">round</span>(x))) <span class="sc">+</span></span>
<span id="cb17-15"><a href="statistical-plot-with-ggplot2.html#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb17-16"><a href="statistical-plot-with-ggplot2.html#cb17-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span><span class="st">&quot;text&quot;</span>, <span class="sc">-</span><span class="cn">Inf</span>, <span class="cn">Inf</span>, </span>
<span id="cb17-17"><a href="statistical-plot-with-ggplot2.html#cb17-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.5</span>, <span class="at">vjust=</span><span class="dv">8</span>,</span>
<span id="cb17-18"><a href="statistical-plot-with-ggplot2.html#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span><span class="fu">sprintf</span>(<span class="st">&quot;P value:  %s&quot;</span>, pChisqV), </span>
<span id="cb17-19"><a href="statistical-plot-with-ggplot2.html#cb17-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">&quot;Times New Roman&quot;</span>, </span>
<span id="cb17-20"><a href="statistical-plot-with-ggplot2.html#cb17-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">fontface =</span> <span class="st">&quot;bold&quot;</span></span>
<span id="cb17-21"><a href="statistical-plot-with-ggplot2.html#cb17-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb17-22"><a href="statistical-plot-with-ggplot2.html#cb17-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb17-23"><a href="statistical-plot-with-ggplot2.html#cb17-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Times New Roman&quot;</span>, <span class="at">face=</span><span class="st">&quot;bold&quot;</span>, <span class="at">size=</span><span class="dv">12</span>)) </span></code></pre></div>
<p><img src="testbook_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="odds-ratio-and-95-confidence-interval" class="section level2 hasAnchor" number="11.2">
<h2><span class="header-section-number">11.2</span> Odds ratio and 95% confidence interval<a href="statistical-plot-with-ggplot2.html#odds-ratio-and-95-confidence-interval" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>Logistic regression model</p>
</blockquote>
<p>There are 3 kind of models, model II and III are include more confounding variables compare to model I.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="statistical-plot-with-ggplot2.html#cb18-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">=</span> dat1 <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="statistical-plot-with-ggplot2.html#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(<span class="at">data=</span>.,<span class="at">family=</span><span class="st">&quot;binomial&quot;</span>,<span class="at">formula =</span> sleepgp <span class="sc">==</span> <span class="st">&quot;1.sleep disturbance&quot;</span>  </span>
<span id="cb18-3"><a href="statistical-plot-with-ggplot2.html#cb18-3" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span> wwa1gp)</span>
<span id="cb18-4"><a href="statistical-plot-with-ggplot2.html#cb18-4" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> dat1 <span class="sc">%&gt;%</span></span>
<span id="cb18-5"><a href="statistical-plot-with-ggplot2.html#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(<span class="at">data=</span>.,<span class="at">family=</span><span class="st">&quot;binomial&quot;</span>,<span class="at">formula =</span> sleepgp <span class="sc">==</span> <span class="st">&quot;1.sleep disturbance&quot;</span></span>
<span id="cb18-6"><a href="statistical-plot-with-ggplot2.html#cb18-6" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span> wwa1gp <span class="sc">+</span> AGE <span class="sc">+</span> sexgp <span class="sc">+</span>satisfaction)</span>
<span id="cb18-7"><a href="statistical-plot-with-ggplot2.html#cb18-7" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> dat1 <span class="sc">%&gt;%</span></span>
<span id="cb18-8"><a href="statistical-plot-with-ggplot2.html#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(<span class="at">data=</span>.,<span class="at">family=</span><span class="st">&quot;binomial&quot;</span>,<span class="at">formula =</span> sleepgp <span class="sc">==</span> <span class="st">&quot;1.sleep disturbance&quot;</span></span>
<span id="cb18-9"><a href="statistical-plot-with-ggplot2.html#cb18-9" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span> wwa1gp <span class="sc">+</span> AGE <span class="sc">+</span> sexgp <span class="sc">+</span>satisfaction <span class="sc">+</span> shiftWork <span class="sc">+</span> njob)</span></code></pre></div>
<p>oddf0() function gives us odds ratio, lower limt and upper limit (95% confidence interval). We can draw OR (95% CI) plot, using errobar() function. we can also change the color using RGB triplet (ref: <a href="http://www.cookbook-r.com/Graphs/Colors_(ggplot2)" class="uri">http://www.cookbook-r.com/Graphs/Colors_(ggplot2)</a>).</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="statistical-plot-with-ggplot2.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">oddf0</span>(mod1) <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="statistical-plot-with-ggplot2.html#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>values, <span class="at">x =</span> or)) <span class="sc">+</span></span>
<span id="cb19-3"><a href="statistical-plot-with-ggplot2.html#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb19-4"><a href="statistical-plot-with-ggplot2.html#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> ll, <span class="at">xmax =</span> ul), <span class="at">height =</span> <span class="fl">0.09</span>, <span class="at">color =</span> <span class="st">&quot;#666666&quot;</span>, <span class="at">size=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb19-5"><a href="statistical-plot-with-ggplot2.html#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">15</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;#444444&quot;</span>)  <span class="sc">+</span></span>
<span id="cb19-6"><a href="statistical-plot-with-ggplot2.html#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;#FF0000&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">cex =</span><span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb19-7"><a href="statistical-plot-with-ggplot2.html#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;kept worrying about work when you were not working&quot;</span>) <span class="sc">+</span></span>
<span id="cb19-8"><a href="statistical-plot-with-ggplot2.html#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Odds Ratio and 95% Confidence Interval of Sleep Dsturbance&quot;</span>) <span class="sc">+</span></span>
<span id="cb19-9"><a href="statistical-plot-with-ggplot2.html#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span><span class="st">&quot;Times&quot;</span>))</span></code></pre></div>
<p><img src="testbook_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>Vertical error bar also suitable to plot the OR (95% CI).</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="statistical-plot-with-ggplot2.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">oddf0</span>(mod1) <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="statistical-plot-with-ggplot2.html#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>values, <span class="at">y =</span> or)) <span class="sc">+</span></span>
<span id="cb20-3"><a href="statistical-plot-with-ggplot2.html#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb20-4"><a href="statistical-plot-with-ggplot2.html#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ll, <span class="at">ymax =</span> ul), <span class="at">width =</span> <span class="fl">0.07</span>, <span class="at">color =</span> <span class="st">&quot;#666666&quot;</span>, <span class="at">size=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb20-5"><a href="statistical-plot-with-ggplot2.html#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">15</span>, <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">color =</span> <span class="st">&quot;#444444&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-6"><a href="statistical-plot-with-ggplot2.html#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;#FF0000&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">cex =</span><span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb20-7"><a href="statistical-plot-with-ggplot2.html#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Kept worrying about work when you were not working&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-8"><a href="statistical-plot-with-ggplot2.html#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Odds Ratio and 95% Confidence Interval of Sleep Dsturbance&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-9"><a href="statistical-plot-with-ggplot2.html#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span><span class="st">&quot;Times&quot;</span>))</span></code></pre></div>
<p><img src="testbook_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
<div id="Labeled" class="section level2 hasAnchor" number="11.3">
<h2><span class="header-section-number">11.3</span> Multilevel and Labelled Data<a href="statistical-plot-with-ggplot2.html#Labeled" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/NuPxSLgEoX8" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<div id="introduction-1" class="section level3 hasAnchor" number="11.3.1">
<h3><span class="header-section-number">11.3.1</span> introduction<a href="statistical-plot-with-ggplot2.html#introduction-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In current data, We will used covid19 data from 16 countries. The group is country level and the interesting relationship is regarded on individual economic activity and psychological symptoms. In this chapter, we will discuss about how can visualization multi-level data (The original data are own to Laura, PH.D.)</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="statistical-plot-with-ggplot2.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;tidyverse&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb21-2"><a href="statistical-plot-with-ggplot2.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;ggthemes&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;ggthemes&quot;</span>)</span>
<span id="cb21-3"><a href="statistical-plot-with-ggplot2.html#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;ggrepel&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;ggrepel&quot;</span>)</span>
<span id="cb21-4"><a href="statistical-plot-with-ggplot2.html#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;gridExtra&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;gridExtra&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="statistical-plot-with-ggplot2.html#cb22-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://dspubs.org/webapps/forum/open_data/CovidJobLoss.rds&quot;</span></span>
<span id="cb22-2"><a href="statistical-plot-with-ggplot2.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(url, <span class="st">&quot;CovidJobLoss.rds&quot;</span>)</span>
<span id="cb22-3"><a href="statistical-plot-with-ggplot2.html#cb22-3" aria-hidden="true" tabindex="-1"></a>mm3 <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="st">&quot;data/CovidJobLoss.rds&quot;</span>)</span>
<span id="cb22-4"><a href="statistical-plot-with-ggplot2.html#cb22-4" aria-hidden="true" tabindex="-1"></a>url2 <span class="ot">&lt;-</span> <span class="st">&quot;https://dspubs.org/webapps/forum/open_data/hdi.csv&quot;</span></span>
<span id="cb22-5"><a href="statistical-plot-with-ggplot2.html#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(url2, <span class="st">&quot;data/hdi.csv&quot;</span>)</span>
<span id="cb22-6"><a href="statistical-plot-with-ggplot2.html#cb22-6" aria-hidden="true" tabindex="-1"></a>hdi <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/hdi.csv&quot;</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb22-7"><a href="statistical-plot-with-ggplot2.html#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">&#39;rank&#39;</span>, <span class="st">&#39;country&#39;</span>, <span class="st">&#39;y2019&#39;</span>, <span class="st">&#39;country_1&#39;</span>))</span>
<span id="cb22-8"><a href="statistical-plot-with-ggplot2.html#cb22-8" aria-hidden="true" tabindex="-1"></a>url3 <span class="ot">&lt;-</span> <span class="st">&quot;https://dspubs.org/webapps/forum/open_data/covid_agu1.csv&quot;</span></span>
<span id="cb22-9"><a href="statistical-plot-with-ggplot2.html#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(url3, <span class="st">&quot;data/covid_agu1.csv&quot;</span>)</span>
<span id="cb22-10"><a href="statistical-plot-with-ggplot2.html#cb22-10" aria-hidden="true" tabindex="-1"></a>agu1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;data/covid_agu1.csv&#39;</span>)</span></code></pre></div>
<p>Data manipulation for creating and reshaping variables. We will exam the assoicaton between human development index and covid related outcomes.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="statistical-plot-with-ggplot2.html#cb23-1" aria-hidden="true" tabindex="-1"></a>mm4 <span class="ot">&lt;-</span> mm3 <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="statistical-plot-with-ggplot2.html#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">agegp3 =</span> <span class="fu">ifelse</span>(age <span class="sc">&lt;=</span><span class="dv">40</span>, <span class="st">&#39;≤40&#39;</span>, <span class="st">&#39;&gt;40&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="statistical-plot-with-ggplot2.html#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">agegp3 =</span> <span class="fu">factor</span>(agegp3, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&#39;≤40&#39;</span>, <span class="st">&#39;&gt;40&#39;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="statistical-plot-with-ggplot2.html#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Education <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="statistical-plot-with-ggplot2.html#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">edugp =</span> <span class="fu">ifelse</span>(Education <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dv">1</span>, <span class="co"># high school or less</span></span>
<span id="cb23-6"><a href="statistical-plot-with-ggplot2.html#cb23-6" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">ifelse</span>(Education <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">3</span>),<span class="dv">2</span>, <span class="co"># college</span></span>
<span id="cb23-7"><a href="statistical-plot-with-ggplot2.html#cb23-7" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">ifelse</span>(Education <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>), <span class="dv">3</span>, <span class="dv">4</span>)))) <span class="sc">%&gt;%</span> <span class="co"># university (5, 6) Graduate school</span></span>
<span id="cb23-8"><a href="statistical-plot-with-ggplot2.html#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">edugp2 =</span> <span class="fu">ifelse</span>(Education <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-9"><a href="statistical-plot-with-ggplot2.html#cb23-9" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate</span>(<span class="at">EcLossAllgp =</span> <span class="fu">ifelse</span>(EcLossAll <span class="sc">==</span><span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="co">#%&gt;%</span></span>
<span id="cb23-10"><a href="statistical-plot-with-ggplot2.html#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="statistical-plot-with-ggplot2.html#cb23-11" aria-hidden="true" tabindex="-1"></a>mm4<span class="fl">.0</span> <span class="ot">=</span> mm4 <span class="sc">%&gt;%</span> <span class="co"># hid: human development index for each countries</span></span>
<span id="cb23-12"><a href="statistical-plot-with-ggplot2.html#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(hdi <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(country_1)) <span class="sc">%&gt;%</span></span>
<span id="cb23-13"><a href="statistical-plot-with-ggplot2.html#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">country_source =</span> country,</span>
<span id="cb23-14"><a href="statistical-plot-with-ggplot2.html#cb23-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">country=</span>country_1   ), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&#39;country&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-15"><a href="statistical-plot-with-ggplot2.html#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y2019 =</span> <span class="fu">ifelse</span>(country_c <span class="sc">==</span><span class="st">&#39;South Korea&#39;</span>, <span class="fl">0.916</span>, y2019))</span></code></pre></div>
</div>
<div id="data-analysis-start" class="section level3 hasAnchor" number="11.3.2">
<h3><span class="header-section-number">11.3.2</span> Data analysis start<a href="statistical-plot-with-ggplot2.html#data-analysis-start" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="job-loss-due-to-covid19-psychological-aggravation-according-to-gender" class="section level4 hasAnchor" number="11.3.2.1">
<h4><span class="header-section-number">11.3.2.1</span> job loss due to COVID19, psychological aggravation according to Gender<a href="statistical-plot-with-ggplot2.html#job-loss-due-to-covid19-psychological-aggravation-according-to-gender" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Explore data using basic static for job loss prevalence across country and genders. the pyschological aggravation due to covid-19 are also plotted according to same logic.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="statistical-plot-with-ggplot2.html#cb24-1" aria-hidden="true" tabindex="-1"></a>fig1 <span class="ot">&lt;-</span> mm4 <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="statistical-plot-with-ggplot2.html#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_c, gender) <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="statistical-plot-with-ggplot2.html#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(EcLossAllgp) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="statistical-plot-with-ggplot2.html#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="statistical-plot-with-ggplot2.html#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(EcLossAllgp <span class="sc">==</span> <span class="dv">1</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="statistical-plot-with-ggplot2.html#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">y =</span> prob, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb24-7"><a href="statistical-plot-with-ggplot2.html#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>)<span class="sc">+</span></span>
<span id="cb24-8"><a href="statistical-plot-with-ggplot2.html#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb24-9"><a href="statistical-plot-with-ggplot2.html#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Job loss due to COVID19&quot;</span>)<span class="sc">+</span></span>
<span id="cb24-10"><a href="statistical-plot-with-ggplot2.html#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(x<span class="sc">*</span><span class="dv">100</span>, <span class="st">&quot;%&quot;</span>))<span class="sc">+</span></span>
<span id="cb24-11"><a href="statistical-plot-with-ggplot2.html#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(country_c <span class="sc">~</span>., <span class="at">nrow =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb24-12"><a href="statistical-plot-with-ggplot2.html#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb24-13"><a href="statistical-plot-with-ggplot2.html#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">17</span>))<span class="sc">+</span></span>
<span id="cb24-14"><a href="statistical-plot-with-ggplot2.html#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">92</span>, .<span class="dv">1</span>))</span>
<span id="cb24-15"><a href="statistical-plot-with-ggplot2.html#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="statistical-plot-with-ggplot2.html#cb24-16" aria-hidden="true" tabindex="-1"></a>fig2 <span class="ot">&lt;-</span> mm4 <span class="sc">%&gt;%</span></span>
<span id="cb24-17"><a href="statistical-plot-with-ggplot2.html#cb24-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_c, gender) <span class="sc">%&gt;%</span></span>
<span id="cb24-18"><a href="statistical-plot-with-ggplot2.html#cb24-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(TotalDepAnx) <span class="sc">%&gt;%</span></span>
<span id="cb24-19"><a href="statistical-plot-with-ggplot2.html#cb24-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb24-20"><a href="statistical-plot-with-ggplot2.html#cb24-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TotalDepAnx <span class="sc">==</span> <span class="dv">1</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb24-21"><a href="statistical-plot-with-ggplot2.html#cb24-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">y =</span> prob, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb24-22"><a href="statistical-plot-with-ggplot2.html#cb24-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>)<span class="sc">+</span></span>
<span id="cb24-23"><a href="statistical-plot-with-ggplot2.html#cb24-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Psychological aggravation due to COVID19&quot;</span>)<span class="sc">+</span></span>
<span id="cb24-24"><a href="statistical-plot-with-ggplot2.html#cb24-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Gender&#39;</span>)<span class="sc">+</span></span>
<span id="cb24-25"><a href="statistical-plot-with-ggplot2.html#cb24-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(x<span class="sc">*</span><span class="dv">100</span>, <span class="st">&quot;%&quot;</span>))<span class="sc">+</span></span>
<span id="cb24-26"><a href="statistical-plot-with-ggplot2.html#cb24-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(country_c <span class="sc">~</span>., <span class="at">nrow =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb24-27"><a href="statistical-plot-with-ggplot2.html#cb24-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb24-28"><a href="statistical-plot-with-ggplot2.html#cb24-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">17</span>))<span class="sc">+</span></span>
<span id="cb24-29"><a href="statistical-plot-with-ggplot2.html#cb24-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">92</span>, .<span class="dv">1</span>))</span></code></pre></div>
<p>Save total figure of fig1 and fig2. <code>arrageGrob</code> make two figures into the one figure.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="statistical-plot-with-ggplot2.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">arrangeGrob</span>(fig1, fig2, <span class="at">ncol =</span> <span class="dv">1</span>), <span class="at">file =</span><span class="st">&#39;results/covid/figtotal.png&#39;</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span><span class="dv">14</span>)</span>
<span id="cb25-2"><a href="statistical-plot-with-ggplot2.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">arrangeGrob</span>(fig1, fig2, <span class="at">ncol =</span> <span class="dv">1</span>), <span class="at">file =</span><span class="st">&#39;results/covid/tiff/figtotal.tiff&#39;</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span><span class="dv">14</span>)</span></code></pre></div>
<p><img src="results/covid/figtotal.png" width="1500" /></p>
</div>
<div id="job-loss-psychological-aggravation-according-to-age-group" class="section level4 hasAnchor" number="11.3.2.2">
<h4><span class="header-section-number">11.3.2.2</span> job loss, psychological aggravation according to age group<a href="statistical-plot-with-ggplot2.html#job-loss-psychological-aggravation-according-to-age-group" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="statistical-plot-with-ggplot2.html#cb26-1" aria-hidden="true" tabindex="-1"></a>fig3 <span class="ot">&lt;-</span> mm4<span class="fl">.0</span> <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="statistical-plot-with-ggplot2.html#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(!country %in% c(16, 173)) %&gt;%</span></span>
<span id="cb26-3"><a href="statistical-plot-with-ggplot2.html#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_c, gender, agegp2) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="statistical-plot-with-ggplot2.html#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(EcLossAllgp) <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="statistical-plot-with-ggplot2.html#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb26-6"><a href="statistical-plot-with-ggplot2.html#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(EcLossAllgp <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-7"><a href="statistical-plot-with-ggplot2.html#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> agegp2, <span class="at">y =</span> prob, <span class="at">color =</span> gender)) <span class="sc">+</span></span>
<span id="cb26-8"><a href="statistical-plot-with-ggplot2.html#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> n), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb26-9"><a href="statistical-plot-with-ggplot2.html#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;loess&#39;</span>, <span class="at">span =</span><span class="fl">0.9</span>,  <span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb26-10"><a href="statistical-plot-with-ggplot2.html#cb26-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="st">&quot;Job loss due to COVID19&quot;</span>)<span class="sc">+</span></span>
<span id="cb26-11"><a href="statistical-plot-with-ggplot2.html#cb26-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(x<span class="sc">*</span><span class="dv">100</span>, <span class="st">&quot;%&quot;</span>))<span class="sc">+</span></span>
<span id="cb26-12"><a href="statistical-plot-with-ggplot2.html#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb26-13"><a href="statistical-plot-with-ggplot2.html#cb26-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb26-14"><a href="statistical-plot-with-ggplot2.html#cb26-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;Gender&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-15"><a href="statistical-plot-with-ggplot2.html#cb26-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(country_c<span class="sc">~</span>., <span class="at">nrow =</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb26-16"><a href="statistical-plot-with-ggplot2.html#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">92</span>, .<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb26-17"><a href="statistical-plot-with-ggplot2.html#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">17</span>))<span class="sc">+</span></span>
<span id="cb26-18"><a href="statistical-plot-with-ggplot2.html#cb26-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>))</span>
<span id="cb26-19"><a href="statistical-plot-with-ggplot2.html#cb26-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-20"><a href="statistical-plot-with-ggplot2.html#cb26-20" aria-hidden="true" tabindex="-1"></a>fig4 <span class="ot">&lt;-</span> mm4<span class="fl">.0</span> <span class="sc">%&gt;%</span></span>
<span id="cb26-21"><a href="statistical-plot-with-ggplot2.html#cb26-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(!country %in% c(16, 173)) %&gt;%</span></span>
<span id="cb26-22"><a href="statistical-plot-with-ggplot2.html#cb26-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_c, gender, agegp2) <span class="sc">%&gt;%</span></span>
<span id="cb26-23"><a href="statistical-plot-with-ggplot2.html#cb26-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(TotalDepAnx) <span class="sc">%&gt;%</span></span>
<span id="cb26-24"><a href="statistical-plot-with-ggplot2.html#cb26-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb26-25"><a href="statistical-plot-with-ggplot2.html#cb26-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TotalDepAnx <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-26"><a href="statistical-plot-with-ggplot2.html#cb26-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> agegp2, <span class="at">y =</span> prob, <span class="at">color =</span> gender)) <span class="sc">+</span></span>
<span id="cb26-27"><a href="statistical-plot-with-ggplot2.html#cb26-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> n), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb26-28"><a href="statistical-plot-with-ggplot2.html#cb26-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;loess&#39;</span>, <span class="at">span =</span><span class="fl">0.9</span>,  <span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb26-29"><a href="statistical-plot-with-ggplot2.html#cb26-29" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="st">&quot;Psychological aggravation due to COVID19&quot;</span>)<span class="sc">+</span></span>
<span id="cb26-30"><a href="statistical-plot-with-ggplot2.html#cb26-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(x<span class="sc">*</span><span class="dv">100</span>, <span class="st">&quot;%&quot;</span>))<span class="sc">+</span></span>
<span id="cb26-31"><a href="statistical-plot-with-ggplot2.html#cb26-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb26-32"><a href="statistical-plot-with-ggplot2.html#cb26-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Age (size = number of respondents)&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-33"><a href="statistical-plot-with-ggplot2.html#cb26-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;Gender&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-34"><a href="statistical-plot-with-ggplot2.html#cb26-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(country_c<span class="sc">~</span>., <span class="at">nrow =</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb26-35"><a href="statistical-plot-with-ggplot2.html#cb26-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">92</span>, .<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb26-36"><a href="statistical-plot-with-ggplot2.html#cb26-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">17</span>))<span class="sc">+</span></span>
<span id="cb26-37"><a href="statistical-plot-with-ggplot2.html#cb26-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span> (<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>))</span></code></pre></div>
<p>save figures</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="statistical-plot-with-ggplot2.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#figtotal2 &lt;- grid.arrange(fig3, fig4, ncol = 1)</span></span>
<span id="cb27-2"><a href="statistical-plot-with-ggplot2.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">arrangeGrob</span>(fig3, fig4, <span class="at">ncol =</span> <span class="dv">1</span>), <span class="at">file =</span><span class="st">&#39;results/covid/figtotal2.png&#39;</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span><span class="dv">14</span>)</span>
<span id="cb27-3"><a href="statistical-plot-with-ggplot2.html#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">arrangeGrob</span>(fig3, fig4, <span class="at">ncol =</span> <span class="dv">1</span>), <span class="at">file =</span><span class="st">&#39;results/covid/tiff/figtotal2.tiff&#39;</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span><span class="dv">14</span>)</span></code></pre></div>
<p><img src="results/covid/figtotal2.png" width="1500" /></p>
</div>
</div>
<div id="job-loss-psychological-aggravation-according-to-education-level" class="section level3 hasAnchor" number="11.3.3">
<h3><span class="header-section-number">11.3.3</span> job loss, psychological aggravation according to Education level<a href="statistical-plot-with-ggplot2.html#job-loss-psychological-aggravation-according-to-education-level" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Quzi 1</p>
</blockquote>
<p>Let’s fill the <code>{ num }</code> to draw following figure.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="statistical-plot-with-ggplot2.html#cb28-1" aria-hidden="true" tabindex="-1"></a>fig5 <span class="ot">&lt;-</span> mm4<span class="fl">.0</span> <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="statistical-plot-with-ggplot2.html#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(edugp, country_c, gender) <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="statistical-plot-with-ggplot2.html#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(EcLossAllgp ) <span class="sc">%&gt;%</span></span>
<span id="cb28-4"><a href="statistical-plot-with-ggplot2.html#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb28-5"><a href="statistical-plot-with-ggplot2.html#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(EcLossAllgp  <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-6"><a href="statistical-plot-with-ggplot2.html#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> {<span class="dv">1</span>}     , <span class="at">y =</span>{<span class="dv">2</span>}    , <span class="at">color =</span> {<span class="dv">2</span>})) <span class="sc">+</span></span>
<span id="cb28-7"><a href="statistical-plot-with-ggplot2.html#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> {<span class="dv">3</span>}, <span class="at">span =</span><span class="fl">0.9</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb28-8"><a href="statistical-plot-with-ggplot2.html#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;≤H&quot;</span>, <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="st">&quot;C&quot;</span>,</span>
<span id="cb28-9"><a href="statistical-plot-with-ggplot2.html#cb28-9" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;3&quot;</span> <span class="ot">=</span> <span class="st">&quot;U&quot;</span>, <span class="st">&quot;4&quot;</span> <span class="ot">=</span> <span class="st">&quot;G&quot;</span>)) <span class="sc">+</span></span>
<span id="cb28-10"><a href="statistical-plot-with-ggplot2.html#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb28-11"><a href="statistical-plot-with-ggplot2.html#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> {<span class="dv">4</span>}) <span class="sc">+</span></span>
<span id="cb28-12"><a href="statistical-plot-with-ggplot2.html#cb28-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Job Loss due to COVID19&quot;</span>) <span class="sc">+</span></span>
<span id="cb28-13"><a href="statistical-plot-with-ggplot2.html#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb28-14"><a href="statistical-plot-with-ggplot2.html#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>({<span class="dv">5</span>})<span class="sc">+</span></span>
<span id="cb28-15"><a href="statistical-plot-with-ggplot2.html#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">17</span>))<span class="sc">+</span></span>
<span id="cb28-16"><a href="statistical-plot-with-ggplot2.html#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">92</span>, .<span class="dv">1</span>))</span>
<span id="cb28-17"><a href="statistical-plot-with-ggplot2.html#cb28-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-18"><a href="statistical-plot-with-ggplot2.html#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="co"># mm4 %&gt;%</span></span>
<span id="cb28-19"><a href="statistical-plot-with-ggplot2.html#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   count(TotalDepAnx)</span></span>
<span id="cb28-20"><a href="statistical-plot-with-ggplot2.html#cb28-20" aria-hidden="true" tabindex="-1"></a>fig6 <span class="ot">&lt;-</span> mm4<span class="fl">.0</span> <span class="sc">%&gt;%</span></span>
<span id="cb28-21"><a href="statistical-plot-with-ggplot2.html#cb28-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(edugp, country_c, gender) <span class="sc">%&gt;%</span></span>
<span id="cb28-22"><a href="statistical-plot-with-ggplot2.html#cb28-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(TotalDepAnx ) <span class="sc">%&gt;%</span></span>
<span id="cb28-23"><a href="statistical-plot-with-ggplot2.html#cb28-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb28-24"><a href="statistical-plot-with-ggplot2.html#cb28-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TotalDepAnx  <span class="sc">==</span> <span class="dv">1</span>  ) <span class="sc">%&gt;%</span></span>
<span id="cb28-25"><a href="statistical-plot-with-ggplot2.html#cb28-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>({<span class="dv">6</span>})) <span class="sc">+</span></span>
<span id="cb28-26"><a href="statistical-plot-with-ggplot2.html#cb28-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>({<span class="dv">7</span>}) <span class="sc">+</span></span>
<span id="cb28-27"><a href="statistical-plot-with-ggplot2.html#cb28-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>({<span class="dv">8</span>}) <span class="sc">+</span></span>
<span id="cb28-28"><a href="statistical-plot-with-ggplot2.html#cb28-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb28-29"><a href="statistical-plot-with-ggplot2.html#cb28-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Psychological aggravation due to COVID19&quot;</span>) <span class="sc">+</span></span>
<span id="cb28-30"><a href="statistical-plot-with-ggplot2.html#cb28-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> {<span class="dv">9</span>})<span class="sc">+</span></span>
<span id="cb28-31"><a href="statistical-plot-with-ggplot2.html#cb28-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;H = high school, C = college, U = university, G = graduate &quot;</span>) <span class="sc">+</span></span>
<span id="cb28-32"><a href="statistical-plot-with-ggplot2.html#cb28-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;Gender&quot;</span>) <span class="sc">+</span></span>
<span id="cb28-33"><a href="statistical-plot-with-ggplot2.html#cb28-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>({<span class="dv">10</span>})<span class="sc">+</span></span>
<span id="cb28-34"><a href="statistical-plot-with-ggplot2.html#cb28-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">17</span>))<span class="sc">+</span></span>
<span id="cb28-35"><a href="statistical-plot-with-ggplot2.html#cb28-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">92</span>, .<span class="dv">1</span>))</span></code></pre></div>
<p>save figure</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="statistical-plot-with-ggplot2.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#figtotal3 &lt;- grid.arrange(fig5, fig6, ncol = 1)</span></span>
<span id="cb29-2"><a href="statistical-plot-with-ggplot2.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">arrangeGrob</span>(fig5, fig6, <span class="at">ncol =</span> <span class="dv">1</span>), <span class="at">file =</span><span class="st">&#39;results/covid/figtotal3.png&#39;</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span><span class="dv">14</span>)</span>
<span id="cb29-3"><a href="statistical-plot-with-ggplot2.html#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">arrangeGrob</span>(fig5, fig6, <span class="at">ncol =</span> <span class="dv">1</span>), <span class="at">file =</span><span class="st">&#39;results/covid/tiff/figtotal3.tiff&#39;</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span><span class="dv">14</span>)</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="statistical-plot-with-ggplot2.html#cb30-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&#39;results/covid/figtotal3.png&#39;</span>)</span></code></pre></div>
<p><img src="results/covid/figtotal3.png" width="1500" /></p>
</div>
<div id="visulization-with-human-develop-index-stratification" class="section level3 hasAnchor" number="11.3.4">
<h3><span class="header-section-number">11.3.4</span> Visulization with human develop index stratification<a href="statistical-plot-with-ggplot2.html#visulization-with-human-develop-index-stratification" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Labelled data visualization need the code of `geom_label_repel’</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="statistical-plot-with-ggplot2.html#cb31-1" aria-hidden="true" tabindex="-1"></a>agu1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;data/covid/covid_agu1.csv&#39;</span>)</span>
<span id="cb31-2"><a href="statistical-plot-with-ggplot2.html#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="statistical-plot-with-ggplot2.html#cb31-3" aria-hidden="true" tabindex="-1"></a>lab_mm <span class="ot">&lt;-</span> mm4<span class="fl">.0</span> <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="statistical-plot-with-ggplot2.html#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(agu1, <span class="at">by =</span> <span class="st">&#39;country_c&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-5"><a href="statistical-plot-with-ggplot2.html#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">inc_aug =</span> c_case_agu1 <span class="sc">/</span> population <span class="sc">*</span><span class="dv">100000</span>, </span>
<span id="cb31-6"><a href="statistical-plot-with-ggplot2.html#cb31-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">dth_aug =</span> c_death_agu1<span class="sc">/</span> population <span class="sc">*</span><span class="dv">100000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-7"><a href="statistical-plot-with-ggplot2.html#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_c, gender) <span class="sc">%&gt;%</span></span>
<span id="cb31-8"><a href="statistical-plot-with-ggplot2.html#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">hdi =</span> <span class="fu">mean</span>(y2019), </span>
<span id="cb31-9"><a href="statistical-plot-with-ggplot2.html#cb31-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">Psycho =</span> <span class="fu">mean</span>(TotalDepAnx <span class="sc">==</span><span class="dv">1</span>), </span>
<span id="cb31-10"><a href="statistical-plot-with-ggplot2.html#cb31-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">ecl =</span> <span class="fu">mean</span>(EcLossAll <span class="sc">!=</span><span class="dv">0</span>),</span>
<span id="cb31-11"><a href="statistical-plot-with-ggplot2.html#cb31-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">inc =</span> <span class="fu">mean</span>(inc_aug)) </span>
<span id="cb31-12"><a href="statistical-plot-with-ggplot2.html#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="statistical-plot-with-ggplot2.html#cb31-13" aria-hidden="true" tabindex="-1"></a>lab_mm<span class="sc">%&gt;%</span></span>
<span id="cb31-14"><a href="statistical-plot-with-ggplot2.html#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hdi, <span class="at">y =</span> ecl, <span class="at">color =</span> inc)) <span class="sc">+</span></span>
<span id="cb31-15"><a href="statistical-plot-with-ggplot2.html#cb31-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb31-16"><a href="statistical-plot-with-ggplot2.html#cb31-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb31-17"><a href="statistical-plot-with-ggplot2.html#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Human Devlopment Index&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-18"><a href="statistical-plot-with-ggplot2.html#cb31-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#ylab(&quot;prevalance of Psychological Symptoms&quot;) +</span></span>
<span id="cb31-19"><a href="statistical-plot-with-ggplot2.html#cb31-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;prevalance of Economic Loss due to COVID19&quot;</span>) <span class="sc">+</span> </span>
<span id="cb31-20"><a href="statistical-plot-with-ggplot2.html#cb31-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#ylim(c(-0.1, 1)) + #xlim(c(2, 4)) + </span></span>
<span id="cb31-21"><a href="statistical-plot-with-ggplot2.html#cb31-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> country_c), </span>
<span id="cb31-22"><a href="statistical-plot-with-ggplot2.html#cb31-22" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> <span class="cn">NA</span>, <span class="co"># 투명하게 해서 겹쳐도 보이게</span></span>
<span id="cb31-23"><a href="statistical-plot-with-ggplot2.html#cb31-23" aria-hidden="true" tabindex="-1"></a>                   <span class="at">alpha =</span><span class="dv">1</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="co"># 작게</span></span>
<span id="cb31-24"><a href="statistical-plot-with-ggplot2.html#cb31-24" aria-hidden="true" tabindex="-1"></a>                   <span class="at">box.padding =</span> <span class="fl">0.4</span>,  <span class="co"># 분별해서</span></span>
<span id="cb31-25"><a href="statistical-plot-with-ggplot2.html#cb31-25" aria-hidden="true" tabindex="-1"></a>                   <span class="at">segment.size =</span><span class="fl">0.1</span>,  <span class="co"># 선 </span></span>
<span id="cb31-26"><a href="statistical-plot-with-ggplot2.html#cb31-26" aria-hidden="true" tabindex="-1"></a>                   <span class="at">force =</span> <span class="dv">2</span>)      <span class="sc">+</span>    <span class="co"># 이것은 무엇일까요?</span></span>
<span id="cb31-27"><a href="statistical-plot-with-ggplot2.html#cb31-27" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb31-28"><a href="statistical-plot-with-ggplot2.html#cb31-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x,<span class="dv">2</span>), <span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb31-29"><a href="statistical-plot-with-ggplot2.html#cb31-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_smooth( se=FALSE) +</span></span>
<span id="cb31-30"><a href="statistical-plot-with-ggplot2.html#cb31-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(gender<span class="sc">~</span>.) <span class="sc">+</span></span>
<span id="cb31-31"><a href="statistical-plot-with-ggplot2.html#cb31-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="testbook_files/figure-html/human%20develop%20index%20and%20economic%20loss-1.png" width="672" /></p>
<blockquote>
<p>Quiz 2,</p>
</blockquote>
<p>The Education level may affect the relationship between hdi and economic loss status. please draw following plot, and find the most vulnerable population.</p>
<p><img src="testbook_files/figure-html/covid_quiz_labelled-1.png" width="960" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="basic-plot-with-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="wave-form-data-visualization-example-for-public-health.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["testbook.pdf", "testbook.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
