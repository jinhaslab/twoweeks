<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 17 Plotting example I | DsPubs with R tutor book</title>
  <meta name="description" content="Chapter 17 Plotting example I | DsPubs with R tutor book" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 17 Plotting example I | DsPubs with R tutor book" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 17 Plotting example I | DsPubs with R tutor book" />
  
  
  

<meta name="author" content="jinha" />


<meta name="date" content="2022-10-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="repeated-analysis.html"/>
<link rel="next" href="r-markdown.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="libs/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
<link href="libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
<script src="libs/klippy-0.0.0.9500/js/klippy.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://dspubs.org/webapps">DsPubs</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="lets-start-with-r-and-r-studio.html"><a href="lets-start-with-r-and-r-studio.html"><i class="fa fa-check"></i><b>2</b> Let’s Start with R and R studio</a>
<ul>
<li class="chapter" data-level="2.1" data-path="lets-start-with-r-and-r-studio.html"><a href="lets-start-with-r-and-r-studio.html#rstudio-cloud-and-colab"><i class="fa fa-check"></i><b>2.1</b> Rstudio Cloud, and colab</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="lets-start-with-r-and-r-studio.html"><a href="lets-start-with-r-and-r-studio.html#rstudio-cloud"><i class="fa fa-check"></i><b>2.1.1</b> Rstudio Cloud</a></li>
<li class="chapter" data-level="2.1.2" data-path="lets-start-with-r-and-r-studio.html"><a href="lets-start-with-r-and-r-studio.html#colab"><i class="fa fa-check"></i><b>2.1.2</b> Colab</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="lets-start-with-r-and-r-studio.html"><a href="lets-start-with-r-and-r-studio.html#r-and-r-studio-on-window-system"><i class="fa fa-check"></i><b>2.2</b> R and R studio on Window system</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="lets-start-with-r-and-r-studio.html"><a href="lets-start-with-r-and-r-studio.html#r-studio-install"><i class="fa fa-check"></i><b>2.2.1</b> R studio install</a></li>
<li class="chapter" data-level="2.2.2" data-path="lets-start-with-r-and-r-studio.html"><a href="lets-start-with-r-and-r-studio.html#r-studio-project"><i class="fa fa-check"></i><b>2.2.2</b> R studio project</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="lets-start-with-r-and-r-studio.html"><a href="lets-start-with-r-and-r-studio.html#r-and-r-studio-on-ubuntus"><i class="fa fa-check"></i><b>2.3</b> R and R studio on Ubuntus</a></li>
</ul></li>
<li class="part"><span><b>I R</b></span></li>
<li class="chapter" data-level="3" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>3</b> R basics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="r-basics.html"><a href="r-basics.html#vector-matirx-list"><i class="fa fa-check"></i><b>3.1</b> vector matirx list</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="r-basics.html"><a href="r-basics.html#오브젝트-objects"><i class="fa fa-check"></i><b>3.1.1</b> 오브젝트 (objects)</a></li>
<li class="chapter" data-level="3.1.2" data-path="r-basics.html"><a href="r-basics.html#백터-vectors-팩터-factors"><i class="fa fa-check"></i><b>3.1.2</b> 백터 (Vectors), 팩터 (factors)</a></li>
<li class="chapter" data-level="3.1.3" data-path="r-basics.html"><a href="r-basics.html#매트릭스-matrix-데이터프래임-data-frame-리스트-list"><i class="fa fa-check"></i><b>3.1.3</b> 매트릭스 (Matrix), 데이터프래임 (data frame), 리스트 (list)</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="r-basics.html"><a href="r-basics.html#데이터-생성-저장"><i class="fa fa-check"></i><b>3.2</b> 데이터 생성 저장</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="r-basics.html"><a href="r-basics.html#built-in-data-sets"><i class="fa fa-check"></i><b>3.2.1</b> built-in data sets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="r-program-basic.html"><a href="r-program-basic.html"><i class="fa fa-check"></i><b>4</b> R program basic</a>
<ul>
<li class="chapter" data-level="4.1" data-path="r-program-basic.html"><a href="r-program-basic.html#기초-연산"><i class="fa fa-check"></i><b>4.1</b> 기초 연산</a></li>
<li class="chapter" data-level="4.2" data-path="r-program-basic.html"><a href="r-program-basic.html#조건부-연산"><i class="fa fa-check"></i><b>4.2</b> 조건부 연산</a></li>
<li class="chapter" data-level="4.3" data-path="r-program-basic.html"><a href="r-program-basic.html#함수-만들기"><i class="fa fa-check"></i><b>4.3</b> 함수 만들기</a></li>
<li class="chapter" data-level="4.4" data-path="r-program-basic.html"><a href="r-program-basic.html#반복문-vectorization-functionals"><i class="fa fa-check"></i><b>4.4</b> 반복문, vectorization, functionals</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="r-program-basic.html"><a href="r-program-basic.html#for-loop"><i class="fa fa-check"></i><b>4.4.1</b> for loop</a></li>
<li class="chapter" data-level="4.4.2" data-path="r-program-basic.html"><a href="r-program-basic.html#vectorization-과-apply-구문"><i class="fa fa-check"></i><b>4.4.2</b> vectorization 과 apply 구문</a></li>
<li class="chapter" data-level="4.4.3" data-path="r-program-basic.html"><a href="r-program-basic.html#home-work-and-summary-function"><i class="fa fa-check"></i><b>4.4.3</b> home work and summary function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-manipulation.html"><a href="data-manipulation.html"><i class="fa fa-check"></i><b>5</b> Data Manipulation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-manipulation.html"><a href="data-manipulation.html#dplyr-tidyverse"><i class="fa fa-check"></i><b>5.1</b> dplyr (tidyverse)</a></li>
<li class="chapter" data-level="5.2" data-path="data-manipulation.html"><a href="data-manipulation.html#실습-데이터-준비"><i class="fa fa-check"></i><b>5.2</b> 실습 데이터 준비</a></li>
<li class="chapter" data-level="5.3" data-path="data-manipulation.html"><a href="data-manipulation.html#select"><i class="fa fa-check"></i><b>5.3</b> select</a></li>
<li class="chapter" data-level="5.4" data-path="data-manipulation.html"><a href="data-manipulation.html#filter"><i class="fa fa-check"></i><b>5.4</b> filter</a></li>
<li class="chapter" data-level="5.5" data-path="data-manipulation.html"><a href="data-manipulation.html#arrange"><i class="fa fa-check"></i><b>5.5</b> arrange</a></li>
<li class="chapter" data-level="5.6" data-path="data-manipulation.html"><a href="data-manipulation.html#mutate"><i class="fa fa-check"></i><b>5.6</b> mutate</a></li>
<li class="chapter" data-level="5.7" data-path="data-manipulation.html"><a href="data-manipulation.html#group_by"><i class="fa fa-check"></i><b>5.7</b> group_by</a></li>
<li class="chapter" data-level="5.8" data-path="data-manipulation.html"><a href="data-manipulation.html#merge-join"><i class="fa fa-check"></i><b>5.8</b> merge, join</a></li>
</ul></li>
<li class="part"><span><b>II Visualization</b></span></li>
<li class="chapter" data-level="6" data-path="tables-for-public-health-1.html"><a href="tables-for-public-health-1.html"><i class="fa fa-check"></i><b>6</b> Tables for public health 1</a>
<ul>
<li class="chapter" data-level="6.1" data-path="tables-for-public-health-1.html"><a href="tables-for-public-health-1.html#데이터표-준비"><i class="fa fa-check"></i><b>6.1</b> 데이터표 준비</a></li>
<li class="chapter" data-level="6.2" data-path="tables-for-public-health-1.html"><a href="tables-for-public-health-1.html#central-tendency-mean-median-mode"><i class="fa fa-check"></i><b>6.2</b> Central Tendency (mean, median, mode)</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="tables-for-public-health-1.html"><a href="tables-for-public-health-1.html#하나씩-반복"><i class="fa fa-check"></i><b>6.2.1</b> 하나씩 반복</a></li>
<li class="chapter" data-level="6.2.2" data-path="tables-for-public-health-1.html"><a href="tables-for-public-health-1.html#group_by-summary-and-table-1"><i class="fa fa-check"></i><b>6.2.2</b> Group_by summary and Table 1</a></li>
<li class="chapter" data-level="6.2.3" data-path="tables-for-public-health-1.html"><a href="tables-for-public-health-1.html#long-file-and-table-1"><i class="fa fa-check"></i><b>6.2.3</b> Long File and Table 1</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="tables-for-public-health-1.html"><a href="tables-for-public-health-1.html#count-and-distribution"><i class="fa fa-check"></i><b>6.3</b> Count and Distribution</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="tables-for-public-health-1.html"><a href="tables-for-public-health-1.html#하나씩-반복-1"><i class="fa fa-check"></i><b>6.3.1</b> 하나씩 반복</a></li>
<li class="chapter" data-level="6.3.2" data-path="tables-for-public-health-1.html"><a href="tables-for-public-health-1.html#group_by-summary-and-table-1-1"><i class="fa fa-check"></i><b>6.3.2</b> Group_by summary and Table 1</a></li>
<li class="chapter" data-level="6.3.3" data-path="tables-for-public-health-1.html"><a href="tables-for-public-health-1.html#long-file-and-table-1-1"><i class="fa fa-check"></i><b>6.3.3</b> Long File and Table 1</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="tables-for-public-health-1.html"><a href="tables-for-public-health-1.html#정리-1"><i class="fa fa-check"></i><b>6.4</b> 정리 1</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="tables-for-public-health-1.html"><a href="tables-for-public-health-1.html#과제"><i class="fa fa-check"></i><b>6.4.1</b> 과제</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Tables2.html"><a href="Tables2.html"><i class="fa fa-check"></i><b>7</b> Tables for public health 2</a>
<ul>
<li class="chapter" data-level="7.1" data-path="Tables2.html"><a href="Tables2.html#데이터-준비"><i class="fa fa-check"></i><b>7.1</b> 데이터 준비</a></li>
<li class="chapter" data-level="7.2" data-path="Tables2.html"><a href="Tables2.html#분석-주제-선정"><i class="fa fa-check"></i><b>7.2</b> 분석 주제 선정</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="Tables2.html"><a href="Tables2.html#근로환경조사와-recode-선택사항"><i class="fa fa-check"></i><b>7.2.1</b> 근로환경조사와 recode (선택사항)</a></li>
<li class="chapter" data-level="7.2.2" data-path="Tables2.html"><a href="Tables2.html#근로환경조사-기본-변수-생성"><i class="fa fa-check"></i><b>7.2.2</b> 근로환경조사 기본 변수 생성</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="Tables2.html"><a href="Tables2.html#근로환경조사-table-1-만들기"><i class="fa fa-check"></i><b>7.3</b> 근로환경조사 Table 1 만들기</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="Tables2.html"><a href="Tables2.html#변수-값-요약하기"><i class="fa fa-check"></i><b>7.3.1</b> 변수 값 요약하기</a></li>
<li class="chapter" data-level="7.3.2" data-path="Tables2.html"><a href="Tables2.html#p-value-구하기."><i class="fa fa-check"></i><b>7.3.2</b> P value 구하기.</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="Tables2.html"><a href="Tables2.html#table-1-정리하기"><i class="fa fa-check"></i><b>7.4</b> Table 1 정리하기</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="Tables2.html"><a href="Tables2.html#htmltable-visulaization"><i class="fa fa-check"></i><b>7.4.1</b> htmlTable visulaization</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="Tables2.html"><a href="Tables2.html#kwcsfunction"><i class="fa fa-check"></i><b>7.5</b> 함수만들기</a></li>
<li class="chapter" data-level="7.6" data-path="Tables2.html"><a href="Tables2.html#quiz"><i class="fa fa-check"></i><b>7.6</b> Quiz</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="Tables2.html"><a href="Tables2.html#quiz1"><i class="fa fa-check"></i><b>7.6.1</b> Quiz1</a></li>
<li class="chapter" data-level="7.6.2" data-path="Tables2.html"><a href="Tables2.html#quiz-2"><i class="fa fa-check"></i><b>7.6.2</b> Quiz 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="tables-for-public-health-3.html"><a href="tables-for-public-health-3.html"><i class="fa fa-check"></i><b>8</b> Tables for public health 3</a>
<ul>
<li class="chapter" data-level="8.1" data-path="tables-for-public-health-3.html"><a href="tables-for-public-health-3.html#데이터-준비-1"><i class="fa fa-check"></i><b>8.1</b> 데이터 준비</a></li>
<li class="chapter" data-level="8.2" data-path="tables-for-public-health-3.html"><a href="tables-for-public-health-3.html#분석-주제-선정-1"><i class="fa fa-check"></i><b>8.2</b> 분석 주제 선정</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="tables-for-public-health-3.html"><a href="tables-for-public-health-3.html#근로환경조사-기본-변수-생성-선택"><i class="fa fa-check"></i><b>8.2.1</b> 근로환경조사 기본 변수 생성 (선택)</a></li>
<li class="chapter" data-level="8.2.2" data-path="tables-for-public-health-3.html"><a href="tables-for-public-health-3.html#함수를-source-file-로-저장하기"><i class="fa fa-check"></i><b>8.2.2</b> 함수를 source file 로 저장하기</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="tables-for-public-health-3.html"><a href="tables-for-public-health-3.html#logistic-regression-table"><i class="fa fa-check"></i><b>8.3</b> Logistic Regression Table</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="tables-for-public-health-3.html"><a href="tables-for-public-health-3.html#로지스틱회귀분석-표-함수-1"><i class="fa fa-check"></i><b>8.3.1</b> 로지스틱회귀분석 표 함수 1</a></li>
<li class="chapter" data-level="8.3.2" data-path="tables-for-public-health-3.html"><a href="tables-for-public-health-3.html#로지스틱-회귀분석-표-2"><i class="fa fa-check"></i><b>8.3.2</b> 로지스틱 회귀분석 표 2</a></li>
<li class="chapter" data-level="8.3.3" data-path="tables-for-public-health-3.html"><a href="tables-for-public-health-3.html#로지스틱-회귀분석-3"><i class="fa fa-check"></i><b>8.3.3</b> 로지스틱 회귀분석 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="tables-for-public-health-summary.html"><a href="tables-for-public-health-summary.html"><i class="fa fa-check"></i><b>9</b> Tables for public health summary</a>
<ul>
<li class="chapter" data-level="9.1" data-path="tables-for-public-health-summary.html"><a href="tables-for-public-health-summary.html#install-package-from-github"><i class="fa fa-check"></i><b>9.1</b> install package from github</a></li>
<li class="chapter" data-level="9.2" data-path="tables-for-public-health-summary.html"><a href="tables-for-public-health-summary.html#data-import-and-manipulation"><i class="fa fa-check"></i><b>9.2</b> data import and manipulation</a></li>
<li class="chapter" data-level="9.3" data-path="tables-for-public-health-summary.html"><a href="tables-for-public-health-summary.html#select-variables-and-table-1"><i class="fa fa-check"></i><b>9.3</b> select variables, and table 1</a></li>
<li class="chapter" data-level="9.4" data-path="tables-for-public-health-summary.html"><a href="tables-for-public-health-summary.html#logistic-regression-model-and-table-3"><i class="fa fa-check"></i><b>9.4</b> logistic regression model and table 3</a></li>
<li class="chapter" data-level="9.5" data-path="tables-for-public-health-summary.html"><a href="tables-for-public-health-summary.html#quiz-1"><i class="fa fa-check"></i><b>9.5</b> Quiz</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="tables-for-public-health-summary.html"><a href="tables-for-public-health-summary.html#install-and-load-library-tabf"><i class="fa fa-check"></i><b>9.5.1</b> install and load library tabf</a></li>
<li class="chapter" data-level="9.5.2" data-path="tables-for-public-health-summary.html"><a href="tables-for-public-health-summary.html#data-manipulation-1"><i class="fa fa-check"></i><b>9.5.2</b> data manipulation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="basic-plot-with-r.html"><a href="basic-plot-with-r.html"><i class="fa fa-check"></i><b>10</b> Basic plot with R</a>
<ul>
<li class="chapter" data-level="10.1" data-path="basic-plot-with-r.html"><a href="basic-plot-with-r.html#ggplot-basic"><i class="fa fa-check"></i><b>10.1</b> ggplot basic</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="basic-plot-with-r.html"><a href="basic-plot-with-r.html#axis"><i class="fa fa-check"></i><b>10.1.1</b> axis</a></li>
<li class="chapter" data-level="10.1.2" data-path="basic-plot-with-r.html"><a href="basic-plot-with-r.html#layer-geom_x"><i class="fa fa-check"></i><b>10.1.2</b> layer, geom_x()</a></li>
<li class="chapter" data-level="10.1.3" data-path="basic-plot-with-r.html"><a href="basic-plot-with-r.html#geom_point"><i class="fa fa-check"></i><b>10.1.3</b> geom_point()</a></li>
<li class="chapter" data-level="10.1.4" data-path="basic-plot-with-r.html"><a href="basic-plot-with-r.html#geom_smooth"><i class="fa fa-check"></i><b>10.1.4</b> geom_smooth()</a></li>
<li class="chapter" data-level="10.1.5" data-path="basic-plot-with-r.html"><a href="basic-plot-with-r.html#faceting"><i class="fa fa-check"></i><b>10.1.5</b> faceting</a></li>
<li class="chapter" data-level="10.1.6" data-path="basic-plot-with-r.html"><a href="basic-plot-with-r.html#geom_bar"><i class="fa fa-check"></i><b>10.1.6</b> geom_bar()</a></li>
<li class="chapter" data-level="10.1.7" data-path="basic-plot-with-r.html"><a href="basic-plot-with-r.html#geom_density-geom_histogram"><i class="fa fa-check"></i><b>10.1.7</b> geom_density() , geom_histogram()</a></li>
<li class="chapter" data-level="10.1.8" data-path="basic-plot-with-r.html"><a href="basic-plot-with-r.html#geom_boxplot"><i class="fa fa-check"></i><b>10.1.8</b> geom_boxplot()</a></li>
<li class="chapter" data-level="10.1.9" data-path="basic-plot-with-r.html"><a href="basic-plot-with-r.html#d-plot"><i class="fa fa-check"></i><b>10.1.9</b> 3d plot</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="basic-plot-with-r.html"><a href="basic-plot-with-r.html#visualzation-example-1"><i class="fa fa-check"></i><b>10.2</b> Visualzation example 1</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="basic-plot-with-r.html"><a href="basic-plot-with-r.html#simple-machine-learning-decision-tree"><i class="fa fa-check"></i><b>10.2.1</b> simple machine learning decision tree</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="basic-plot-with-r.html"><a href="basic-plot-with-r.html#summary"><i class="fa fa-check"></i><b>10.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="statistical-plot-with-ggplot2.html"><a href="statistical-plot-with-ggplot2.html"><i class="fa fa-check"></i><b>11</b> Statistical Plot with ggplot2</a>
<ul>
<li class="chapter" data-level="11.1" data-path="statistical-plot-with-ggplot2.html"><a href="statistical-plot-with-ggplot2.html#prerequisite"><i class="fa fa-check"></i><b>11.1</b> Prerequisite</a></li>
<li class="chapter" data-level="11.2" data-path="statistical-plot-with-ggplot2.html"><a href="statistical-plot-with-ggplot2.html#t-test-and-chisq-test-visualization"><i class="fa fa-check"></i><b>11.2</b> T-test and Chisq-test Visualization</a></li>
<li class="chapter" data-level="11.3" data-path="statistical-plot-with-ggplot2.html"><a href="statistical-plot-with-ggplot2.html#odds-ratio-and-95-confidence-interval"><i class="fa fa-check"></i><b>11.3</b> Odds ratio and 95% confidence interval</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="data-wrangling--reshaping.html"><a href="data-wrangling--reshaping.html"><i class="fa fa-check"></i><b>12</b> Data Wrangling- Reshaping</a>
<ul>
<li class="chapter" data-level="12.1" data-path="data-wrangling--reshaping.html"><a href="data-wrangling--reshaping.html#동영상"><i class="fa fa-check"></i><b>12.1</b> 동영상</a></li>
<li class="chapter" data-level="12.2" data-path="data-wrangling--reshaping.html"><a href="data-wrangling--reshaping.html#문제-제기"><i class="fa fa-check"></i><b>12.2</b> 문제 제기</a></li>
<li class="chapter" data-level="12.3" data-path="data-wrangling--reshaping.html"><a href="data-wrangling--reshaping.html#split"><i class="fa fa-check"></i><b>12.3</b> split</a></li>
<li class="chapter" data-level="12.4" data-path="data-wrangling--reshaping.html"><a href="data-wrangling--reshaping.html#gather-pivot_longer"><i class="fa fa-check"></i><b>12.4</b> gather (pivot_longer)</a></li>
<li class="chapter" data-level="12.5" data-path="data-wrangling--reshaping.html"><a href="data-wrangling--reshaping.html#spread-pivot_wider"><i class="fa fa-check"></i><b>12.5</b> spread (pivot_wider)</a></li>
<li class="chapter" data-level="12.6" data-path="data-wrangling--reshaping.html"><a href="data-wrangling--reshaping.html#stringr"><i class="fa fa-check"></i><b>12.6</b> stringr</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="data-wrangling--reshaping.html"><a href="data-wrangling--reshaping.html#분진-노출자-찾기"><i class="fa fa-check"></i><b>12.6.1</b> 분진 노출자 찾기</a></li>
<li class="chapter" data-level="12.6.2" data-path="data-wrangling--reshaping.html"><a href="data-wrangling--reshaping.html#특정-문자-변환"><i class="fa fa-check"></i><b>12.6.2</b> 특정 문자 변환</a></li>
<li class="chapter" data-level="12.6.3" data-path="data-wrangling--reshaping.html"><a href="data-wrangling--reshaping.html#과제-1"><i class="fa fa-check"></i><b>12.6.3</b> 과제</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="web-scraping.html"><a href="web-scraping.html"><i class="fa fa-check"></i><b>13</b> Web Scraping</a>
<ul>
<li class="chapter" data-level="13.1" data-path="web-scraping.html"><a href="web-scraping.html#issue-of-covid19-in-korea"><i class="fa fa-check"></i><b>13.1</b> issue of COVID19 in Korea</a></li>
<li class="chapter" data-level="13.2" data-path="web-scraping.html"><a href="web-scraping.html#homework"><i class="fa fa-check"></i><b>13.2</b> homework</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="web-scraping.html"><a href="web-scraping.html#download-cumulative-covid19-death"><i class="fa fa-check"></i><b>13.2.1</b> download Cumulative covid19 death</a></li>
<li class="chapter" data-level="13.2.2" data-path="web-scraping.html"><a href="web-scraping.html#uk-italy-france-spain-usa-canada"><i class="fa fa-check"></i><b>13.2.2</b> UK, Italy, France, Spain, USA, Canada</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="web-scraping.html"><a href="web-scraping.html#review-of-title-from-google-scholar"><i class="fa fa-check"></i><b>13.3</b> Review of title from google scholar</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="web-scraping.html"><a href="web-scraping.html#googl-scholar"><i class="fa fa-check"></i><b>13.3.1</b> googl scholar</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="web-scraping.html"><a href="web-scraping.html#home-work-2"><i class="fa fa-check"></i><b>13.4</b> home work 2</a></li>
<li class="chapter" data-level="13.5" data-path="web-scraping.html"><a href="web-scraping.html#black-report-2"><i class="fa fa-check"></i><b>13.5</b> Black Report 2</a></li>
<li class="chapter" data-level="13.6" data-path="web-scraping.html"><a href="web-scraping.html#home-work-2-1"><i class="fa fa-check"></i><b>13.6</b> home work 2</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="webscraping-example-3-pubmed-and-r-with-endnote.html"><a href="webscraping-example-3-pubmed-and-r-with-endnote.html"><i class="fa fa-check"></i><b>14</b> WebScraping Example 3: PubMed and R with EndNote</a>
<ul>
<li class="chapter" data-level="14.1" data-path="webscraping-example-3-pubmed-and-r-with-endnote.html"><a href="webscraping-example-3-pubmed-and-r-with-endnote.html#pubmed-검색-방법"><i class="fa fa-check"></i><b>14.1</b> PubMed 검색 방법</a></li>
<li class="chapter" data-level="14.2" data-path="webscraping-example-3-pubmed-and-r-with-endnote.html"><a href="webscraping-example-3-pubmed-and-r-with-endnote.html#r-에서-pubmed-query-사용"><i class="fa fa-check"></i><b>14.2</b> R 에서 PubMed Query 사용</a></li>
<li class="chapter" data-level="14.3" data-path="webscraping-example-3-pubmed-and-r-with-endnote.html"><a href="webscraping-example-3-pubmed-and-r-with-endnote.html#pdf-자동-보고서"><i class="fa fa-check"></i><b>14.3</b> PDF 자동 보고서</a></li>
<li class="chapter" data-level="14.4" data-path="webscraping-example-3-pubmed-and-r-with-endnote.html"><a href="webscraping-example-3-pubmed-and-r-with-endnote.html#원문-pdf-찾기"><i class="fa fa-check"></i><b>14.4</b> 원문 PDF 찾기</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="date-and-time-series.html"><a href="date-and-time-series.html"><i class="fa fa-check"></i><b>15</b> Date and time series</a>
<ul>
<li class="chapter" data-level="15.1" data-path="date-and-time-series.html"><a href="date-and-time-series.html#date-create"><i class="fa fa-check"></i><b>15.1</b> Date create</a></li>
<li class="chapter" data-level="15.2" data-path="date-and-time-series.html"><a href="date-and-time-series.html#tutor-heat-wave-and-death"><i class="fa fa-check"></i><b>15.2</b> Tutor: heat wave and death</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="date-and-time-series.html"><a href="date-and-time-series.html#date-create-1"><i class="fa fa-check"></i><b>15.2.1</b> date create</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="date-and-time-series.html"><a href="date-and-time-series.html#home-work"><i class="fa fa-check"></i><b>15.3</b> home work</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="date-and-time-series.html"><a href="date-and-time-series.html#home0"><i class="fa fa-check"></i><b>15.3.1</b> home0</a></li>
<li class="chapter" data-level="15.3.2" data-path="date-and-time-series.html"><a href="date-and-time-series.html#home-work1"><i class="fa fa-check"></i><b>15.3.2</b> home work1</a></li>
<li class="chapter" data-level="15.3.3" data-path="date-and-time-series.html"><a href="date-and-time-series.html#home-work2"><i class="fa fa-check"></i><b>15.3.3</b> home work2</a></li>
<li class="chapter" data-level="15.3.4" data-path="date-and-time-series.html"><a href="date-and-time-series.html#home-work3"><i class="fa fa-check"></i><b>15.3.4</b> home work3</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="date-and-time-series.html"><a href="date-and-time-series.html#time-series-data-analysis"><i class="fa fa-check"></i><b>15.4</b> Time series data analysis</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="date-and-time-series.html"><a href="date-and-time-series.html#outside-사망에-대해서"><i class="fa fa-check"></i><b>15.4.1</b> outside 사망에 대해서</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="date-and-time-series.html"><a href="date-and-time-series.html#time-series-data-analysis-regression"><i class="fa fa-check"></i><b>15.5</b> Time series data analysis, regression</a></li>
<li class="chapter" data-level="15.6" data-path="date-and-time-series.html"><a href="date-and-time-series.html#introduction-1"><i class="fa fa-check"></i><b>15.6</b> introduction</a></li>
<li class="chapter" data-level="15.7" data-path="date-and-time-series.html"><a href="date-and-time-series.html#미세먼지와-심혈관사망"><i class="fa fa-check"></i><b>15.7</b> 미세먼지와 심혈관사망</a></li>
<li class="chapter" data-level="15.8" data-path="date-and-time-series.html"><a href="date-and-time-series.html#방법-tutor"><i class="fa fa-check"></i><b>15.8</b> 방법 tutor</a></li>
</ul></li>
<li class="part"><span><b>IV Repeat and Reproducibility</b></span></li>
<li class="chapter" data-level="16" data-path="repeated-analysis.html"><a href="repeated-analysis.html"><i class="fa fa-check"></i><b>16</b> Repeated analysis</a>
<ul>
<li class="chapter" data-level="16.1" data-path="repeated-analysis.html"><a href="repeated-analysis.html#추출"><i class="fa fa-check"></i><b>16.1</b> 추출</a></li>
<li class="chapter" data-level="16.2" data-path="repeated-analysis.html"><a href="repeated-analysis.html#파일-불러오기"><i class="fa fa-check"></i><b>16.2</b> 파일 불러오기</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="repeated-analysis.html"><a href="repeated-analysis.html#과제-2"><i class="fa fa-check"></i><b>16.2.1</b> 과제</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="repeated-analysis.html"><a href="repeated-analysis.html#분석-반복하기-change-point-찾기"><i class="fa fa-check"></i><b>16.3</b> 분석 반복하기 (change point 찾기)</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="repeated-analysis.html"><a href="repeated-analysis.html#자료-생성"><i class="fa fa-check"></i><b>16.3.1</b> 자료 생성</a></li>
<li class="chapter" data-level="16.3.2" data-path="repeated-analysis.html"><a href="repeated-analysis.html#가상의-threshold-값-수행해보기"><i class="fa fa-check"></i><b>16.3.2</b> 가상의 threshold 값 수행해보기</a></li>
<li class="chapter" data-level="16.3.3" data-path="repeated-analysis.html"><a href="repeated-analysis.html#과제-3"><i class="fa fa-check"></i><b>16.3.3</b> 과제</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="repeated-analysis.html"><a href="repeated-analysis.html#repeated-analysis-big-data"><i class="fa fa-check"></i><b>16.4</b> Repeated analysis (big data)</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="repeated-analysis.html"><a href="repeated-analysis.html#data-profile"><i class="fa fa-check"></i><b>16.4.1</b> Data profile</a></li>
<li class="chapter" data-level="16.4.2" data-path="repeated-analysis.html"><a href="repeated-analysis.html#data-handling-start"><i class="fa fa-check"></i><b>16.4.2</b> data handling start</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="plotting-example-i.html"><a href="plotting-example-i.html"><i class="fa fa-check"></i><b>17</b> Plotting example I</a>
<ul>
<li class="chapter" data-level="17.1" data-path="plotting-example-i.html"><a href="plotting-example-i.html#wave-form-data-visualization-example-for-public-health"><i class="fa fa-check"></i><b>17.1</b> wave form data visualization example for public health</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="plotting-example-i.html"><a href="plotting-example-i.html#data-visualization-example-eeg-data"><i class="fa fa-check"></i><b>17.1.1</b> Data Visualization example (EEG data)</a></li>
<li class="chapter" data-level="17.1.2" data-path="plotting-example-i.html"><a href="plotting-example-i.html#introduction-2"><i class="fa fa-check"></i><b>17.1.2</b> Introduction</a></li>
<li class="chapter" data-level="17.1.3" data-path="plotting-example-i.html"><a href="plotting-example-i.html#dataset-and-data-step"><i class="fa fa-check"></i><b>17.1.3</b> Dataset and Data step</a></li>
<li class="chapter" data-level="17.1.4" data-path="plotting-example-i.html"><a href="plotting-example-i.html#data-analysis"><i class="fa fa-check"></i><b>17.1.4</b> Data analysis</a></li>
<li class="chapter" data-level="17.1.5" data-path="plotting-example-i.html"><a href="plotting-example-i.html#decision-tree-simple"><i class="fa fa-check"></i><b>17.1.5</b> Decision Tree simple</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V Communication</b></span></li>
<li class="chapter" data-level="18" data-path="r-markdown.html"><a href="r-markdown.html"><i class="fa fa-check"></i><b>18</b> R markdown</a>
<ul>
<li class="chapter" data-level="18.1" data-path="r-markdown.html"><a href="r-markdown.html#설치"><i class="fa fa-check"></i><b>18.1</b> 설치</a></li>
<li class="chapter" data-level="18.2" data-path="r-markdown.html"><a href="r-markdown.html#components"><i class="fa fa-check"></i><b>18.2</b> 3 components</a></li>
<li class="chapter" data-level="18.3" data-path="r-markdown.html"><a href="r-markdown.html#simple-tutor"><i class="fa fa-check"></i><b>18.3</b> simple tutor</a></li>
<li class="chapter" data-level="18.4" data-path="r-markdown.html"><a href="r-markdown.html#chunck-option"><i class="fa fa-check"></i><b>18.4</b> chunck option</a></li>
<li class="chapter" data-level="18.5" data-path="r-markdown.html"><a href="r-markdown.html#table-만들기"><i class="fa fa-check"></i><b>18.5</b> Table 만들기</a></li>
<li class="chapter" data-level="18.6" data-path="r-markdown.html"><a href="r-markdown.html#필독"><i class="fa fa-check"></i><b>18.6</b> 필독!</a></li>
<li class="chapter" data-level="18.7" data-path="r-markdown.html"><a href="r-markdown.html#동영상-1"><i class="fa fa-check"></i><b>18.7</b> 동영상</a></li>
<li class="chapter" data-level="18.8" data-path="r-markdown.html"><a href="r-markdown.html#과제-4"><i class="fa fa-check"></i><b>18.8</b> 과제</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="rmarkdown-and-reporting.html"><a href="rmarkdown-and-reporting.html"><i class="fa fa-check"></i><b>19</b> Rmarkdown and reporting</a>
<ul>
<li class="chapter" data-level="19.1" data-path="rmarkdown-and-reporting.html"><a href="rmarkdown-and-reporting.html#rmarkdown-and-word-office-down"><i class="fa fa-check"></i><b>19.1</b> Rmarkdown and Word (office down)</a></li>
<li class="chapter" data-level="19.2" data-path="rmarkdown-and-reporting.html"><a href="rmarkdown-and-reporting.html#rmarkdown-and-pdf"><i class="fa fa-check"></i><b>19.2</b> Rmarkdown and PDF</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="google-maps-platform.html"><a href="google-maps-platform.html"><i class="fa fa-check"></i><b>20</b> Google Maps Platform</a>
<ul>
<li class="chapter" data-level="20.1" data-path="google-maps-platform.html"><a href="google-maps-platform.html#google-tackeout"><i class="fa fa-check"></i><b>20.1</b> Google Tackeout</a></li>
<li class="chapter" data-level="20.2" data-path="google-maps-platform.html"><a href="google-maps-platform.html#data-visualization"><i class="fa fa-check"></i><b>20.2</b> Data visualization</a></li>
<li class="chapter" data-level="20.3" data-path="google-maps-platform.html"><a href="google-maps-platform.html#google-api"><i class="fa fa-check"></i><b>20.3</b> google API</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="leaflet.html"><a href="leaflet.html"><i class="fa fa-check"></i><b>21</b> Map using leaflet</a>
<ul>
<li class="chapter" data-level="21.1" data-path="leaflet.html"><a href="leaflet.html#leaflet-1"><i class="fa fa-check"></i><b>21.1</b> leaflet</a></li>
<li class="chapter" data-level="21.2" data-path="leaflet.html"><a href="leaflet.html#위치와-시간표시"><i class="fa fa-check"></i><b>21.2</b> 위치와 시간표시</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="shinyapps.html"><a href="shinyapps.html"><i class="fa fa-check"></i><b>22</b> shinyapps</a>
<ul>
<li class="chapter" data-level="22.1" data-path="shinyapps.html"><a href="shinyapps.html#설치-1"><i class="fa fa-check"></i><b>22.1</b> 설치</a></li>
<li class="chapter" data-level="22.2" data-path="shinyapps.html"><a href="shinyapps.html#예제"><i class="fa fa-check"></i><b>22.2</b> 예제</a></li>
<li class="chapter" data-level="22.3" data-path="shinyapps.html"><a href="shinyapps.html#예제-1-만들기"><i class="fa fa-check"></i><b>22.3</b> 예제 1 만들기</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="shinyapps.html"><a href="shinyapps.html#구조"><i class="fa fa-check"></i><b>22.3.1</b> 구조</a></li>
<li class="chapter" data-level="22.3.2" data-path="shinyapps.html"><a href="shinyapps.html#input-output"><i class="fa fa-check"></i><b>22.3.2</b> input, output</a></li>
<li class="chapter" data-level="22.3.3" data-path="shinyapps.html"><a href="shinyapps.html#과제-5"><i class="fa fa-check"></i><b>22.3.3</b> 과제</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="shinyapps.html"><a href="shinyapps.html#deploy-shiny-app-local-server"><i class="fa fa-check"></i><b>22.4</b> deploy shiny app (local server)</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="shinyapps.html"><a href="shinyapps.html#과제-6"><i class="fa fa-check"></i><b>22.4.1</b> 과제</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">DsPubs with R tutor book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plotting-example-i" class="section level1 hasAnchor" number="17">
<h1><span class="header-section-number">Chapter 17</span> Plotting example I<a href="plotting-example-i.html#plotting-example-i" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="wave-form-data-visualization-example-for-public-health" class="section level2 hasAnchor" number="17.1">
<h2><span class="header-section-number">17.1</span> wave form data visualization example for public health<a href="plotting-example-i.html#wave-form-data-visualization-example-for-public-health" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('right', 'top', 'auto', '1', 'Click to copy', 'Done');
</script>
<iframe width="560" height="315" src="https://www.youtube.com/embed/LvjzIqSYKas" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<div id="data-visualization-example-eeg-data" class="section level3 hasAnchor" number="17.1.1">
<h3><span class="header-section-number">17.1.1</span> Data Visualization example (EEG data)<a href="plotting-example-i.html#data-visualization-example-eeg-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In public health, another most common used data is bio-signal data. Bio-signal data usually used in medical research, but recently bio-log signals are widely used in public health beyond medical setting. Now I present some example of data visualization using bio-signal data from EEG.</p>
</div>
<div id="introduction-2" class="section level3 hasAnchor" number="17.1.2">
<h3><span class="header-section-number">17.1.2</span> Introduction<a href="plotting-example-i.html#introduction-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>EEG refers to the signal of the brain’s electrical activty. Electrodes are placed on the scalp, and each electrodes recorded brain’s activity. EEG is one of the most common methods to support diagnosis of brain diseases such as epilepsy, sleep disorder and even brain death. Furthermore, we can get usufull understand how brain activity correlated to various neurological activity. So, I tried to anaysis EEG signal and hope to predict eye opening status.</p>
<p>The data include information of <code>row_n</code>, <code>AF3</code>, <code>F7</code>, <code>F3</code>, <code>FC5</code>, <code>T7</code>,<code>P7</code>, <code>O1</code>, <code>O2</code>, <code>P8</code>, <code>T8</code>, <code>FC6</code>, <code>F4</code>, <code>F8</code>, <code>AF4</code>, and <code>eyeDetection</code>. Eye Detection is outcome variable data <code>Open</code> or <code>Closed</code>. Others numeric variable about activity of each electrodes. Each electro-nodes place on scalp, and represent area of particular location on brain, as below.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="plotting-example-i.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb1-2"><a href="plotting-example-i.html#cb1-2" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/7/70/21_electrodes_of_International_10-20_system_for_EEG.svg/1024px-21_electrodes_of_International_10-20_system_for_EEG.svg.png&quot;</span></span>
<span id="cb1-3"><a href="plotting-example-i.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(url, <span class="st">&#39;images/eegpng.png&#39;</span>)</span></code></pre></div>
<div class="figure">
<img src="images/eegpng.png" alt="" />
<p class="caption">eeg electrodes from wiki</p>
</div>
</div>
<div id="dataset-and-data-step" class="section level3 hasAnchor" number="17.1.3">
<h3><span class="header-section-number">17.1.3</span> Dataset and Data step<a href="plotting-example-i.html#dataset-and-data-step" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="data-download-and-handling" class="section level4 hasAnchor" number="17.1.3.1">
<h4><span class="header-section-number">17.1.3.1</span> Data download and handling<a href="plotting-example-i.html#data-download-and-handling" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The data set locate here, <code>https://archive.ics.uci.edu/ml/machine-learning-databases/00264/EEG%20Eye%20State.arff</code>.
The data was stored into my computer, as name of ‘dl_eeg.txt’ in `data’ folder.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="plotting-example-i.html#cb2-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">=</span><span class="st">&#39;https://archive.ics.uci.edu/ml/machine-learning-databases/00264/EEG%20Eye%20State.arff&#39;</span></span>
<span id="cb2-2"><a href="plotting-example-i.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(url, <span class="st">&#39;data/dl_eeg.txt&#39;</span>)</span></code></pre></div>
<p>To start the data step, some packages should be loaded.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="plotting-example-i.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-2"><a href="plotting-example-i.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(caret)</span></span>
<span id="cb3-3"><a href="plotting-example-i.html#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb3-4"><a href="plotting-example-i.html#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb3-5"><a href="plotting-example-i.html#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(htmlTable)</span>
<span id="cb3-6"><a href="plotting-example-i.html#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#library(doMC)</span></span></code></pre></div>
<p>scan the data and creat DB for analysis</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="plotting-example-i.html#cb4-1" aria-hidden="true" tabindex="-1"></a>mm <span class="ot">&lt;-</span> <span class="fu">scan</span>(<span class="st">&#39;data/dl_eeg.txt&#39;</span>, <span class="at">what=</span><span class="st">&quot;&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb4-2"><a href="plotting-example-i.html#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(mm <span class="sc">==</span> <span class="st">&#39;@DATA&#39;</span>)</span></code></pre></div>
<pre><code>## [1] 48</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="plotting-example-i.html#cb6-1" aria-hidden="true" tabindex="-1"></a>dat<span class="ot">&lt;-</span>mm[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">48</span>)]</span>
<span id="cb6-2"><a href="plotting-example-i.html#cb6-2" aria-hidden="true" tabindex="-1"></a>book <span class="ot">&lt;-</span> mm[<span class="dv">1</span><span class="sc">:</span><span class="dv">48</span>]</span>
<span id="cb6-3"><a href="plotting-example-i.html#cb6-3" aria-hidden="true" tabindex="-1"></a>book[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">48</span>)] <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="plotting-example-i.html#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">matrix</span>(., <span class="at">ncol=</span><span class="dv">3</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-5"><a href="plotting-example-i.html#cb6-5" aria-hidden="true" tabindex="-1"></a>  .[,<span class="dv">2</span>] <span class="ot">-&gt;</span> col_names</span>
<span id="cb6-6"><a href="plotting-example-i.html#cb6-6" aria-hidden="true" tabindex="-1"></a>col_names</span></code></pre></div>
<pre><code>##  [1] &quot;AF3&quot;          &quot;F7&quot;           &quot;F3&quot;           &quot;FC5&quot;          &quot;T7&quot;          
##  [6] &quot;P7&quot;           &quot;O1&quot;           &quot;O2&quot;           &quot;P8&quot;           &quot;T8&quot;          
## [11] &quot;FC6&quot;          &quot;F4&quot;           &quot;F8&quot;           &quot;AF4&quot;          &quot;eyeDetection&quot;</code></pre>
<p>the tibble form is easy to hand or transforming. So, I change the data form to tibble style.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="plotting-example-i.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">wave =</span>dat) <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="plotting-example-i.html#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span> (<span class="at">val =</span> <span class="fu">strsplit</span>(wave, <span class="st">&quot;,&quot;</span>), <span class="at">row_n=</span><span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="plotting-example-i.html#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span> (<span class="at">cols=</span><span class="fu">c</span>(val)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="plotting-example-i.html#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span> (<span class="sc">-</span>wave) <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="plotting-example-i.html#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span> (<span class="at">val =</span> <span class="fu">as.numeric</span>(val)) <span class="sc">%&gt;%</span></span>
<span id="cb8-6"><a href="plotting-example-i.html#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(row_n)  <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="plotting-example-i.html#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span> (<span class="at">wave_colname =</span> col_names) <span class="sc">%&gt;%</span> </span>
<span id="cb8-8"><a href="plotting-example-i.html#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-9"><a href="plotting-example-i.html#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span> (<span class="at">key =</span> wave_colname, <span class="at">value =</span> val, <span class="at">fill =</span> <span class="dv">0</span>,<span class="at">convert =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-10"><a href="plotting-example-i.html#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span> (row_n, col_names) <span class="sc">%&gt;%</span></span>
<span id="cb8-11"><a href="plotting-example-i.html#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span> (row_n) <span class="ot">-&gt;</span> </span>
<span id="cb8-12"><a href="plotting-example-i.html#cb8-12" aria-hidden="true" tabindex="-1"></a>  eeg</span></code></pre></div>
<p>I check the class of all variable.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="plotting-example-i.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(eeg)</span></code></pre></div>
<pre><code>##  [1] &quot;row_n&quot;        &quot;AF3&quot;          &quot;F7&quot;           &quot;F3&quot;           &quot;FC5&quot;         
##  [6] &quot;T7&quot;           &quot;P7&quot;           &quot;O1&quot;           &quot;O2&quot;           &quot;P8&quot;          
## [11] &quot;T8&quot;           &quot;FC6&quot;          &quot;F4&quot;           &quot;F8&quot;           &quot;AF4&quot;         
## [16] &quot;eyeDetection&quot;</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="plotting-example-i.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(eeg, mode)</span></code></pre></div>
<pre><code>##        row_n          AF3           F7           F3          FC5           T7 
##    &quot;numeric&quot;    &quot;numeric&quot;    &quot;numeric&quot;    &quot;numeric&quot;    &quot;numeric&quot;    &quot;numeric&quot; 
##           P7           O1           O2           P8           T8          FC6 
##    &quot;numeric&quot;    &quot;numeric&quot;    &quot;numeric&quot;    &quot;numeric&quot;    &quot;numeric&quot;    &quot;numeric&quot; 
##           F4           F8          AF4 eyeDetection 
##    &quot;numeric&quot;    &quot;numeric&quot;    &quot;numeric&quot;    &quot;numeric&quot;</code></pre>
<p>This data were measure for 117 seconds, I create <code>sec</code> variable to represent measurement time. I create facotor variable for eye opening status `Eye’, as below.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="plotting-example-i.html#cb13-1" aria-hidden="true" tabindex="-1"></a>eeg <span class="ot">&lt;-</span> eeg <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="plotting-example-i.html#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Eye =</span> <span class="fu">ifelse</span>(eyeDetection <span class="sc">==</span><span class="dv">1</span>, <span class="st">&#39;open&#39;</span>, <span class="st">&#39;closed&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="plotting-example-i.html#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sec =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">117</span>, <span class="at">length.out =</span> <span class="fu">nrow</span>(.)))</span></code></pre></div>
<p>For data step, the long form data were created via <code>gather</code> function. the key represent each electrode, and the activity were stored into <code>activity</code> variable. EyeDetection, row_n, sec, Eye will be indentical variable for each electrode activity.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="plotting-example-i.html#cb14-1" aria-hidden="true" tabindex="-1"></a>eeg <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="plotting-example-i.html#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">&#39;electrode&#39;</span>, <span class="at">value =</span> <span class="st">&#39;activity&#39;</span>, <span class="sc">-</span>eyeDetection, <span class="sc">-</span>row_n, <span class="sc">-</span>sec, <span class="sc">-</span>Eye) <span class="ot">-&gt;</span></span>
<span id="cb14-3"><a href="plotting-example-i.html#cb14-3" aria-hidden="true" tabindex="-1"></a>  eegl</span>
<span id="cb14-4"><a href="plotting-example-i.html#cb14-4" aria-hidden="true" tabindex="-1"></a>eegl <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 6
##   row_n eyeDetection Eye        sec electrode activity
##   &lt;int&gt;        &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;
## 1     1            0 closed 0       AF3          4329.
## 2     2            0 closed 0.00781 AF3          4325.
## 3     3            0 closed 0.0156  AF3          4328.
## 4     4            0 closed 0.0234  AF3          4329.
## 5     5            0 closed 0.0312  AF3          4326.
## 6     6            0 closed 0.0391  AF3          4321.</code></pre>
</div>
<div id="data-explorer" class="section level4 hasAnchor" number="17.1.3.2">
<h4><span class="header-section-number">17.1.3.2</span> data explorer<a href="plotting-example-i.html#data-explorer" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="heatmap" class="section level5 hasAnchor" number="17.1.3.2.1">
<h5><span class="header-section-number">17.1.3.2.1</span> heatmap<a href="plotting-example-i.html#heatmap" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The heatmap can show overview the time course about eye opening status. Dark blue indicate closed status, and light blue indicate eye open status.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="plotting-example-i.html#cb16-1" aria-hidden="true" tabindex="-1"></a>eegl <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="plotting-example-i.html#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sec, <span class="at">y =</span> <span class="fl">0.5</span>, <span class="at">fill =</span> eyeDetection)) <span class="sc">+</span></span>
<span id="cb16-3"><a href="plotting-example-i.html#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb16-4"><a href="plotting-example-i.html#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Eye status&quot;</span>, </span>
<span id="cb16-5"><a href="plotting-example-i.html#cb16-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb16-6"><a href="plotting-example-i.html#cb16-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;closed&#39;</span>,<span class="st">&quot;transit&quot;</span>, <span class="st">&#39;open&#39;</span>), </span>
<span id="cb16-7"><a href="plotting-example-i.html#cb16-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb16-8"><a href="plotting-example-i.html#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb16-9"><a href="plotting-example-i.html#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>), <span class="st">&#39;Eye status&#39;</span>) <span class="sc">+</span></span>
<span id="cb16-10"><a href="plotting-example-i.html#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">90</span>, <span class="dv">117</span>)) <span class="sc">+</span></span>
<span id="cb16-11"><a href="plotting-example-i.html#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">7</span>)</span></code></pre></div>
<p><img src="testbook_files/figure-html/heatmap%20wave%20form%201-1.png" width="672" />
##### waveform</p>
<p>The activity waves are plotting for data explorer.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="plotting-example-i.html#cb17-1" aria-hidden="true" tabindex="-1"></a>eegl <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="plotting-example-i.html#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> row_n, <span class="at">y =</span> activity, <span class="at">color =</span> Eye)) <span class="sc">+</span></span>
<span id="cb17-3"><a href="plotting-example-i.html#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fu">c</span>(<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb17-4"><a href="plotting-example-i.html#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb17-5"><a href="plotting-example-i.html#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(electrode <span class="sc">~</span>. ) <span class="sc">+</span></span>
<span id="cb17-6"><a href="plotting-example-i.html#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() </span></code></pre></div>
<p><img src="testbook_files/figure-html/wave%20form%20time%20series%20without%20cleaning-1.png" width="672" />
There are much of outlier, so the fluctuation of each node’s activity atteunted. So We needed to exclude outlier. To ensure the outlier status, I plot the boxplot, as below. The boxplot also suggested that there were much of outlier effect.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="plotting-example-i.html#cb18-1" aria-hidden="true" tabindex="-1"></a>eegl <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="plotting-example-i.html#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> electrode, <span class="at">y =</span> activity, <span class="at">color =</span> Eye)) <span class="sc">+</span></span>
<span id="cb18-3"><a href="plotting-example-i.html#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb18-4"><a href="plotting-example-i.html#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log2&#39;</span>) <span class="sc">+</span></span>
<span id="cb18-5"><a href="plotting-example-i.html#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="testbook_files/figure-html/outlier%20exploer%20boxplot%20waveform-1.png" width="672" />
Althoug there are outlier effect on data, but I just want to check the <code>t-test</code> results.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="plotting-example-i.html#cb19-1" aria-hidden="true" tabindex="-1"></a>ttest<span class="ot">&lt;-</span> eegl <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>eyeDetection, <span class="sc">-</span>row_n) <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="plotting-example-i.html#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(electrode)  <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="plotting-example-i.html#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb19-4"><a href="plotting-example-i.html#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stats     =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">t.test</span>(activity <span class="sc">~</span> Eye, <span class="at">data=</span>.x)), </span>
<span id="cb19-5"><a href="plotting-example-i.html#cb19-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">summarise =</span> <span class="fu">map</span>(stats, broom<span class="sc">::</span>glance))  <span class="sc">%&gt;%</span></span>
<span id="cb19-6"><a href="plotting-example-i.html#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(electrode, summarise) <span class="sc">%&gt;%</span></span>
<span id="cb19-7"><a href="plotting-example-i.html#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(summarise) </span>
<span id="cb19-8"><a href="plotting-example-i.html#cb19-8" aria-hidden="true" tabindex="-1"></a>ttest <span class="sc">%&gt;%</span> </span>
<span id="cb19-9"><a href="plotting-example-i.html#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb19-10"><a href="plotting-example-i.html#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.values =</span> <span class="fu">ifelse</span>(p.value <span class="sc">&lt;</span><span class="fl">0.01</span>, <span class="st">&#39;&lt;0.01&#39;</span>, <span class="fu">as.character</span>(p.value))) <span class="sc">%&gt;%</span></span>
<span id="cb19-11"><a href="plotting-example-i.html#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(electrode,<span class="st">`</span><span class="at">difference</span><span class="st">`</span> <span class="ot">=</span> estimate, <span class="st">&#39;open&#39;</span> <span class="ot">=</span> estimate1, <span class="st">&#39;closed&#39;</span> <span class="ot">=</span>  estimate2, p.values) <span class="sc">%&gt;%</span></span>
<span id="cb19-12"><a href="plotting-example-i.html#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">htmlTable</span>(</span>
<span id="cb19-13"><a href="plotting-example-i.html#cb19-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">cgroup=</span><span class="fu">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;Eye status&quot;</span>, <span class="st">&quot;&quot;</span>), </span>
<span id="cb19-14"><a href="plotting-example-i.html#cb19-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">n.cgroup=</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>), </span>
<span id="cb19-15"><a href="plotting-example-i.html#cb19-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;Table1. t-test result without outlier cleaning&quot;</span>, </span>
<span id="cb19-16"><a href="plotting-example-i.html#cb19-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">&#39;llrc&#39;</span></span>
<span id="cb19-17"><a href="plotting-example-i.html#cb19-17" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<td colspan="8" style="text-align: left;">
Table1. t-test result without outlier cleaning
</td>
</tr>
<tr>
<th style="border-top: 2px solid grey;">
</th>
<th colspan="2" style="font-weight: 900; border-top: 2px solid grey; text-align: center;">
</th>
<th style="border-bottom: none; border-top: 2px solid grey;" colspan="1">
 
</th>
<th colspan="2" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Eye status
</th>
<th style="border-bottom: none; border-top: 2px solid grey;" colspan="1">
 
</th>
<th colspan="1" style="font-weight: 900; border-top: 2px solid grey; text-align: center;">
</th>
</tr>
<tr>
<th style="border-bottom: 1px solid grey;">
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
electrode
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
difference
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;" colspan="1">
 
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
open
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
closed
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;" colspan="1">
 
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
p.values
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">
1
</td>
<td style="text-align: left;">
AF3
</td>
<td style="text-align: left;">
-52.4
</td>
<td style="text-align: left;" colspan="1">
 
</td>
<td style="text-align: right;">
4298.4
</td>
<td style="text-align: center;">
4350.8
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
0.25
</td>
</tr>
<tr>
<td style="text-align: left;">
2
</td>
<td style="text-align: left;">
F7
</td>
<td style="text-align: left;">
7.39
</td>
<td style="text-align: left;" colspan="1">
 
</td>
<td style="text-align: right;">
4013.08
</td>
<td style="text-align: center;">
4005.69
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
&lt;0.01
</td>
</tr>
<tr>
<td style="text-align: left;">
3
</td>
<td style="text-align: left;">
F3
</td>
<td style="text-align: left;">
-3.47
</td>
<td style="text-align: left;" colspan="1">
 
</td>
<td style="text-align: right;">
4262.46
</td>
<td style="text-align: center;">
4265.94
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
&lt;0.01
</td>
</tr>
<tr>
<td style="text-align: left;">
4
</td>
<td style="text-align: left;">
FC5
</td>
<td style="text-align: left;">
78.98
</td>
<td style="text-align: left;" colspan="1">
 
</td>
<td style="text-align: right;">
4200.39
</td>
<td style="text-align: center;">
4121.41
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
0.31
</td>
</tr>
<tr>
<td style="text-align: left;">
5
</td>
<td style="text-align: left;">
T7
</td>
<td style="text-align: left;">
0.03
</td>
<td style="text-align: left;" colspan="1">
 
</td>
<td style="text-align: right;">
4341.75
</td>
<td style="text-align: center;">
4341.73
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
0.96
</td>
</tr>
<tr>
<td style="text-align: left;">
6
</td>
<td style="text-align: left;">
P7
</td>
<td style="text-align: left;">
46.13
</td>
<td style="text-align: left;" colspan="1">
 
</td>
<td style="text-align: right;">
4664.73
</td>
<td style="text-align: center;">
4618.59
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
0.29
</td>
</tr>
<tr>
<td style="text-align: left;">
7
</td>
<td style="text-align: left;">
O1
</td>
<td style="text-align: left;">
66.82
</td>
<td style="text-align: left;" colspan="1">
 
</td>
<td style="text-align: right;">
4140.39
</td>
<td style="text-align: center;">
4073.57
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
0.33
</td>
</tr>
<tr>
<td style="text-align: left;">
8
</td>
<td style="text-align: left;">
O2
</td>
<td style="text-align: left;">
-1.48
</td>
<td style="text-align: left;" colspan="1">
 
</td>
<td style="text-align: right;">
4615.39
</td>
<td style="text-align: center;">
4616.87
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
&lt;0.01
</td>
</tr>
<tr>
<td style="text-align: left;">
9
</td>
<td style="text-align: left;">
P8
</td>
<td style="text-align: left;">
-41.13
</td>
<td style="text-align: left;" colspan="1">
 
</td>
<td style="text-align: right;">
4200.37
</td>
<td style="text-align: center;">
4241.5
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
0.29
</td>
</tr>
<tr>
<td style="text-align: left;">
10
</td>
<td style="text-align: left;">
T8
</td>
<td style="text-align: left;">
-3.61
</td>
<td style="text-align: left;" colspan="1">
 
</td>
<td style="text-align: right;">
4229.7
</td>
<td style="text-align: center;">
4233.31
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
&lt;0.01
</td>
</tr>
<tr>
<td style="text-align: left;">
11
</td>
<td style="text-align: left;">
FC6
</td>
<td style="text-align: left;">
-4.88
</td>
<td style="text-align: left;" colspan="1">
 
</td>
<td style="text-align: right;">
4200.26
</td>
<td style="text-align: center;">
4205.15
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
&lt;0.01
</td>
</tr>
<tr>
<td style="text-align: left;">
12
</td>
<td style="text-align: left;">
F4
</td>
<td style="text-align: left;">
-4.01
</td>
<td style="text-align: left;" colspan="1">
 
</td>
<td style="text-align: right;">
4277.43
</td>
<td style="text-align: center;">
4281.44
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
&lt;0.01
</td>
</tr>
<tr>
<td style="text-align: left;">
13
</td>
<td style="text-align: left;">
F8
</td>
<td style="text-align: left;">
-31.88
</td>
<td style="text-align: left;" colspan="1">
 
</td>
<td style="text-align: right;">
4600.9
</td>
<td style="text-align: center;">
4632.77
</td>
<td style="text-align: center;" colspan="1">
 
</td>
<td style="text-align: center;">
0.15
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">
14
</td>
<td style="border-bottom: 2px solid grey; text-align: left;">
AF4
</td>
<td style="border-bottom: 2px solid grey; text-align: left;">
89.42
</td>
<td style="border-bottom: 2px solid grey; text-align: left;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
4456.57
</td>
<td style="border-bottom: 2px solid grey; text-align: center;">
4367.15
</td>
<td style="border-bottom: 2px solid grey; text-align: center;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: center;">
0.31
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="data-cleaning-for-outlier" class="section level4 hasAnchor" number="17.1.3.3">
<h4><span class="header-section-number">17.1.3.3</span> data cleaning for outlier<a href="plotting-example-i.html#data-cleaning-for-outlier" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The interquartile range is useful for detecting the presence of outliers. Outliers are individual values that fall outside of the overall pattern of a data set. So, the outlier can be define when they are far way as several times of interquarile range from median. I made <code>scale_median</code> function to detect outlier. ther are several step to make function. first, calculate the interquartile range. The differece between median and value divided by inter quartile range, and the absolute value will be Z-score. That z-score mean how many times of interquartile range far from median. I used 2.5 times for detect outlier.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="plotting-example-i.html#cb20-1" aria-hidden="true" tabindex="-1"></a>scale_median <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb20-2"><a href="plotting-example-i.html#cb20-2" aria-hidden="true" tabindex="-1"></a>    Q1  <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="fl">0.25</span>)</span>
<span id="cb20-3"><a href="plotting-example-i.html#cb20-3" aria-hidden="true" tabindex="-1"></a>    Q3  <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="fl">0.75</span>)</span>
<span id="cb20-4"><a href="plotting-example-i.html#cb20-4" aria-hidden="true" tabindex="-1"></a>    iqr <span class="ot">&lt;-</span> <span class="fu">c</span>(Q3 <span class="sc">-</span> Q1)</span>
<span id="cb20-5"><a href="plotting-example-i.html#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(x <span class="sc">&lt;</span> <span class="fu">median</span>(x),(x <span class="sc">-</span> Q1)<span class="sc">/</span>iqr<span class="sc">*-</span><span class="dv">1</span>,(x <span class="sc">-</span> Q3)<span class="sc">/</span>iqr<span class="sc">*</span><span class="dv">1</span> )</span>
<span id="cb20-6"><a href="plotting-example-i.html#cb20-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-7"><a href="plotting-example-i.html#cb20-7" aria-hidden="true" tabindex="-1"></a>eegl1<span class="ot">&lt;-</span> </span>
<span id="cb20-8"><a href="plotting-example-i.html#cb20-8" aria-hidden="true" tabindex="-1"></a>  eegl <span class="sc">%&gt;%</span> </span>
<span id="cb20-9"><a href="plotting-example-i.html#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(electrode) <span class="sc">%&gt;%</span></span>
<span id="cb20-10"><a href="plotting-example-i.html#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-11"><a href="plotting-example-i.html#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Zscores =</span> <span class="fu">map</span> (data, <span class="sc">~</span><span class="fu">scale_median</span>(.<span class="sc">$</span>activity))) <span class="sc">%&gt;%</span> </span>
<span id="cb20-12"><a href="plotting-example-i.html#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(data, Zscores))  <span class="sc">%&gt;%</span></span>
<span id="cb20-13"><a href="plotting-example-i.html#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Zscores <span class="sc">&lt;</span> <span class="fl">2.5</span>) <span class="co">#Outlier is Zscores &gt; 2.5 or &lt;-2.5</span></span></code></pre></div>
<p>I check box-plot without outlier. That plot sounds good for me. So, I can generate wave form plot.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="plotting-example-i.html#cb21-1" aria-hidden="true" tabindex="-1"></a>eegl1 <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="plotting-example-i.html#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> electrode, <span class="at">y =</span> activity, <span class="at">color =</span> Eye)) <span class="sc">+</span></span>
<span id="cb21-3"><a href="plotting-example-i.html#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() </span></code></pre></div>
<p><img src="testbook_files/figure-html/eeg%20data%20waveform%20boxplot%20after%20outlier%20cleaning-1.png" width="672" />
Here, I plot wave form of each electrodes’ activity. Before generate the wave plot, I want increase the working cores.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="plotting-example-i.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&#39;doMC&#39;</span>)</span>
<span id="cb22-2"><a href="plotting-example-i.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb22-3"><a href="plotting-example-i.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">getDoParWorkers</span>()</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="plotting-example-i.html#cb24-1" aria-hidden="true" tabindex="-1"></a>number_of_cores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>()</span></code></pre></div>
<p>My computer use only 1 core, so I increse nubmer of cores working upto 11 cores.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="plotting-example-i.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoMC</span>(<span class="at">cores =</span> number_of_cores <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb25-2"><a href="plotting-example-i.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">getDoParWorkers</span>()</span></code></pre></div>
<pre><code>## [1] 46</code></pre>
<p>Then, I want plot wave form.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="plotting-example-i.html#cb27-1" aria-hidden="true" tabindex="-1"></a>eegl1 <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="plotting-example-i.html#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sec, <span class="at">y =</span> activity, <span class="at">fill =</span> eyeDetection)) <span class="sc">+</span></span>
<span id="cb27-3"><a href="plotting-example-i.html#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb27-4"><a href="plotting-example-i.html#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> eyeDetection), <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb27-5"><a href="plotting-example-i.html#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(electrode <span class="sc">~</span>., <span class="at">scales =</span> <span class="st">&quot;free&quot;</span> ) <span class="sc">+</span></span>
<span id="cb27-6"><a href="plotting-example-i.html#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb27-7"><a href="plotting-example-i.html#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Eye status&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb27-8"><a href="plotting-example-i.html#cb27-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;close&#39;</span>, <span class="st">&#39;open&#39;</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb27-9"><a href="plotting-example-i.html#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Time series&#39;</span>) <span class="sc">+</span></span>
<span id="cb27-10"><a href="plotting-example-i.html#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">90</span>, <span class="dv">117</span>))</span></code></pre></div>
<p><img src="testbook_files/figure-html/wave%20form%20plot%201-1.png" width="672" /></p>
</div>
<div id="data-reshape-longform-and-wideform" class="section level4 hasAnchor" number="17.1.3.4">
<h4><span class="header-section-number">17.1.3.4</span> Data reshape (longform and wideform)<a href="plotting-example-i.html#data-reshape-longform-and-wideform" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Now, I can confirm the cleaer data set without outlier. I attached <code>0</code> behind to data name to figure out the clear data. I also creat wide form data, too.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="plotting-example-i.html#cb28-1" aria-hidden="true" tabindex="-1"></a>eegw0 <span class="ot">&lt;-</span> eegl1 <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>Zscores) <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="plotting-example-i.html#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(<span class="at">key =</span> electrode, <span class="at">value =</span> activity) <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="plotting-example-i.html#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb28-4"><a href="plotting-example-i.html#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="plotting-example-i.html#cb28-5" aria-hidden="true" tabindex="-1"></a>eegl0 <span class="ot">&lt;-</span> eegw0 <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>row_n) <span class="sc">%&gt;%</span></span>
<span id="cb28-6"><a href="plotting-example-i.html#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> electrode, <span class="at">value =</span> activity, <span class="sc">-</span><span class="fu">c</span>(eyeDetection,Eye, sec) )</span>
<span id="cb28-7"><a href="plotting-example-i.html#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(eegl0)</span></code></pre></div>
<pre><code>## [1] &quot;eyeDetection&quot; &quot;Eye&quot;          &quot;sec&quot;          &quot;electrode&quot;    &quot;activity&quot;</code></pre>
</div>
</div>
<div id="data-analysis" class="section level3 hasAnchor" number="17.1.4">
<h3><span class="header-section-number">17.1.4</span> Data analysis<a href="plotting-example-i.html#data-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="data-splite" class="section level4 hasAnchor" number="17.1.4.1">
<h4><span class="header-section-number">17.1.4.1</span> data splite<a href="plotting-example-i.html#data-splite" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>I splite traing and testing date set using 80% of eye open for training set.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="plotting-example-i.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb30-2"><a href="plotting-example-i.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb30-3"><a href="plotting-example-i.html#cb30-3" aria-hidden="true" tabindex="-1"></a>dfs <span class="ot">&lt;-</span>eegw0 <span class="sc">%&gt;%</span><span class="fu">select</span>(<span class="sc">-</span>eyeDetection, <span class="sc">-</span>sec, <span class="sc">-</span>row_n)</span>
<span id="cb30-4"><a href="plotting-example-i.html#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="plotting-example-i.html#cb30-5" aria-hidden="true" tabindex="-1"></a>trainIndex <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(dfs<span class="sc">$</span>Eye, <span class="at">p =</span> <span class="fl">0.8</span>, </span>
<span id="cb30-6"><a href="plotting-example-i.html#cb30-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">list =</span> <span class="cn">FALSE</span>, </span>
<span id="cb30-7"><a href="plotting-example-i.html#cb30-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">times=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">as.vector</span>()</span>
<span id="cb30-8"><a href="plotting-example-i.html#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="plotting-example-i.html#cb30-9" aria-hidden="true" tabindex="-1"></a>training <span class="ot">&lt;-</span> dfs[ trainIndex, ]</span>
<span id="cb30-10"><a href="plotting-example-i.html#cb30-10" aria-hidden="true" tabindex="-1"></a>testing  <span class="ot">&lt;-</span> dfs[<span class="sc">-</span>trainIndex, ]</span></code></pre></div>
<p>There are 5924 points for eye closed, and 4912 points for eye open.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="plotting-example-i.html#cb31-1" aria-hidden="true" tabindex="-1"></a>training <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Eye) <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="plotting-example-i.html#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="plotting-example-i.html#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">htmlTable</span>()</span></code></pre></div>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey;">
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Eye
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
n
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">
1
</td>
<td style="text-align: center;">
closed
</td>
<td style="text-align: center;">
5924
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">
2
</td>
<td style="border-bottom: 2px solid grey; text-align: center;">
open
</td>
<td style="border-bottom: 2px solid grey; text-align: center;">
4912
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="decision-tree-simple" class="section level3 hasAnchor" number="17.1.5">
<h3><span class="header-section-number">17.1.5</span> Decision Tree simple<a href="plotting-example-i.html#decision-tree-simple" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="plotting-example-i.html#cb32-1" aria-hidden="true" tabindex="-1"></a>eeg.tree <span class="ot">=</span> <span class="fu">train</span>(<span class="at">data=</span>training,</span>
<span id="cb32-2"><a href="plotting-example-i.html#cb32-2" aria-hidden="true" tabindex="-1"></a>                  Eye <span class="sc">~</span> ., </span>
<span id="cb32-3"><a href="plotting-example-i.html#cb32-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method=</span><span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb32-4"><a href="plotting-example-i.html#cb32-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;cv&quot;</span>))</span>
<span id="cb32-5"><a href="plotting-example-i.html#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="plotting-example-i.html#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&#39;rattle&#39;)</span></span>
<span id="cb32-7"><a href="plotting-example-i.html#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rattle)</span>
<span id="cb32-8"><a href="plotting-example-i.html#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="fu">fancyRpartPlot</span>(eeg.tree<span class="sc">$</span>finalModel)</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="plotting-example-i.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(eeg.pred, testing<span class="sc">$</span>Eye)</span>
<span id="cb33-2"><a href="plotting-example-i.html#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="plotting-example-i.html#cb33-3" aria-hidden="true" tabindex="-1"></a>accur <span class="ot">=</span> <span class="fu">mean</span>(eeg.pred <span class="sc">==</span> testing<span class="sc">$</span>Eye)</span>
<span id="cb33-4"><a href="plotting-example-i.html#cb33-4" aria-hidden="true" tabindex="-1"></a>accur</span></code></pre></div>
<div id="first-gbm-algorithm" class="section level4 hasAnchor" number="17.1.5.1">
<h4><span class="header-section-number">17.1.5.1</span> First gbm algorithm<a href="plotting-example-i.html#first-gbm-algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>I choose <code>Gradient boosting machine learning (gbm)</code> technique for classification problem. I search various algorithm in basic tunning by <code>caret</code> package. Among them(<code>parRF</code>, <code>naive_bayes</code>, <code>knn</code>, <code>lssvmPoly</code>, <code>svmLinearWeights</code>, <code>gbm</code>, <code>brnn</code>, <code>regLogistic</code>, <code>OneR</code>, <code>RFlda</code>, <code>qda</code>, <code>glm</code>, <code>LogitBoost</code>), the <code>gbm</code> technique show greatest performance.
The gbm is one of the decision trees methods with boosting methods. For detain, I get information from <code>http://uc-r.github.io/gbm_regression</code>. Now, I start my first gbm model</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="plotting-example-i.html#cb34-1" aria-hidden="true" tabindex="-1"></a>gbmFit1 <span class="ot">&lt;-</span><span class="fu">train</span>(Eye <span class="sc">~</span>., <span class="at">data =</span> training, </span>
<span id="cb34-2"><a href="plotting-example-i.html#cb34-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">method =</span> <span class="st">&#39;gbm&#39;</span>, </span>
<span id="cb34-3"><a href="plotting-example-i.html#cb34-3" aria-hidden="true" tabindex="-1"></a>                <span class="co">#preProc = c(&quot;center&quot;, &quot;scale&quot;)</span></span>
<span id="cb34-4"><a href="plotting-example-i.html#cb34-4" aria-hidden="true" tabindex="-1"></a>                )</span></code></pre></div>
<pre><code>## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.3565            -nan     0.1000    0.0102
##      2        1.3395            -nan     0.1000    0.0076
##      3        1.3240            -nan     0.1000    0.0070
##      4        1.3076            -nan     0.1000    0.0080
##      5        1.2944            -nan     0.1000    0.0060
##      6        1.2820            -nan     0.1000    0.0059
##      7        1.2688            -nan     0.1000    0.0065
##      8        1.2570            -nan     0.1000    0.0053
##      9        1.2464            -nan     0.1000    0.0046
##     10        1.2365            -nan     0.1000    0.0045
##     20        1.1593            -nan     0.1000    0.0031
##     40        1.0757            -nan     0.1000    0.0009
##     60        1.0198            -nan     0.1000    0.0013
##     80        0.9795            -nan     0.1000    0.0007
##    100        0.9417            -nan     0.1000    0.0005
##    120        0.9090            -nan     0.1000    0.0004
##    140        0.8841            -nan     0.1000    0.0003
##    150        0.8691            -nan     0.1000    0.0007</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="plotting-example-i.html#cb36-1" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span><span class="fu">Sys.time</span>()</span>
<span id="cb36-2"><a href="plotting-example-i.html#cb36-2" aria-hidden="true" tabindex="-1"></a>gbmFit1<span class="sc">$</span>results <span class="sc">%&gt;%</span><span class="fu">tibble</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb36-3"><a href="plotting-example-i.html#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Accuracy) <span class="sc">%&gt;%</span><span class="fu">max</span>() <span class="sc">%&gt;%</span><span class="fu">round</span>(., <span class="dv">3</span>)<span class="ot">-&gt;</span></span>
<span id="cb36-4"><a href="plotting-example-i.html#cb36-4" aria-hidden="true" tabindex="-1"></a>  model_accuracy</span>
<span id="cb36-5"><a href="plotting-example-i.html#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="plotting-example-i.html#cb36-6" aria-hidden="true" tabindex="-1"></a>a1<span class="ot">&lt;-</span><span class="fu">confusionMatrix</span>(<span class="fu">predict</span>(gbmFit1, <span class="at">newdata =</span> testing), <span class="fu">as.factor</span>(testing<span class="sc">$</span>Eye))</span>
<span id="cb36-7"><a href="plotting-example-i.html#cb36-7" aria-hidden="true" tabindex="-1"></a>results_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb36-8"><a href="plotting-example-i.html#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Methods =</span> <span class="st">&quot;first gbm method&quot;</span>, </span>
<span id="cb36-9"><a href="plotting-example-i.html#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Accuracy =</span> model_accuracy, </span>
<span id="cb36-10"><a href="plotting-example-i.html#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Accuracy_in_test =</span> <span class="fu">round</span>(a1<span class="sc">$</span>overall[[<span class="dv">1</span>]], <span class="dv">3</span>))</span></code></pre></div>
<p>My first gbm method show accuracy in training, it is not bed. The confusion matrix report results in testing set. The Accuracy is 80%, Sensitivity is 84.9%, and Specificity is 74%.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="plotting-example-i.html#cb37-1" aria-hidden="true" tabindex="-1"></a>results_table <span class="sc">%&gt;%</span> <span class="fu">htmlTable</span>()</span></code></pre></div>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey;">
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Methods
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Accuracy
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Accuracy_in_test
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">
1
</td>
<td style="border-bottom: 2px solid grey; text-align: center;">
first gbm method
</td>
<td style="border-bottom: 2px solid grey; text-align: center;">
0.798
</td>
<td style="border-bottom: 2px solid grey; text-align: center;">
0.792
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="plotting-example-i.html#cb38-1" aria-hidden="true" tabindex="-1"></a>TestResult <span class="ot">&lt;-</span> <span class="fu">predict</span>(gbmFit1, <span class="at">newdata =</span> testing)</span>
<span id="cb38-2"><a href="plotting-example-i.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(TestResult, <span class="fu">as.factor</span>(testing<span class="sc">$</span>Eye))</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction closed open
##     closed   1258  341
##     open      223  886
##                                           
##                Accuracy : 0.7917          
##                  95% CI : (0.7759, 0.8069)
##     No Information Rate : 0.5469          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.5763          
##                                           
##  Mcnemar&#39;s Test P-Value : 8.368e-07       
##                                           
##             Sensitivity : 0.8494          
##             Specificity : 0.7221          
##          Pos Pred Value : 0.7867          
##          Neg Pred Value : 0.7989          
##              Prevalence : 0.5469          
##          Detection Rate : 0.4645          
##    Detection Prevalence : 0.5905          
##       Balanced Accuracy : 0.7858          
##                                           
##        &#39;Positive&#39; Class : closed          
## </code></pre>
<p>gbmFit3 creates a new summary data set with var, factors in our model, and its relative influence (rel.inf) each variable had on eye opening status. O1 and P7, F8, F7 show highest rel.infs.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="plotting-example-i.html#cb40-1" aria-hidden="true" tabindex="-1"></a>gbmFit1 <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code></pre></div>
<p><img src="testbook_files/figure-html/eeg%20data%20waveform%20gbmsummary-1.png" width="672" /></p>
<pre><code>##     var   rel.inf
## O1   O1 23.799686
## P7   P7 20.817368
## F8   F8 12.253765
## F7   F7  8.449242
## AF4 AF4  7.527027
## AF3 AF3  7.068717
## F4   F4  5.224236
## O2   O2  3.939794
## T8   T8  2.761357
## FC6 FC6  1.995400
## FC5 FC5  1.652006
## T7   T7  1.643377
## F3   F3  1.472344
## P8   P8  1.395682</code></pre>
<p>I search classification algorithms, and find <code>parRF</code>, <code>naive_bayes</code>, <code>knn</code>, <code>lssvmPoly</code>, <code>svmLinearWeights</code>, <code>gbm</code>, <code>brnn</code>, <code>regLogistic</code>, <code>OneR</code>, <code>RFlda</code>, <code>qda</code>, <code>glm</code>, <code>LogitBoost</code> algorithm. Among them, “parRF”, “naive_bayes”, “knn”,“svmLinearWeights”, “gbm”,“regLogistic”,“glm”,“LogitBoost” are chosen for data analysis due to some error for package install and load library in caret package. Among them, knn and gbm show higest accuracy I just compare the knn in current report.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="plotting-example-i.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb42-2"><a href="plotting-example-i.html#cb42-2" aria-hidden="true" tabindex="-1"></a>dfs <span class="ot">&lt;-</span>eegw0 <span class="sc">%&gt;%</span><span class="fu">select</span>(<span class="sc">-</span>eyeDetection, <span class="sc">-</span>sec, <span class="sc">-</span>row_n)</span>
<span id="cb42-3"><a href="plotting-example-i.html#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="plotting-example-i.html#cb42-4" aria-hidden="true" tabindex="-1"></a>trainIndex <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(dfs<span class="sc">$</span>Eye, <span class="at">p =</span> <span class="fl">0.8</span>, </span>
<span id="cb42-5"><a href="plotting-example-i.html#cb42-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">list =</span> <span class="cn">FALSE</span>, </span>
<span id="cb42-6"><a href="plotting-example-i.html#cb42-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">times=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">as.vector</span>()</span>
<span id="cb42-7"><a href="plotting-example-i.html#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="plotting-example-i.html#cb42-8" aria-hidden="true" tabindex="-1"></a>training <span class="ot">&lt;-</span> dfs[ trainIndex, ]</span>
<span id="cb42-9"><a href="plotting-example-i.html#cb42-9" aria-hidden="true" tabindex="-1"></a>testing  <span class="ot">&lt;-</span> dfs[<span class="sc">-</span>trainIndex, ]</span>
<span id="cb42-10"><a href="plotting-example-i.html#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="plotting-example-i.html#cb42-11" aria-hidden="true" tabindex="-1"></a>fitControl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(</span>
<span id="cb42-12"><a href="plotting-example-i.html#cb42-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 10 -fold Cross Validation</span></span>
<span id="cb42-13"><a href="plotting-example-i.html#cb42-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;repeatedcv&quot;</span>, </span>
<span id="cb42-14"><a href="plotting-example-i.html#cb42-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">number =</span> <span class="dv">10</span>,</span>
<span id="cb42-15"><a href="plotting-example-i.html#cb42-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># repeated 10 times</span></span>
<span id="cb42-16"><a href="plotting-example-i.html#cb42-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">repeats =</span> <span class="dv">10</span></span>
<span id="cb42-17"><a href="plotting-example-i.html#cb42-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-18"><a href="plotting-example-i.html#cb42-18" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span><span class="fu">Sys.time</span>()</span>
<span id="cb42-19"><a href="plotting-example-i.html#cb42-19" aria-hidden="true" tabindex="-1"></a>knnFit1 <span class="ot">&lt;-</span> <span class="fu">train</span> (Eye <span class="sc">~</span> ., <span class="at">data=</span>training, </span>
<span id="cb42-20"><a href="plotting-example-i.html#cb42-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method    =</span> <span class="st">&#39;knn&#39;</span>, </span>
<span id="cb42-21"><a href="plotting-example-i.html#cb42-21" aria-hidden="true" tabindex="-1"></a>                  <span class="co">#preProc = c(&quot;center&quot;, &quot;scale&quot;),</span></span>
<span id="cb42-22"><a href="plotting-example-i.html#cb42-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trControl =</span> fitControl)</span>
<span id="cb42-23"><a href="plotting-example-i.html#cb42-23" aria-hidden="true" tabindex="-1"></a>et <span class="ot">&lt;-</span><span class="fu">Sys.time</span>()</span>
<span id="cb42-24"><a href="plotting-example-i.html#cb42-24" aria-hidden="true" tabindex="-1"></a>et<span class="sc">-</span>st</span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="plotting-example-i.html#cb43-1" aria-hidden="true" tabindex="-1"></a>knnFit1<span class="sc">$</span>results <span class="sc">%&gt;%</span><span class="fu">tibble</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb43-2"><a href="plotting-example-i.html#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Accuracy) <span class="sc">%&gt;%</span><span class="fu">max</span>() <span class="sc">%&gt;%</span><span class="fu">round</span>(., <span class="dv">3</span>)<span class="ot">-&gt;</span></span>
<span id="cb43-3"><a href="plotting-example-i.html#cb43-3" aria-hidden="true" tabindex="-1"></a>  model_accuracy</span>
<span id="cb43-4"><a href="plotting-example-i.html#cb43-4" aria-hidden="true" tabindex="-1"></a>a6<span class="ot">&lt;-</span><span class="fu">confusionMatrix</span>(<span class="fu">predict</span>(knnFit1, <span class="at">newdata =</span> testing), <span class="fu">as.factor</span>(testing<span class="sc">$</span>Eye))</span>
<span id="cb43-5"><a href="plotting-example-i.html#cb43-5" aria-hidden="true" tabindex="-1"></a>a6</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction closed open
##     closed   1441   53
##     open       40 1174
##                                           
##                Accuracy : 0.9657          
##                  95% CI : (0.9581, 0.9722)
##     No Information Rate : 0.5469          
##     P-Value [Acc &gt; NIR] : &lt;2e-16          
##                                           
##                   Kappa : 0.9306          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.2134          
##                                           
##             Sensitivity : 0.9730          
##             Specificity : 0.9568          
##          Pos Pred Value : 0.9645          
##          Neg Pred Value : 0.9671          
##              Prevalence : 0.5469          
##          Detection Rate : 0.5321          
##    Detection Prevalence : 0.5517          
##       Balanced Accuracy : 0.9649          
##                                           
##        &#39;Positive&#39; Class : closed          
## </code></pre>
<p>The accuracy of knn in testing set is almost same to gbm method.</p>
<p>I trie to predict eye opening status using electronode, although I created some new variable from original data but they did not increse the model performance. The time seriese slice did not improve the model performance, either. The electrodne activity can predict eye opening statys about accuracy 94% in gbm and knn model. However I hope to test other algorithms such as <code>parRF</code>, <code>naive_bayes</code>, <code>knn</code>, <code>lssvmPoly</code>, <code>svmLinearWeights</code>, <code>gbm</code>, <code>brnn</code>, <code>regLogistic</code>, <code>OneR</code>, <code>RFlda</code>, <code>qda</code>, <code>glm</code>, <code>LogitBoost</code> in near future.</p>

</div>
</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="repeated-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="r-markdown.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["testbook.pdf", "testbook.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
